/*! For license information please see live2d.js.LICENSE.txt */
!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i(i.s=0)}({"./node_modules/core-js/fn/promise.js":function(t,e,i){i("./node_modules/core-js/modules/es6.object.to-string.js"),i("./node_modules/core-js/modules/es6.string.iterator.js"),i("./node_modules/core-js/modules/web.dom.iterable.js"),i("./node_modules/core-js/modules/es6.promise.js"),i("./node_modules/core-js/modules/es7.promise.finally.js"),i("./node_modules/core-js/modules/es7.promise.try.js"),t.exports=i("./node_modules/core-js/modules/_core.js").Promise},"./node_modules/core-js/modules/_a-function.js":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},"./node_modules/core-js/modules/_add-to-unscopables.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_wks.js")("unscopables"),r=Array.prototype;null==r[s]&&i("./node_modules/core-js/modules/_hide.js")(r,s,{}),t.exports=function(t){r[s][t]=!0}},"./node_modules/core-js/modules/_an-instance.js":function(t,e){t.exports=function(t,e,i,s){if(!(t instanceof e)||void 0!==s&&s in t)throw TypeError(i+": incorrect invocation!");return t}},"./node_modules/core-js/modules/_an-object.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_is-object.js");t.exports=function(t){if(!s(t))throw TypeError(t+" is not an object!");return t}},"./node_modules/core-js/modules/_array-includes.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_to-iobject.js"),r=i("./node_modules/core-js/modules/_to-length.js"),o=i("./node_modules/core-js/modules/_to-absolute-index.js");t.exports=function(t){return function(e,i,n){var a,l=s(e),u=r(l.length),h=o(n,u);if(t&&i!=i){for(;u>h;)if((a=l[h++])!=a)return!0}else for(;u>h;h++)if((t||h in l)&&l[h]===i)return t||h||0;return!t&&-1}}},"./node_modules/core-js/modules/_classof.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_cof.js"),r=i("./node_modules/core-js/modules/_wks.js")("toStringTag"),o="Arguments"==s(function(){return arguments}());t.exports=function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?i:o?s(e):"Object"==(n=s(e))&&"function"==typeof e.callee?"Arguments":n}},"./node_modules/core-js/modules/_cof.js":function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},"./node_modules/core-js/modules/_core.js":function(t,e){var i=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=i)},"./node_modules/core-js/modules/_ctx.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_a-function.js");t.exports=function(t,e,i){if(s(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,s){return t.call(e,i,s)};case 3:return function(i,s,r){return t.call(e,i,s,r)}}return function(){return t.apply(e,arguments)}}},"./node_modules/core-js/modules/_defined.js":function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},"./node_modules/core-js/modules/_descriptors.js":function(t,e,i){t.exports=!i("./node_modules/core-js/modules/_fails.js")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/modules/_dom-create.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_is-object.js"),r=i("./node_modules/core-js/modules/_global.js").document,o=s(r)&&s(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},"./node_modules/core-js/modules/_enum-bug-keys.js":function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},"./node_modules/core-js/modules/_export.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_global.js"),r=i("./node_modules/core-js/modules/_core.js"),o=i("./node_modules/core-js/modules/_hide.js"),n=i("./node_modules/core-js/modules/_redefine.js"),a=i("./node_modules/core-js/modules/_ctx.js"),l=function(t,e,i){var u,h,_,c,d=t&l.F,m=t&l.G,p=t&l.S,g=t&l.P,f=t&l.B,y=m?s:p?s[e]||(s[e]={}):(s[e]||{}).prototype,$=m?r:r[e]||(r[e]={}),S=$.prototype||($.prototype={});for(u in m&&(i=e),i)_=((h=!d&&y&&void 0!==y[u])?y:i)[u],c=f&&h?a(_,s):g&&"function"==typeof _?a(Function.call,_):_,y&&n(y,u,_,t&l.U),$[u]!=_&&o($,u,c),g&&S[u]!=_&&(S[u]=_)};s.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},"./node_modules/core-js/modules/_fails.js":function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},"./node_modules/core-js/modules/_for-of.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_ctx.js"),r=i("./node_modules/core-js/modules/_iter-call.js"),o=i("./node_modules/core-js/modules/_is-array-iter.js"),n=i("./node_modules/core-js/modules/_an-object.js"),a=i("./node_modules/core-js/modules/_to-length.js"),l=i("./node_modules/core-js/modules/core.get-iterator-method.js"),u={},h={};(e=t.exports=function(t,e,i,_,c){var d,m,p,g,f=c?function(){return t}:l(t),y=s(i,_,e?2:1),$=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(o(f)){for(d=a(t.length);d>$;$++)if((g=e?y(n(m=t[$])[0],m[1]):y(t[$]))===u||g===h)return g}else for(p=f.call(t);!(m=p.next()).done;)if((g=r(p,y,m.value,e))===u||g===h)return g}).BREAK=u,e.RETURN=h},"./node_modules/core-js/modules/_function-to-string.js":function(t,e,i){t.exports=i("./node_modules/core-js/modules/_shared.js")("native-function-to-string",Function.toString)},"./node_modules/core-js/modules/_global.js":function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},"./node_modules/core-js/modules/_has.js":function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},"./node_modules/core-js/modules/_hide.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_object-dp.js"),r=i("./node_modules/core-js/modules/_property-desc.js");t.exports=i("./node_modules/core-js/modules/_descriptors.js")?function(t,e,i){return s.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},"./node_modules/core-js/modules/_html.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_global.js").document;t.exports=s&&s.documentElement},"./node_modules/core-js/modules/_ie8-dom-define.js":function(t,e,i){t.exports=!i("./node_modules/core-js/modules/_descriptors.js")&&!i("./node_modules/core-js/modules/_fails.js")((function(){return 7!=Object.defineProperty(i("./node_modules/core-js/modules/_dom-create.js")("div"),"a",{get:function(){return 7}}).a}))},"./node_modules/core-js/modules/_invoke.js":function(t,e){t.exports=function(t,e,i){var s=void 0===i;switch(e.length){case 0:return s?t():t.call(i);case 1:return s?t(e[0]):t.call(i,e[0]);case 2:return s?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return s?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return s?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},"./node_modules/core-js/modules/_iobject.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_cof.js");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==s(t)?t.split(""):Object(t)}},"./node_modules/core-js/modules/_is-array-iter.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_iterators.js"),r=i("./node_modules/core-js/modules/_wks.js")("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(s.Array===t||o[r]===t)}},"./node_modules/core-js/modules/_is-object.js":function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},"./node_modules/core-js/modules/_iter-call.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_an-object.js");t.exports=function(t,e,i,r){try{return r?e(s(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&s(o.call(t)),e}}},"./node_modules/core-js/modules/_iter-create.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_object-create.js"),r=i("./node_modules/core-js/modules/_property-desc.js"),o=i("./node_modules/core-js/modules/_set-to-string-tag.js"),n={};i("./node_modules/core-js/modules/_hide.js")(n,i("./node_modules/core-js/modules/_wks.js")("iterator"),(function(){return this})),t.exports=function(t,e,i){t.prototype=s(n,{next:r(1,i)}),o(t,e+" Iterator")}},"./node_modules/core-js/modules/_iter-define.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_library.js"),r=i("./node_modules/core-js/modules/_export.js"),o=i("./node_modules/core-js/modules/_redefine.js"),n=i("./node_modules/core-js/modules/_hide.js"),a=i("./node_modules/core-js/modules/_iterators.js"),l=i("./node_modules/core-js/modules/_iter-create.js"),u=i("./node_modules/core-js/modules/_set-to-string-tag.js"),h=i("./node_modules/core-js/modules/_object-gpo.js"),_=i("./node_modules/core-js/modules/_wks.js")("iterator"),c=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,i,m,p,g,f){l(i,e,m);var y,$,S,v=function(t){if(!c&&t in w)return w[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},x=e+" Iterator",b="values"==p,P=!1,w=t.prototype,L=w[_]||w["@@iterator"]||p&&w[p],T=L||v(p),M=p?b?v("entries"):T:void 0,C="Array"==e&&w.entries||L;if(C&&(S=h(C.call(new t)))!==Object.prototype&&S.next&&(u(S,x,!0),s||"function"==typeof S[_]||n(S,_,d)),b&&L&&"values"!==L.name&&(P=!0,T=function(){return L.call(this)}),s&&!f||!c&&!P&&w[_]||n(w,_,T),a[e]=T,a[x]=d,p)if(y={values:b?T:v("values"),keys:g?T:v("keys"),entries:M},f)for($ in y)$ in w||o(w,$,y[$]);else r(r.P+r.F*(c||P),e,y);return y}},"./node_modules/core-js/modules/_iter-detect.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_wks.js")("iterator"),r=!1;try{var o=[7][s]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var i=!1;try{var o=[7],n=o[s]();n.next=function(){return{done:i=!0}},o[s]=function(){return n},t(o)}catch(t){}return i}},"./node_modules/core-js/modules/_iter-step.js":function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},"./node_modules/core-js/modules/_iterators.js":function(t,e){t.exports={}},"./node_modules/core-js/modules/_library.js":function(t,e){t.exports=!1},"./node_modules/core-js/modules/_microtask.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_global.js"),r=i("./node_modules/core-js/modules/_task.js").set,o=s.MutationObserver||s.WebKitMutationObserver,n=s.process,a=s.Promise,l="process"==i("./node_modules/core-js/modules/_cof.js")(n);t.exports=function(){var t,e,i,u=function(){var s,r;for(l&&(s=n.domain)&&s.exit();t;){r=t.fn,t=t.next;try{r()}catch(s){throw t?i():e=void 0,s}}e=void 0,s&&s.enter()};if(l)i=function(){n.nextTick(u)};else if(!o||s.navigator&&s.navigator.standalone)if(a&&a.resolve){var h=a.resolve(void 0);i=function(){h.then(u)}}else i=function(){r.call(s,u)};else{var _=!0,c=document.createTextNode("");new o(u).observe(c,{characterData:!0}),i=function(){c.data=_=!_}}return function(s){var r={fn:s,next:void 0};e&&(e.next=r),t||(t=r,i()),e=r}}},"./node_modules/core-js/modules/_new-promise-capability.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_a-function.js");function r(t){var e,i;this.promise=new t((function(t,s){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=s})),this.resolve=s(e),this.reject=s(i)}t.exports.f=function(t){return new r(t)}},"./node_modules/core-js/modules/_object-create.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_an-object.js"),r=i("./node_modules/core-js/modules/_object-dps.js"),o=i("./node_modules/core-js/modules/_enum-bug-keys.js"),n=i("./node_modules/core-js/modules/_shared-key.js")("IE_PROTO"),a=function(){},l=function(){var t,e=i("./node_modules/core-js/modules/_dom-create.js")("iframe"),s=o.length;for(e.style.display="none",i("./node_modules/core-js/modules/_html.js").appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;s--;)delete l.prototype[o[s]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=s(t),i=new a,a.prototype=null,i[n]=t):i=l(),void 0===e?i:r(i,e)}},"./node_modules/core-js/modules/_object-dp.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_an-object.js"),r=i("./node_modules/core-js/modules/_ie8-dom-define.js"),o=i("./node_modules/core-js/modules/_to-primitive.js"),n=Object.defineProperty;e.f=i("./node_modules/core-js/modules/_descriptors.js")?Object.defineProperty:function(t,e,i){if(s(t),e=o(e,!0),s(i),r)try{return n(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},"./node_modules/core-js/modules/_object-dps.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_object-dp.js"),r=i("./node_modules/core-js/modules/_an-object.js"),o=i("./node_modules/core-js/modules/_object-keys.js");t.exports=i("./node_modules/core-js/modules/_descriptors.js")?Object.defineProperties:function(t,e){r(t);for(var i,n=o(e),a=n.length,l=0;a>l;)s.f(t,i=n[l++],e[i]);return t}},"./node_modules/core-js/modules/_object-gpo.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_has.js"),r=i("./node_modules/core-js/modules/_to-object.js"),o=i("./node_modules/core-js/modules/_shared-key.js")("IE_PROTO"),n=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),s(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?n:null}},"./node_modules/core-js/modules/_object-keys-internal.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_has.js"),r=i("./node_modules/core-js/modules/_to-iobject.js"),o=i("./node_modules/core-js/modules/_array-includes.js")(!1),n=i("./node_modules/core-js/modules/_shared-key.js")("IE_PROTO");t.exports=function(t,e){var i,a=r(t),l=0,u=[];for(i in a)i!=n&&s(a,i)&&u.push(i);for(;e.length>l;)s(a,i=e[l++])&&(~o(u,i)||u.push(i));return u}},"./node_modules/core-js/modules/_object-keys.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_object-keys-internal.js"),r=i("./node_modules/core-js/modules/_enum-bug-keys.js");t.exports=Object.keys||function(t){return s(t,r)}},"./node_modules/core-js/modules/_perform.js":function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},"./node_modules/core-js/modules/_promise-resolve.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_an-object.js"),r=i("./node_modules/core-js/modules/_is-object.js"),o=i("./node_modules/core-js/modules/_new-promise-capability.js");t.exports=function(t,e){if(s(t),r(e)&&e.constructor===t)return e;var i=o.f(t);return(0,i.resolve)(e),i.promise}},"./node_modules/core-js/modules/_property-desc.js":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"./node_modules/core-js/modules/_redefine-all.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_redefine.js");t.exports=function(t,e,i){for(var r in e)s(t,r,e[r],i);return t}},"./node_modules/core-js/modules/_redefine.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_global.js"),r=i("./node_modules/core-js/modules/_hide.js"),o=i("./node_modules/core-js/modules/_has.js"),n=i("./node_modules/core-js/modules/_uid.js")("src"),a=i("./node_modules/core-js/modules/_function-to-string.js"),l=(""+a).split("toString");i("./node_modules/core-js/modules/_core.js").inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var u="function"==typeof i;u&&(o(i,"name")||r(i,"name",e)),t[e]!==i&&(u&&(o(i,n)||r(i,n,t[e]?""+t[e]:l.join(String(e)))),t===s?t[e]=i:a?t[e]?t[e]=i:r(t,e,i):(delete t[e],r(t,e,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[n]||a.call(this)}))},"./node_modules/core-js/modules/_set-species.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_global.js"),r=i("./node_modules/core-js/modules/_object-dp.js"),o=i("./node_modules/core-js/modules/_descriptors.js"),n=i("./node_modules/core-js/modules/_wks.js")("species");t.exports=function(t){var e=s[t];o&&e&&!e[n]&&r.f(e,n,{configurable:!0,get:function(){return this}})}},"./node_modules/core-js/modules/_set-to-string-tag.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_object-dp.js").f,r=i("./node_modules/core-js/modules/_has.js"),o=i("./node_modules/core-js/modules/_wks.js")("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,o)&&s(t,o,{configurable:!0,value:e})}},"./node_modules/core-js/modules/_shared-key.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_shared.js")("keys"),r=i("./node_modules/core-js/modules/_uid.js");t.exports=function(t){return s[t]||(s[t]=r(t))}},"./node_modules/core-js/modules/_shared.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_core.js"),r=i("./node_modules/core-js/modules/_global.js"),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:s.version,mode:i("./node_modules/core-js/modules/_library.js")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"./node_modules/core-js/modules/_species-constructor.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_an-object.js"),r=i("./node_modules/core-js/modules/_a-function.js"),o=i("./node_modules/core-js/modules/_wks.js")("species");t.exports=function(t,e){var i,n=s(t).constructor;return void 0===n||null==(i=s(n)[o])?e:r(i)}},"./node_modules/core-js/modules/_string-at.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_to-integer.js"),r=i("./node_modules/core-js/modules/_defined.js");t.exports=function(t){return function(e,i){var o,n,a=String(r(e)),l=s(i),u=a.length;return l<0||l>=u?t?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===u||(n=a.charCodeAt(l+1))<56320||n>57343?t?a.charAt(l):o:t?a.slice(l,l+2):n-56320+(o-55296<<10)+65536}}},"./node_modules/core-js/modules/_task.js":function(t,e,i){var s,r,o,n=i("./node_modules/core-js/modules/_ctx.js"),a=i("./node_modules/core-js/modules/_invoke.js"),l=i("./node_modules/core-js/modules/_html.js"),u=i("./node_modules/core-js/modules/_dom-create.js"),h=i("./node_modules/core-js/modules/_global.js"),_=h.process,c=h.setImmediate,d=h.clearImmediate,m=h.MessageChannel,p=h.Dispatch,g=0,f={},y=function(){var t=+this;if(f.hasOwnProperty(t)){var e=f[t];delete f[t],e()}},$=function(t){y.call(t.data)};c&&d||(c=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return f[++g]=function(){a("function"==typeof t?t:Function(t),e)},s(g),g},d=function(t){delete f[t]},"process"==i("./node_modules/core-js/modules/_cof.js")(_)?s=function(t){_.nextTick(n(y,t,1))}:p&&p.now?s=function(t){p.now(n(y,t,1))}:m?(o=(r=new m).port2,r.port1.onmessage=$,s=n(o.postMessage,o,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(s=function(t){h.postMessage(t+"","*")},h.addEventListener("message",$,!1)):s="onreadystatechange"in u("script")?function(t){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),y.call(t)}}:function(t){setTimeout(n(y,t,1),0)}),t.exports={set:c,clear:d}},"./node_modules/core-js/modules/_to-absolute-index.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_to-integer.js"),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=s(t))<0?r(t+e,0):o(t,e)}},"./node_modules/core-js/modules/_to-integer.js":function(t,e){var i=Math.ceil,s=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?s:i)(t)}},"./node_modules/core-js/modules/_to-iobject.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_iobject.js"),r=i("./node_modules/core-js/modules/_defined.js");t.exports=function(t){return s(r(t))}},"./node_modules/core-js/modules/_to-length.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_to-integer.js"),r=Math.min;t.exports=function(t){return t>0?r(s(t),9007199254740991):0}},"./node_modules/core-js/modules/_to-object.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_defined.js");t.exports=function(t){return Object(s(t))}},"./node_modules/core-js/modules/_to-primitive.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_is-object.js");t.exports=function(t,e){if(!s(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!s(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!s(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!s(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},"./node_modules/core-js/modules/_uid.js":function(t,e){var i=0,s=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+s).toString(36))}},"./node_modules/core-js/modules/_user-agent.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_global.js").navigator;t.exports=s&&s.userAgent||""},"./node_modules/core-js/modules/_wks.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_shared.js")("wks"),r=i("./node_modules/core-js/modules/_uid.js"),o=i("./node_modules/core-js/modules/_global.js").Symbol,n="function"==typeof o;(t.exports=function(t){return s[t]||(s[t]=n&&o[t]||(n?o:r)("Symbol."+t))}).store=s},"./node_modules/core-js/modules/core.get-iterator-method.js":function(t,e,i){var s=i("./node_modules/core-js/modules/_classof.js"),r=i("./node_modules/core-js/modules/_wks.js")("iterator"),o=i("./node_modules/core-js/modules/_iterators.js");t.exports=i("./node_modules/core-js/modules/_core.js").getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[s(t)]}},"./node_modules/core-js/modules/es6.array.iterator.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_add-to-unscopables.js"),r=i("./node_modules/core-js/modules/_iter-step.js"),o=i("./node_modules/core-js/modules/_iterators.js"),n=i("./node_modules/core-js/modules/_to-iobject.js");t.exports=i("./node_modules/core-js/modules/_iter-define.js")(Array,"Array",(function(t,e){this._t=n(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values"),o.Arguments=o.Array,s("keys"),s("values"),s("entries")},"./node_modules/core-js/modules/es6.object.to-string.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_classof.js"),r={};r[i("./node_modules/core-js/modules/_wks.js")("toStringTag")]="z",r+""!="[object z]"&&i("./node_modules/core-js/modules/_redefine.js")(Object.prototype,"toString",(function(){return"[object "+s(this)+"]"}),!0)},"./node_modules/core-js/modules/es6.promise.js":function(t,e,i){"use strict";var s,r,o,n,a=i("./node_modules/core-js/modules/_library.js"),l=i("./node_modules/core-js/modules/_global.js"),u=i("./node_modules/core-js/modules/_ctx.js"),h=i("./node_modules/core-js/modules/_classof.js"),_=i("./node_modules/core-js/modules/_export.js"),c=i("./node_modules/core-js/modules/_is-object.js"),d=i("./node_modules/core-js/modules/_a-function.js"),m=i("./node_modules/core-js/modules/_an-instance.js"),p=i("./node_modules/core-js/modules/_for-of.js"),g=i("./node_modules/core-js/modules/_species-constructor.js"),f=i("./node_modules/core-js/modules/_task.js").set,y=i("./node_modules/core-js/modules/_microtask.js")(),$=i("./node_modules/core-js/modules/_new-promise-capability.js"),S=i("./node_modules/core-js/modules/_perform.js"),v=i("./node_modules/core-js/modules/_user-agent.js"),x=i("./node_modules/core-js/modules/_promise-resolve.js"),b=l.TypeError,P=l.process,w=P&&P.versions,L=w&&w.v8||"",T=l.Promise,M="process"==h(P),C=function(){},F=r=$.f,I=!!function(){try{var t=T.resolve(1),e=(t.constructor={})[i("./node_modules/core-js/modules/_wks.js")("species")]=function(t){t(C,C)};return(M||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==L.indexOf("6.6")&&-1===v.indexOf("Chrome/66")}catch(t){}}(),E=function(t){var e;return!(!c(t)||"function"!=typeof(e=t.then))&&e},D=function(t,e){if(!t._n){t._n=!0;var i=t._c;y((function(){for(var s=t._v,r=1==t._s,o=0,n=function(e){var i,o,n,a=r?e.ok:e.fail,l=e.resolve,u=e.reject,h=e.domain;try{a?(r||(2==t._h&&R(t),t._h=1),!0===a?i=s:(h&&h.enter(),i=a(s),h&&(h.exit(),n=!0)),i===e.promise?u(b("Promise-chain cycle")):(o=E(i))?o.call(i,l,u):l(i)):u(s)}catch(t){h&&!n&&h.exit(),u(t)}};i.length>o;)n(i[o++]);t._c=[],t._n=!1,e&&!t._h&&B(t)}))}},B=function(t){f.call(l,(function(){var e,i,s,r=t._v,o=A(t);if(o&&(e=S((function(){M?P.emit("unhandledRejection",r,t):(i=l.onunhandledrejection)?i({promise:t,reason:r}):(s=l.console)&&s.error&&s.error("Unhandled promise rejection",r)})),t._h=M||A(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},A=function(t){return 1!==t._h&&0===(t._a||t._c).length},R=function(t){f.call(l,(function(){var e;M?P.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})}))},k=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),D(e,!0))},j=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw b("Promise can't be resolved itself");(e=E(t))?y((function(){var s={_w:i,_d:!1};try{e.call(t,u(j,s,1),u(k,s,1))}catch(t){k.call(s,t)}})):(i._v=t,i._s=1,D(i,!1))}catch(t){k.call({_w:i,_d:!1},t)}}};I||(T=function(t){m(this,T,"Promise","_h"),d(t),s.call(this);try{t(u(j,this,1),u(k,this,1))}catch(t){k.call(this,t)}},(s=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i("./node_modules/core-js/modules/_redefine-all.js")(T.prototype,{then:function(t,e){var i=F(g(this,T));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=M?P.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&D(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new s;this.promise=t,this.resolve=u(j,t,1),this.reject=u(k,t,1)},$.f=F=function(t){return t===T||t===n?new o(t):r(t)}),_(_.G+_.W+_.F*!I,{Promise:T}),i("./node_modules/core-js/modules/_set-to-string-tag.js")(T,"Promise"),i("./node_modules/core-js/modules/_set-species.js")("Promise"),n=i("./node_modules/core-js/modules/_core.js").Promise,_(_.S+_.F*!I,"Promise",{reject:function(t){var e=F(this);return(0,e.reject)(t),e.promise}}),_(_.S+_.F*(a||!I),"Promise",{resolve:function(t){return x(a&&this===n?T:this,t)}}),_(_.S+_.F*!(I&&i("./node_modules/core-js/modules/_iter-detect.js")((function(t){T.all(t).catch(C)}))),"Promise",{all:function(t){var e=this,i=F(e),s=i.resolve,r=i.reject,o=S((function(){var i=[],o=0,n=1;p(t,!1,(function(t){var a=o++,l=!1;i.push(void 0),n++,e.resolve(t).then((function(t){l||(l=!0,i[a]=t,--n||s(i))}),r)})),--n||s(i)}));return o.e&&r(o.v),i.promise},race:function(t){var e=this,i=F(e),s=i.reject,r=S((function(){p(t,!1,(function(t){e.resolve(t).then(i.resolve,s)}))}));return r.e&&s(r.v),i.promise}})},"./node_modules/core-js/modules/es6.string.iterator.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_string-at.js")(!0);i("./node_modules/core-js/modules/_iter-define.js")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=s(e,i),this._i+=t.length,{value:t,done:!1})}))},"./node_modules/core-js/modules/es7.promise.finally.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_export.js"),r=i("./node_modules/core-js/modules/_core.js"),o=i("./node_modules/core-js/modules/_global.js"),n=i("./node_modules/core-js/modules/_species-constructor.js"),a=i("./node_modules/core-js/modules/_promise-resolve.js");s(s.P+s.R,"Promise",{finally:function(t){var e=n(this,r.Promise||o.Promise),i="function"==typeof t;return this.then(i?function(i){return a(e,t()).then((function(){return i}))}:t,i?function(i){return a(e,t()).then((function(){throw i}))}:t)}})},"./node_modules/core-js/modules/es7.promise.try.js":function(t,e,i){"use strict";var s=i("./node_modules/core-js/modules/_export.js"),r=i("./node_modules/core-js/modules/_new-promise-capability.js"),o=i("./node_modules/core-js/modules/_perform.js");s(s.S,"Promise",{try:function(t){var e=r.f(this),i=o(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},"./node_modules/core-js/modules/web.dom.iterable.js":function(t,e,i){for(var s=i("./node_modules/core-js/modules/es6.array.iterator.js"),r=i("./node_modules/core-js/modules/_object-keys.js"),o=i("./node_modules/core-js/modules/_redefine.js"),n=i("./node_modules/core-js/modules/_global.js"),a=i("./node_modules/core-js/modules/_hide.js"),l=i("./node_modules/core-js/modules/_iterators.js"),u=i("./node_modules/core-js/modules/_wks.js"),h=u("iterator"),_=u("toStringTag"),c=l.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=r(d),p=0;p<m.length;p++){var g,f=m[p],y=d[f],$=n[f],S=$&&$.prototype;if(S&&(S[h]||a(S,h,c),S[_]||a(S,_,f),l[f]=c,y))for(g in s)S[g]||o(S,g,s[g],!0)}},"./node_modules/webpack/buildin/system.js":function(t,e){t.exports={import:function(){throw new Error("System.import cannot be used indirectly")}}},"./node_modules/whatwg-fetch/fetch.js":function(t,e){!function(){"use strict";if(!self.fetch){o.prototype.append=function(t,e){t=s(t),e=r(e);var i=this.map[t];i||(i=[],this.map[t]=i),i.push(e)},o.prototype.delete=function(t){delete this.map[s(t)]},o.prototype.get=function(t){var e=this.map[s(t)];return e?e[0]:null},o.prototype.getAll=function(t){return this.map[s(t)]||[]},o.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},o.prototype.set=function(t,e){this.map[s(t)]=[r(e)]},o.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach((function(i){this.map[i].forEach((function(s){t.call(e,s,i,this)}),this)}),this)};var t="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),e="FormData"in self,i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.call(h.prototype),u.call(d.prototype),self.Headers=o,self.Request=h,self.Response=d,self.fetch=function(e,i){var s;return s=h.prototype.isPrototypeOf(e)&&!i?e:new h(e,i),new Promise((function(e,i){var r=new XMLHttpRequest;r.onload=function(){var t=1223===r.status?204:r.status;if(t<100||t>599)i(new TypeError("Network request failed"));else{var s={status:t,statusText:r.statusText,headers:c(r),url:"responseURL"in r?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):void 0},o="response"in r?r.response:r.responseText;e(new d(o,s))}},r.onerror=function(){i(new TypeError("Network request failed"))},r.open(s.method,s.url,!0),"include"===s.credentials&&(r.withCredentials=!0),"responseType"in r&&t&&(r.responseType="blob"),s.headers.forEach((function(t,e){r.setRequestHeader(e,t)})),r.send(void 0===s._bodyInit?null:s._bodyInit)}))},self.fetch.polyfill=!0}function s(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=t.toString()),t}function o(t){this.map={},t instanceof o?t.forEach((function(t,e){this.append(e,t)}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function n(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise((function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}}))}function l(t){var e=new FileReader;return e.readAsArrayBuffer(t),a(e)}function u(){return this.bodyUsed=!1,this._initBody=function(i){if(this._bodyInit=i,"string"==typeof i)this._bodyText=i;else if(t&&Blob.prototype.isPrototypeOf(i))this._bodyBlob=i;else if(e&&FormData.prototype.isPrototypeOf(i))this._bodyFormData=i;else{if(i)throw new Error("unsupported BodyInit type");this._bodyText=""}},t?(this.blob=function(){var t=n(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(l)},this.text=function(){var t,e,i=n(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,(e=new FileReader).readAsText(t),a(e);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=n(this);return t||Promise.resolve(this._bodyText)},e&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(t,e){var s,r;if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new o(e.headers),this.method=(s=e.method||"GET",r=s.toUpperCase(),i.indexOf(r)>-1?r:s),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var i=t.split("="),s=i.shift().replace(/\+/g," "),r=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(s),decodeURIComponent(r))}})),e}function c(t){var e=new o;return t.getAllResponseHeaders().trim().split("\n").forEach((function(t){var i=t.trim().split(":"),s=i.shift().trim(),r=i.join(":").trim();e.append(s,r)})),e}function d(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof o?e.headers:new o(e.headers),this.url=e.url||""}}()},"./src/Framework/cubismdefaultparameterid.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){t.HitAreaPrefix="HitArea",t.HitAreaHead="Head",t.HitAreaBody="Body",t.PartsIdCore="Parts01Core",t.PartsArmPrefix="Parts01Arm_",t.PartsArmLPrefix="Parts01ArmL_",t.PartsArmRPrefix="Parts01ArmR_",t.ParamAngleX="ParamAngleX",t.ParamAngleY="ParamAngleY",t.ParamAngleZ="ParamAngleZ",t.ParamEyeLOpen="ParamEyeLOpen",t.ParamEyeLSmile="ParamEyeLSmile",t.ParamEyeROpen="ParamEyeROpen",t.ParamEyeRSmile="ParamEyeRSmile",t.ParamEyeBallX="ParamEyeBallX",t.ParamEyeBallY="ParamEyeBallY",t.ParamEyeBallForm="ParamEyeBallForm",t.ParamBrowLY="ParamBrowLY",t.ParamBrowRY="ParamBrowRY",t.ParamBrowLX="ParamBrowLX",t.ParamBrowRX="ParamBrowRX",t.ParamBrowLAngle="ParamBrowLAngle",t.ParamBrowRAngle="ParamBrowRAngle",t.ParamBrowLForm="ParamBrowLForm",t.ParamBrowRForm="ParamBrowRForm",t.ParamMouthForm="ParamMouthForm",t.ParamMouthOpenY="ParamMouthOpenY",t.ParamCheek="ParamCheek",t.ParamBodyAngleX="ParamBodyAngleX",t.ParamBodyAngleY="ParamBodyAngleY",t.ParamBodyAngleZ="ParamBodyAngleZ",t.ParamBreath="ParamBreath",t.ParamArmLA="ParamArmLA",t.ParamArmRA="ParamArmRA",t.ParamArmLB="ParamArmLB",t.ParamArmRB="ParamArmRB",t.ParamHandL="ParamHandL",t.ParamHandR="ParamHandR",t.ParamHairFront="ParamHairFront",t.ParamHairSide="ParamHairSide",t.ParamHairBack="ParamHairBack",t.ParamHairFluffy="ParamHairFluffy",t.ParamShoulderY="ParamShoulderY",t.ParamBustX="ParamBustX",t.ParamBustY="ParamBustY",t.ParamBaseX="ParamBaseX",t.ParamBaseY="ParamBaseY",t.ParamNONE="NONE:"}(s||(s={}))},"./src/Framework/cubismframeworkconfig.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"CSM_LOG_LEVEL_VERBOSE",(function(){return s})),i.d(e,"CSM_LOG_LEVEL_DEBUG",(function(){return r})),i.d(e,"CSM_LOG_LEVEL_INFO",(function(){return o})),i.d(e,"CSM_LOG_LEVEL_WARNING",(function(){return n})),i.d(e,"CSM_LOG_LEVEL_ERROR",(function(){return a})),i.d(e,"CSM_LOG_LEVEL_OFF",(function(){return l})),i.d(e,"CSM_LOG_LEVEL",(function(){return u}));const s=0,r=1,o=2,n=3,a=4,l=5,u=s},"./src/Framework/cubismmodelsettingjson.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/live2dcubismframework.ts"),o=i("./src/Framework/icubismmodelsetting.ts"),n=i("./src/Framework/utils/cubismjson.ts"),a=i("./src/Framework/type/csmvector.ts").Live2DCubismFramework.csmVector,l=r.Live2DCubismFramework.CubismFramework,u=n.Live2DCubismFramework.CubismJson,h=o.Live2DCubismFramework.ICubismModelSetting;!function(t){const e="Name";let i;!function(t){t[t.FrequestNode_Groups=0]="FrequestNode_Groups",t[t.FrequestNode_Moc=1]="FrequestNode_Moc",t[t.FrequestNode_Motions=2]="FrequestNode_Motions",t[t.FrequestNode_Expressions=3]="FrequestNode_Expressions",t[t.FrequestNode_Textures=4]="FrequestNode_Textures",t[t.FrequestNode_Physics=5]="FrequestNode_Physics",t[t.FrequestNode_Pose=6]="FrequestNode_Pose",t[t.FrequestNode_HitAreas=7]="FrequestNode_HitAreas"}(i||(i={}));t.CubismModelSettingJson=class extends h{constructor(t,e){super(),this._json=u.create(t,e),this._json&&(this._jsonValue=new a,this._jsonValue.pushBack(this._json.getRoot().getValueByString("Groups")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Moc")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Motions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Expressions")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Textures")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Physics")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("FileReferences").getValueByString("Pose")),this._jsonValue.pushBack(this._json.getRoot().getValueByString("HitAreas")))}release(){u.delete(this._json),this._jsonValue=null}GetJson(){return this._json}getModelFileName(){return this.isExistModelFile()?this._jsonValue.at(i.FrequestNode_Moc).getRawString():""}getTextureCount(){return this.isExistTextureFiles()?this._jsonValue.at(i.FrequestNode_Textures).getSize():0}getTextureDirectory(){return this._jsonValue.at(i.FrequestNode_Textures).getRawString()}getTextureFileName(t){return this._jsonValue.at(i.FrequestNode_Textures).getValueByIndex(t).getRawString()}getHitAreasCount(){return this.isExistHitAreas()?this._jsonValue.at(i.FrequestNode_HitAreas).getSize():0}getHitAreaId(t){return l.getIdManager().getId(this._jsonValue.at(i.FrequestNode_HitAreas).getValueByIndex(t).getValueByString("Id").getRawString())}getHitAreaName(t){return this._jsonValue.at(i.FrequestNode_HitAreas).getValueByIndex(t).getValueByString(e).getRawString()}getPhysicsFileName(){return this.isExistPhysicsFile()?this._jsonValue.at(i.FrequestNode_Physics).getRawString():""}getPoseFileName(){return this.isExistPoseFile()?this._jsonValue.at(i.FrequestNode_Pose).getRawString():""}getExpressionCount(){return this.isExistExpressionFile()?this._jsonValue.at(i.FrequestNode_Expressions).getSize():0}getExpressionName(t){return this._jsonValue.at(i.FrequestNode_Expressions).getValueByIndex(t).getValueByString(e).getRawString()}getExpressionFileName(t){return this._jsonValue.at(i.FrequestNode_Expressions).getValueByIndex(t).getValueByString("File").getRawString()}getMotionGroupCount(){return this.isExistMotionGroups()?this._jsonValue.at(i.FrequestNode_Motions).getKeys().getSize():0}getMotionGroupName(t){return this.isExistMotionGroups()?this._jsonValue.at(i.FrequestNode_Motions).getKeys().at(t):null}getMotionCount(t){return this.isExistMotionGroupName(t)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getSize():0}getMotionFileName(t,e){return this.isExistMotionGroupName(t)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("File").getRawString():""}getMotionSoundFileName(t,e){return this.isExistMotionSoundFile(t,e)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("Sound").getRawString():""}getMotionFadeInTimeValue(t,e){return this.isExistMotionFadeIn(t,e)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeInTime").toFloat():-1}getMotionFadeOutTimeValue(t,e){return this.isExistMotionFadeOut(t,e)?this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeOutTime").toFloat():-1}getUserDataFile(){return this.isExistUserDataFile()?this._json.getRoot().getValueByString("FileReferences").getValueByString("UserData").getRawString():""}getLayoutMap(t){const e=this._json.getRoot().getValueByString("Layout").getMap();if(null==e)return!1;let i=!1;for(const s=e.begin();s.notEqual(e.end());s.preIncrement())t.setValue(s.ptr().first,s.ptr().second.toFloat()),i=!0;return i}getEyeBlinkParameterCount(){if(!this.isExistEyeBlinkParameters())return 0;let t=0;for(let s=0;s<this._jsonValue.at(i.FrequestNode_Groups).getSize();s++){const r=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(s);if(!r.isNull()&&!r.isError()&&"EyeBlink"==r.getValueByString(e).getRawString()){t=r.getValueByString("Ids").getVector().getSize();break}}return t}getEyeBlinkParameterId(t){if(!this.isExistEyeBlinkParameters())return null;for(let s=0;s<this._jsonValue.at(i.FrequestNode_Groups).getSize();s++){const r=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(s);if(!r.isNull()&&!r.isError()&&"EyeBlink"==r.getValueByString(e).getRawString())return l.getIdManager().getId(r.getValueByString("Ids").getValueByIndex(t).getRawString())}return null}getLipSyncParameterCount(){if(!this.isExistLipSyncParameters())return 0;let t=0;for(let s=0;s<this._jsonValue.at(i.FrequestNode_Groups).getSize();s++){const r=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(s);if(!r.isNull()&&!r.isError()&&"LipSync"==r.getValueByString(e).getRawString()){t=r.getValueByString("Ids").getVector().getSize();break}}return t}getLipSyncParameterId(t){if(!this.isExistLipSyncParameters())return null;for(let s=0;s<this._jsonValue.at(i.FrequestNode_Groups).getSize();s++){const r=this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(s);if(!r.isNull()&&!r.isError()&&"LipSync"==r.getValueByString(e).getRawString())return l.getIdManager().getId(r.getValueByString("Ids").getValueByIndex(t).getRawString())}return null}isExistModelFile(){const t=this._jsonValue.at(i.FrequestNode_Moc);return!t.isNull()&&!t.isError()}isExistTextureFiles(){const t=this._jsonValue.at(i.FrequestNode_Textures);return!t.isNull()&&!t.isError()}isExistHitAreas(){const t=this._jsonValue.at(i.FrequestNode_HitAreas);return!t.isNull()&&!t.isError()}isExistPhysicsFile(){const t=this._jsonValue.at(i.FrequestNode_Physics);return!t.isNull()&&!t.isError()}isExistPoseFile(){const t=this._jsonValue.at(i.FrequestNode_Pose);return!t.isNull()&&!t.isError()}isExistExpressionFile(){const t=this._jsonValue.at(i.FrequestNode_Expressions);return!t.isNull()&&!t.isError()}isExistMotionGroups(){const t=this._jsonValue.at(i.FrequestNode_Motions);return!t.isNull()&&!t.isError()}isExistMotionGroupName(t){const e=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t);return!e.isNull()&&!e.isError()}isExistMotionSoundFile(t,e){const s=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("Sound");return!s.isNull()&&!s.isError()}isExistMotionFadeIn(t,e){const s=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeInTime");return!s.isNull()&&!s.isError()}isExistMotionFadeOut(t,e){const s=this._jsonValue.at(i.FrequestNode_Motions).getValueByString(t).getValueByIndex(e).getValueByString("FadeOutTime");return!s.isNull()&&!s.isError()}isExistUserDataFile(){const t=this._json.getRoot().getValueByString("FileReferences").getValueByString("UserData");return!t.isNull()&&!t.isError()}isExistEyeBlinkParameters(){if(this._jsonValue.at(i.FrequestNode_Groups).isNull()||this._jsonValue.at(i.FrequestNode_Groups).isError())return!1;for(let t=0;t<this._jsonValue.at(i.FrequestNode_Groups).getSize();++t)if("EyeBlink"==this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(t).getValueByString(e).getRawString())return!0;return!1}isExistLipSyncParameters(){if(this._jsonValue.at(i.FrequestNode_Groups).isNull()||this._jsonValue.at(i.FrequestNode_Groups).isError())return!1;for(let t=0;t<this._jsonValue.at(i.FrequestNode_Groups).getSize();++t)if("LipSync"==this._jsonValue.at(i.FrequestNode_Groups).getValueByIndex(t).getValueByString(e).getRawString())return!0;return!1}}}(s||(s={}))},"./src/Framework/effect/cubismbreath.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){class e{constructor(){this._currentTime=0}static create(){return new e}static delete(t){null!=t&&(t=null)}setParameters(t){this._breathParameters=t}getParameters(){return this._breathParameters}updateParameters(t,e){this._currentTime+=e;const i=2*this._currentTime*3.14159;for(let e=0;e<this._breathParameters.getSize();++e){const s=this._breathParameters.at(e);t.addParameterValueById(s.parameterId,s.offset+s.peak*Math.sin(i/s.cycle),s.weight)}}}t.CubismBreath=e;t.BreathParameterData=class{constructor(t,e,i,s,r){this.parameterId=null==t?null:t,this.offset=null==e?0:e,this.peak=null==i?0:i,this.cycle=null==s?0:s,this.weight=null==r?0:r}}}(s||(s={}))},"./src/Framework/effect/cubismeyeblink.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/type/csmvector.ts").Live2DCubismFramework.csmVector;!function(t){class e{constructor(t){if(this._blinkingState=i.EyeState_First,this._nextBlinkingTime=0,this._stateStartTimeSeconds=0,this._blinkingIntervalSeconds=4,this._closingSeconds=.1,this._closedSeconds=.05,this._openingSeconds=.15,this._userTimeSeconds=0,this._parameterIds=new r,null!=t)for(let e=0;e<t.getEyeBlinkParameterCount();++e)this._parameterIds.pushBack(t.getEyeBlinkParameterId(e))}static create(t=null){return new e(t)}static delete(t){null!=t&&(t=null)}setBlinkingInterval(t){this._blinkingIntervalSeconds=t}setBlinkingSetting(t,e,i){this._closingSeconds=t,this._closedSeconds=e,this._openingSeconds=i}setParameterIds(t){this._parameterIds=t}getParameterIds(){return this._parameterIds}updateParameters(t,s){let r;this._userTimeSeconds+=s;let o=0;switch(this._blinkingState){case i.EyeState_Closing:o=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closingSeconds,o>=1&&(o=1,this._blinkingState=i.EyeState_Closed,this._stateStartTimeSeconds=this._userTimeSeconds),r=1-o;break;case i.EyeState_Closed:o=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._closedSeconds,o>=1&&(this._blinkingState=i.EyeState_Opening,this._stateStartTimeSeconds=this._userTimeSeconds),r=0;break;case i.EyeState_Opening:o=(this._userTimeSeconds-this._stateStartTimeSeconds)/this._openingSeconds,o>=1&&(o=1,this._blinkingState=i.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming()),r=o;break;case i.EyeState_Interval:this._nextBlinkingTime<this._userTimeSeconds&&(this._blinkingState=i.EyeState_Closing,this._stateStartTimeSeconds=this._userTimeSeconds),r=1;break;case i.EyeState_First:default:this._blinkingState=i.EyeState_Interval,this._nextBlinkingTime=this.determinNextBlinkingTiming(),r=1}e.CloseIfZero||(r=-r);for(let e=0;e<this._parameterIds.getSize();++e)t.setParameterValueById(this._parameterIds.at(e),r)}determinNextBlinkingTiming(){const t=Math.random();return this._userTimeSeconds+t*(2*this._blinkingIntervalSeconds-1)}}let i;e.CloseIfZero=!0,t.CubismEyeBlink=e,function(t){t[t.EyeState_First=0]="EyeState_First",t[t.EyeState_Interval=1]="EyeState_Interval",t[t.EyeState_Closing=2]="EyeState_Closing",t[t.EyeState_Closed=3]="EyeState_Closed",t[t.EyeState_Opening=4]="EyeState_Opening"}(i=t.EyeState||(t.EyeState={}))}(s||(s={}))},"./src/Framework/effect/cubismpose.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/type/csmvector.ts"),o=i("./src/Framework/live2dcubismframework.ts"),n=i("./src/Framework/utils/cubismjson.ts"),a=r.Live2DCubismFramework.csmVector,l=o.Live2DCubismFramework.CubismFramework,u=n.Live2DCubismFramework.CubismJson;!function(t){class e{constructor(){this._fadeTimeSeconds=.5,this._lastModel=null,this._partGroups=new a,this._partGroupCounts=new a}static create(t,s){const r=new e,o=u.create(t,s),n=o.getRoot();n.getValueByString("FadeInTime").isNull()||(r._fadeTimeSeconds=n.getValueByString("FadeInTime").toFloat(.5),r._fadeTimeSeconds<=0&&(r._fadeTimeSeconds=.5));const a=n.getValueByString("Groups"),h=a.getSize();for(let t=0;t<h;++t){const e=a.getValueByIndex(t),s=e.getSize();let o=0;for(let t=0;t<s;++t){const s=e.getValueByIndex(t),n=new i,a=l.getIdManager().getId(s.getValueByString("Id").getRawString());if(n.partId=a,!s.getValueByString("Link").isNull()){const t=s.getValueByString("Link"),e=t.getSize();for(let s=0;s<e;++s){const e=new i,r=l.getIdManager().getId(t.getValueByIndex(s).getString());e.partId=r,n.link.pushBack(e)}}r._partGroups.pushBack(n.clone()),++o}r._partGroupCounts.pushBack(o)}return u.delete(o),r}static delete(t){null!=t&&(t=null)}updateParameters(t,e){t!=this._lastModel&&this.reset(t),this._lastModel=t,e<0&&(e=0);let i=0;for(let s=0;s<this._partGroupCounts.getSize();s++){const r=this._partGroupCounts.at(s);this.doFade(t,e,i,r),i+=r}this.copyPartOpacities(t)}reset(t){let e=0;for(let i=0;i<this._partGroupCounts.getSize();++i){const s=this._partGroupCounts.at(i);for(let i=e;i<e+s;++i){this._partGroups.at(i).initialize(t);const s=this._partGroups.at(i).partIndex,r=this._partGroups.at(i).parameterIndex;if(!(s<0)){t.setPartOpacityByIndex(s,i==e?1:0),t.setParameterValueByIndex(r,i==e?1:0);for(let e=0;e<this._partGroups.at(i).link.getSize();++e)this._partGroups.at(i).link.at(e).initialize(t)}}e+=s}}copyPartOpacities(t){for(let e=0;e<this._partGroups.getSize();++e){const i=this._partGroups.at(e);if(0==i.link.getSize())continue;const s=this._partGroups.at(e).partIndex,r=t.getPartOpacityByIndex(s);for(let e=0;e<i.link.getSize();++e){const s=i.link.at(e).partIndex;s<0||t.setPartOpacityByIndex(s,r)}}}doFade(t,e,i,s){let r=-1,o=1;for(let n=i;n<i+s;++n){const i=this._partGroups.at(n).partIndex,s=this._partGroups.at(n).parameterIndex;if(t.getParameterValueByIndex(s)>.001){if(r>=0)break;r=n,o=t.getPartOpacityByIndex(i),o+=e/this._fadeTimeSeconds,o>1&&(o=1)}}r<0&&(r=0,o=1);for(let e=i;e<i+s;++e){const i=this._partGroups.at(e).partIndex;if(r==e)t.setPartOpacityByIndex(i,o);else{let e,s=t.getPartOpacityByIndex(i);e=o<.5?-.5*o/.5+1:.5*(1-o)/.5;(1-e)*(1-o)>.15&&(e=1-.15/(1-o)),s>e&&(s=e),t.setPartOpacityByIndex(i,s)}}}}t.CubismPose=e;class i{constructor(t){if(this.parameterIndex=0,this.partIndex=0,this.link=new a,null!=t){this.partId=t.partId;for(const e=t.link.begin();e.notEqual(t.link.end());e.preIncrement())this.link.pushBack(e.ptr().clone())}}assignment(t){this.partId=t.partId;for(const e=t.link.begin();e.notEqual(t.link.end());e.preIncrement())this.link.pushBack(e.ptr().clone());return this}initialize(t){this.parameterIndex=t.getParameterIndex(this.partId),this.partIndex=t.getPartIndex(this.partId),t.setParameterValueByIndex(this.parameterIndex,1)}clone(){const t=new i;t.partId=this.partId,t.parameterIndex=this.parameterIndex,t.partIndex=this.partIndex,t.link=new a;for(let e=this.link.begin();e.notEqual(this.link.end());e.increment())t.link.pushBack(e.ptr().clone());return t}}t.PartData=i}(s||(s={}))},"./src/Framework/icubismmodelsetting.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){t.ICubismModelSetting=class{}}(s||(s={}))},"./src/Framework/id/cubismid.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/type/csmstring.ts").Live2DCubismFramework.csmString;!function(t){class e{constructor(t){this._id="string"!=typeof t?t:new r(t)}getString(){return this._id}isEqual(t){return"string"==typeof t?this._id.isEqual(t):t instanceof r?this._id.isEqual(t.s):t instanceof e&&this._id.isEqual(t._id.s)}isNotEqual(t){return"string"==typeof t?!this._id.isEqual(t):t instanceof r?!this._id.isEqual(t.s):t instanceof e&&!this._id.isEqual(t._id.s)}}t.CubismId=e}(s||(s={}))},"./src/Framework/id/cubismidmanager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/type/csmvector.ts"),o=i("./src/Framework/id/cubismid.ts").Live2DCubismFramework.CubismId,n=r.Live2DCubismFramework.csmVector;!function(t){t.CubismIdManager=class{constructor(){this._ids=new n}release(){for(let t=0;t<this._ids.getSize();++t)this._ids.set(t,void 0);this._ids=null}registerIds(t){for(let e=0;e<t.length;e++)this.registerId(t[e])}registerId(t){let e=null;return"string"!=typeof t?this.registerId(t.s):(null!=(e=this.findId(t))||(e=new o(t),this._ids.pushBack(e)),e)}getId(t){return this.registerId(t)}isExist(t){return"string"==typeof t?null!=this.findId(t):this.isExist(t.s)}findId(t){for(let e=0;e<this._ids.getSize();++e)if(this._ids.at(e).getString().isEqual(t))return this._ids.at(e);return null}}}(s||(s={}))},"./src/Framework/live2dcubismframework.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"strtod",(function(){return c})),i.d(e,"Live2DCubismFramework",(function(){return s})),i.d(e,"Option",(function(){return d})),i.d(e,"LogLevel",(function(){return r}));var s,r,o=i("./src/Framework/utils/cubismjson.ts"),n=i("./src/Framework/id/cubismidmanager.ts"),a=i("./src/Framework/rendering/cubismrenderer.ts"),l=i("./src/Framework/utils/cubismdebug.ts"),u=o.Live2DCubismFramework.Value,h=n.Live2DCubismFramework.CubismIdManager,_=a.Live2DCubismFramework.CubismRenderer;function c(t,e){let i=0;for(let e=1;;e++){const s=t.slice(e-1,e);if("e"==s||"-"==s||"E"==s)continue;const r=t.substring(0,e),o=Number(r);if(isNaN(o))break;i=e}let s=parseFloat(t);return isNaN(s)&&(s=NaN),e[0]=t.slice(i),s}!function(t){let e,i=!1,s=!1,o=null,n=null;!function(t){t.vertexOffset=0,t.vertexStep=2}(e=t.Constant||(t.Constant={})),t.csmDelete=function(t){t&&(t=void 0)};t.CubismFramework=class{static startUp(t=null){if(i)return Object(l.CubismLogInfo)("CubismFramework.startUp() is already done."),i;if(o=t,null!=o&&Live2DCubismCore.Logging.csmSetLogFunction(o.logFunction),i=!0,i){const t=Live2DCubismCore.Version.csmGetVersion(),e=(4278190080&t)>>24,i=(16711680&t)>>16,s=65535&t,r=t;Object(l.CubismLogInfo)("Live2D Cubism Core version: {0}.{1}.{2} ({3})",("00"+e).slice(-2),("00"+i).slice(-2),("0000"+s).slice(-4),r)}return Object(l.CubismLogInfo)("CubismFramework.startUp() is complete."),i}static cleanUp(){i=!1,s=!1,o=null,n=null}static initialize(){Object(l.CSM_ASSERT)(i),i?s?Object(l.CubismLogWarning)("CubismFramework.initialize() skipped, already initialized."):(u.staticInitializeNotForClientCall(),n=new h,s=!0,Object(l.CubismLogInfo)("CubismFramework.initialize() is complete.")):Object(l.CubismLogWarning)("CubismFramework is not started.")}static dispose(){Object(l.CSM_ASSERT)(i),i?s?(u.staticReleaseNotForClientCall(),n.release(),n=null,_.staticRelease(),s=!1,Object(l.CubismLogInfo)("CubismFramework.dispose() is complete.")):Object(l.CubismLogWarning)("CubismFramework.dispose() skipped, not initialized."):Object(l.CubismLogWarning)("CubismFramework is not started.")}static isStarted(){return i}static isInitialized(){return s}static coreLogFunction(t){Live2DCubismCore.Logging.csmGetLogFunction()&&Live2DCubismCore.Logging.csmGetLogFunction()(t)}static getLoggingLevel(){return null!=o?o.loggingLevel:r.LogLevel_Off}static getIdManager(){return n}constructor(){}}}(s||(s={}));class d{}!function(t){t[t.LogLevel_Verbose=0]="LogLevel_Verbose",t[t.LogLevel_Debug=1]="LogLevel_Debug",t[t.LogLevel_Info=2]="LogLevel_Info",t[t.LogLevel_Warning=3]="LogLevel_Warning",t[t.LogLevel_Error=4]="LogLevel_Error",t[t.LogLevel_Off=5]="LogLevel_Off"}(r||(r={}))},"./src/Framework/math/cubismmath.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismvector2.ts").Live2DCubismFramework.CubismVector2;!function(t){t.CubismMath=class{static range(t,e,i){return t<e?t=e:t>i&&(t=i),t}static sin(t){return Math.sin(t)}static cos(t){return Math.cos(t)}static abs(t){return Math.abs(t)}static sqrt(t){return Math.sqrt(t)}static getEasingSine(t){return t<0?0:t>1?1:.5-.5*this.cos(t*Math.PI)}static max(t,e){return t>e?t:e}static min(t,e){return t>e?e:t}static degreesToRadian(t){return t/180*Math.PI}static radianToDegrees(t){return 180*t/Math.PI}static directionToRadian(t,e){let i=Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x);for(;i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;return i}static directionToDegrees(t,e){const i=this.directionToRadian(t,e);let s=this.radianToDegrees(i);return e.x-t.x>0&&(s=-s),s}static radianToDirection(t){const e=new r;return e.x=this.sin(t),e.y=this.cos(t),e}constructor(){}}}(s||(s={}))},"./src/Framework/math/cubismmatrix44.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){class e{constructor(){this._tr=new Float32Array(16),this.loadIdentity()}static multiply(t,e,i){const s=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);for(let i=0;i<4;++i)for(let r=0;r<4;++r)for(let o=0;o<4;++o)s[r+4*i]+=t[o+4*i]*e[r+4*o];for(let t=0;t<16;++t)i[t]=s[t]}loadIdentity(){const t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.setMatrix(t)}setMatrix(t){for(let e=0;e<16;++e)this._tr[e]=t[e]}getArray(){return this._tr}getScaleX(){return this._tr[0]}getScaleY(){return this._tr[5]}getTranslateX(){return this._tr[12]}getTranslateY(){return this._tr[13]}transformX(t){return this._tr[0]*t+this._tr[12]}transformY(t){return this._tr[5]*t+this._tr[13]}invertTransformX(t){return(t-this._tr[12])/this._tr[0]}invertTransformY(t){return(t-this._tr[13])/this._tr[5]}translateRelative(t,i){const s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1]);e.multiply(s,this._tr,this._tr)}translate(t,e){this._tr[12]=t,this._tr[13]=e}translateX(t){this._tr[12]=t}translateY(t){this._tr[13]=t}scaleRelative(t,i){const s=new Float32Array([t,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1]);e.multiply(s,this._tr,this._tr)}scale(t,e){this._tr[0]=t,this._tr[5]=e}multiplyByMatrix(t){e.multiply(t.getArray(),this._tr,this._tr)}clone(){const t=new e;for(let e=0;e<this._tr.length;e++)t._tr[e]=this._tr[e];return t}}t.CubismMatrix44=e}(s||(s={}))},"./src/Framework/math/cubismmodelmatrix.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismmatrix44.ts").Live2DCubismFramework.CubismMatrix44;!function(t){t.CubismModelMatrix=class extends r{constructor(t,e){super(),this._width=void 0!==t?t:0,this._height=void 0!==e?e:0,this.setHeight(1)}setWidth(t){const e=t/this._width,i=e;this.scale(e,i)}setHeight(t){const e=t/this._height,i=e;this.scale(e,i)}setPosition(t,e){this.translate(t,e)}setCenterPosition(t,e){this.centerX(t),this.centerY(e)}top(t){this.setY(t)}bottom(t){const e=this._height*this.getScaleY();this.translateY(t-e)}left(t){this.setX(t)}right(t){const e=this._width*this.getScaleX();this.translateX(t-e)}centerX(t){const e=this._width*this.getScaleX();this.translateX(t-e/2)}setX(t){this.translateX(t)}centerY(t){const e=this._height*this.getScaleY();this.translateY(t-e/2)}setY(t){this.translateY(t)}setupFromLayout(t){for(const e=t.begin();e.notEqual(t.end());e.preIncrement()){const t=e.ptr().first,i=e.ptr().second;"width"==t?this.setWidth(i):"height"==t&&this.setHeight(i)}for(const e=t.begin();e.notEqual(t.end());e.preIncrement()){const t=e.ptr().first,i=e.ptr().second;"x"==t?this.setX(i):"y"==t?this.setY(i):"center_x"==t?this.centerX(i):"center_y"==t?this.centerY(i):"top"==t?this.top(i):"bottom"==t?this.bottom(i):"left"==t?this.left(i):"right"==t&&this.right(i)}}}}(s||(s={}))},"./src/Framework/math/cubismtargetpoint.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismmath.ts").Live2DCubismFramework.CubismMath;!function(t){t.CubismTargetPoint=class{constructor(){this._faceTargetX=0,this._faceTargetY=0,this._faceX=0,this._faceY=0,this._faceVX=0,this._faceVY=0,this._lastTimeSeconds=0,this._userTimeSeconds=0}update(t){this._userTimeSeconds+=t;if(0==this._lastTimeSeconds)return void(this._lastTimeSeconds=this._userTimeSeconds);const e=30*(this._userTimeSeconds-this._lastTimeSeconds);this._lastTimeSeconds=this._userTimeSeconds;const i=e*(4/30)/4.5,s=this._faceTargetX-this._faceX,o=this._faceTargetY-this._faceY;if(r.abs(s)<=.01&&r.abs(o)<=.01)return;const n=r.sqrt(s*s+o*o),a=4/30*o/n;let l=4/30*s/n-this._faceVX,u=a-this._faceVY;const h=r.sqrt(l*l+u*u);(h<-i||h>i)&&(l*=i/h,u*=i/h),this._faceVX+=l,this._faceVY+=u;{const t=.5*(r.sqrt(i*i+16*i*n-8*i*n)-i),e=r.sqrt(this._faceVX*this._faceVX+this._faceVY*this._faceVY);e>t&&(this._faceVX*=t/e,this._faceVY*=t/e)}this._faceX+=this._faceVX,this._faceY+=this._faceVY}getX(){return this._faceX}getY(){return this._faceY}set(t,e){this._faceTargetX=t,this._faceTargetY=e}}}(s||(s={}))},"./src/Framework/math/cubismvector2.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){class e{constructor(t,e){this.x=t,this.y=e,this.x=null==t?0:t,this.y=null==e?0:e}add(t){const i=new e(0,0);return i.x=this.x+t.x,i.y=this.y+t.y,i}substract(t){const i=new e(0,0);return i.x=this.x-t.x,i.y=this.y-t.y,i}multiply(t){const i=new e(0,0);return i.x=this.x*t.x,i.y=this.y*t.y,i}multiplyByScaler(t){return this.multiply(new e(t,t))}division(t){const i=new e(0,0);return i.x=this.x/t.x,i.y=this.y/t.y,i}divisionByScalar(t){return this.division(new e(t,t))}getLength(){return Math.sqrt(this.x*this.x+this.y*this.y)}getDistanceWith(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))}dot(t){return this.x*t.x+this.y*t.y}normalize(){const t=Math.pow(this.x*this.x+this.y*this.y,.5);this.x=this.x/t,this.y=this.y/t}isEqual(t){return this.x==t.x&&this.y==t.y}isNotEqual(t){return!this.isEqual(t)}}t.CubismVector2=e}(s||(s={}))},"./src/Framework/math/cubismviewmatrix.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismmatrix44.ts").Live2DCubismFramework.CubismMatrix44;!function(t){t.CubismViewMatrix=class extends r{constructor(){super(),this._screenLeft=0,this._screenRight=0,this._screenTop=0,this._screenBottom=0,this._maxLeft=0,this._maxRight=0,this._maxTop=0,this._maxBottom=0,this._maxScale=0,this._minScale=0}adjustTranslate(t,e){this._tr[0]*this._maxLeft+(this._tr[12]+t)>this._screenLeft&&(t=this._screenLeft-this._tr[0]*this._maxLeft-this._tr[12]),this._tr[0]*this._maxRight+(this._tr[12]+t)<this._screenRight&&(t=this._screenRight-this._tr[0]*this._maxRight-this._tr[12]),this._tr[5]*this._maxTop+(this._tr[13]+e)<this._screenTop&&(e=this._screenTop-this._tr[5]*this._maxTop-this._tr[13]),this._tr[5]*this._maxBottom+(this._tr[13]+e)>this._screenBottom&&(e=this._screenBottom-this._tr[5]*this._maxBottom-this._tr[13]);const i=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]);r.multiply(i,this._tr,this._tr)}adjustScale(t,e,i){const s=this.getMaxScale(),o=this.getMinScale(),n=i*this._tr[0];n<o?this._tr[0]>0&&(i=o/this._tr[0]):n>s&&this._tr[0]>0&&(i=s/this._tr[0]);const a=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1]),l=new Float32Array([i,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1]),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,-t,-e,0,1]);r.multiply(u,this._tr,this._tr),r.multiply(l,this._tr,this._tr),r.multiply(a,this._tr,this._tr)}setScreenRect(t,e,i,s){this._screenLeft=t,this._screenRight=e,this._screenBottom=i,this._screenTop=s}setMaxScreenRect(t,e,i,s){this._maxLeft=t,this._maxRight=e,this._maxTop=s,this._maxBottom=i}setMaxScale(t){this._maxScale=t}setMinScale(t){this._minScale=t}getMaxScale(){return this._maxScale}getMinScale(){return this._minScale}isMaxScale(){return this.getScaleX()>=this._maxScale}isMinScale(){return this.getScaleX()<=this._minScale}getScreenLeft(){return this._screenLeft}getScreenRight(){return this._screenRight}getScreenBottom(){return this._screenBottom}getScreenTop(){return this._screenTop}getMaxLeft(){return this._maxLeft}getMaxRight(){return this._maxRight}getMaxBottom(){return this._maxBottom}getMaxTop(){return this._maxTop}}}(s||(s={}))},"./src/Framework/model/cubismmoc.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/model/cubismmodel.ts"),o=i("./src/Framework/utils/cubismdebug.ts"),n=r.Live2DCubismFramework.CubismModel;!function(t){class e{constructor(t){this._moc=t,this._modelCount=0}static create(t){let i=null;const s=Live2DCubismCore.Moc.fromArrayBuffer(t);return s&&(i=new e(s)),i}static delete(t){t._moc._release(),t._moc=null,t=null}createModel(){let t=null;const e=Live2DCubismCore.Model.fromMoc(this._moc);return e&&(t=new n(e),t.initialize(),++this._modelCount),t}deleteModel(t){null!=t&&(t.release(),t=null,--this._modelCount)}release(){Object(o.CSM_ASSERT)(0==this._modelCount),this._moc._release(),this._moc=null}}t.CubismMoc=e}(s||(s={}))},"./src/Framework/model/cubismmodel.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/rendering/cubismrenderer.ts"),o=i("./src/Framework/live2dcubismframework.ts"),n=i("./src/Framework/type/csmmap.ts"),a=i("./src/Framework/type/csmvector.ts"),l=i("./src/Framework/utils/cubismdebug.ts"),u=o.Live2DCubismFramework.CubismFramework,h=r.Live2DCubismFramework.CubismBlendMode,_=a.Live2DCubismFramework.csmVector,c=n.Live2DCubismFramework.csmMap;!function(t){t.CubismModel=class{constructor(t){this._model=t,this._parameterValues=null,this._parameterMaximumValues=null,this._parameterMinimumValues=null,this._partOpacities=null,this._savedParameters=new _,this._parameterIds=new _,this._drawableIds=new _,this._partIds=new _,this._notExistPartId=new c,this._notExistParameterId=new c,this._notExistParameterValues=new c,this._notExistPartOpacities=new c}update(){this._model.update(),this._model.drawables.resetDynamicFlags()}getCanvasWidth(){return null==this._model?0:this._model.canvasinfo.CanvasWidth/this._model.canvasinfo.PixelsPerUnit}getCanvasHeight(){return null==this._model?0:this._model.canvasinfo.CanvasHeight/this._model.canvasinfo.PixelsPerUnit}saveParameters(){const t=this._model.parameters.count,e=this._savedParameters.getSize();for(let i=0;i<t;++i)i<e?this._savedParameters.set(i,this._parameterValues[i]):this._savedParameters.pushBack(this._parameterValues[i])}getModel(){return this._model}getPartIndex(t){let e;const i=this._model.parts.count;for(e=0;e<i;++e)if(t==this._partIds.at(e))return e;return this._notExistPartId.isExist(t)?this._notExistPartId.getValue(t):(e=i+this._notExistPartId.getSize(),this._notExistPartId.setValue(t,e),this._notExistPartOpacities.appendKey(e),e)}getPartCount(){return this._model.parts.count}setPartOpacityByIndex(t,e){this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.setValue(t,e):(Object(l.CSM_ASSERT)(0<=t&&t<this.getPartCount()),this._partOpacities[t]=e)}setPartOpacityById(t,e){const i=this.getPartIndex(t);i<0||this.setPartOpacityByIndex(i,e)}getPartOpacityByIndex(t){return this._notExistPartOpacities.isExist(t)?this._notExistPartOpacities.getValue(t):(Object(l.CSM_ASSERT)(0<=t&&t<this.getPartCount()),this._partOpacities[t])}getPartOpacityById(t){const e=this.getPartIndex(t);return e<0?0:this.getPartOpacityByIndex(e)}getParameterIndex(t){let e;const i=this._model.parameters.count;for(e=0;e<i;++e)if(t==this._parameterIds.at(e))return e;return this._notExistParameterId.isExist(t)?this._notExistParameterId.getValue(t):(e=this._model.parameters.count+this._notExistParameterId.getSize(),this._notExistParameterId.setValue(t,e),this._notExistParameterValues.appendKey(e),e)}getParameterCount(){return this._model.parameters.count}getParameterMaximumValue(t){return this._model.parameters.maximumValues[t]}getParameterMinimumValue(t){return this._model.parameters.minimumValues[t]}getParameterDefaultValue(t){return this._model.parameters.defaultValues[t]}getParameterValueByIndex(t){return this._notExistParameterValues.isExist(t)?this._notExistParameterValues.getValue(t):(Object(l.CSM_ASSERT)(0<=t&&t<this.getParameterCount()),this._parameterValues[t])}getParameterValueById(t){const e=this.getParameterIndex(t);return this.getParameterValueByIndex(e)}setParameterValueByIndex(t,e,i=1){this._notExistParameterValues.isExist(t)?this._notExistParameterValues.setValue(t,1==i?e:this._notExistParameterValues.getValue(t)*(1-i)+e*i):(Object(l.CSM_ASSERT)(0<=t&&t<this.getParameterCount()),this._model.parameters.maximumValues[t]<e&&(e=this._model.parameters.maximumValues[t]),this._model.parameters.minimumValues[t]>e&&(e=this._model.parameters.minimumValues[t]),this._parameterValues[t]=1==i?e:this._parameterValues[t]=this._parameterValues[t]*(1-i)+e*i)}setParameterValueById(t,e,i=1){const s=this.getParameterIndex(t);this.setParameterValueByIndex(s,e,i)}addParameterValueByIndex(t,e,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)+e*i)}addParameterValueById(t,e,i=1){const s=this.getParameterIndex(t);this.addParameterValueByIndex(s,e,i)}multiplyParameterValueById(t,e,i=1){const s=this.getParameterIndex(t);this.multiplyParameterValueByIndex(s,e,i)}multiplyParameterValueByIndex(t,e,i=1){this.setParameterValueByIndex(t,this.getParameterValueByIndex(t)*(1+(e-1)*i))}getDrawableIndex(t){const e=this._model.drawables.count;for(let i=0;i<e;++i)if(this._drawableIds.at(i)==t)return i;return-1}getDrawableCount(){return this._model.drawables.count}getDrawableId(t){const e=this._model.drawables.ids;return u.getIdManager().getId(e[t])}getDrawableRenderOrders(){return this._model.drawables.renderOrders}getDrawableTextureIndices(t){return this._model.drawables.textureIndices[t]}getDrawableDynamicFlagVertexPositionsDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVertexPositionsDidChangeBit(e[t])}getDrawableVertexIndexCount(t){return this._model.drawables.indexCounts[t]}getDrawableVertexCount(t){return this._model.drawables.vertexCounts[t]}getDrawableVertices(t){return this.getDrawableVertexPositions(t)}getDrawableVertexIndices(t){return this._model.drawables.indices[t]}getDrawableVertexPositions(t){return this._model.drawables.vertexPositions[t]}getDrawableVertexUvs(t){return this._model.drawables.vertexUvs[t]}getDrawableOpacity(t){return this._model.drawables.opacities[t]}getDrawableCulling(t){const e=this._model.drawables.constantFlags;return!Live2DCubismCore.Utils.hasIsDoubleSidedBit(e[t])}getDrawableBlendMode(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasBlendAdditiveBit(e[t])?h.CubismBlendMode_Additive:Live2DCubismCore.Utils.hasBlendMultiplicativeBit(e[t])?h.CubismBlendMode_Multiplicative:h.CubismBlendMode_Normal}getDrawableInvertedMaskBit(t){const e=this._model.drawables.constantFlags;return Live2DCubismCore.Utils.hasIsInvertedMaskBit(e[t])}getDrawableMasks(){return this._model.drawables.masks}getDrawableMaskCounts(){return this._model.drawables.maskCounts}isUsingMasking(){for(let t=0;t<this._model.drawables.count;++t)if(!(this._model.drawables.maskCounts[t]<=0))return!0;return!1}getDrawableDynamicFlagIsVisible(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasIsVisibleBit(e[t])}getDrawableDynamicFlagVisibilityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasVisibilityDidChangeBit(e[t])}getDrawableDynamicFlagOpacityDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasOpacityDidChangeBit(e[t])}getDrawableDynamicFlagRenderOrderDidChange(t){const e=this._model.drawables.dynamicFlags;return Live2DCubismCore.Utils.hasRenderOrderDidChangeBit(e[t])}loadParameters(){let t=this._model.parameters.count;const e=this._savedParameters.getSize();t>e&&(t=e);for(let e=0;e<t;++e)this._parameterValues[e]=this._savedParameters.at(e)}initialize(){Object(l.CSM_ASSERT)(this._model),this._parameterValues=this._model.parameters.values,this._partOpacities=this._model.parts.opacities,this._parameterMaximumValues=this._model.parameters.maximumValues,this._parameterMinimumValues=this._model.parameters.minimumValues;{const t=this._model.parameters.ids,e=this._model.parameters.count;this._parameterIds.prepareCapacity(e);for(let i=0;i<e;++i)this._parameterIds.pushBack(u.getIdManager().getId(t[i]))}{const t=this._model.parts.ids,e=this._model.parts.count;this._partIds.prepareCapacity(e);for(let i=0;i<e;++i)this._partIds.pushBack(u.getIdManager().getId(t[i]))}{const t=this._model.drawables.ids,e=this._model.drawables.count;this._drawableIds.prepareCapacity(e);for(let i=0;i<e;++i)this._drawableIds.pushBack(u.getIdManager().getId(t[i]))}}release(){this._model.release(),this._model=null}}}(s||(s={}))},"./src/Framework/model/cubismmodeluserdata.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/model/cubismmodeluserdatajson.ts"),o=i("./src/Framework/type/csmstring.ts"),n=i("./src/Framework/type/csmvector.ts"),a=i("./src/Framework/live2dcubismframework.ts").Live2DCubismFramework.CubismFramework,l=n.Live2DCubismFramework.csmVector,u=o.Live2DCubismFramework.csmString,h=r.Live2DCubismFramework.CubismModelUserDataJson;!function(t){class e{}t.CubismModelUserDataNode=e;class i{constructor(){this._userDataNodes=new l,this._artMeshUserDataNode=new l}static create(t,e){const s=new i;return s.parseUserData(t,e),s}static delete(t){null!=t&&(t.release(),t=null)}getArtMeshUserDatas(){return this._artMeshUserDataNode}parseUserData(t,i){let s=new h(t,i);const r=a.getIdManager().getId("ArtMesh"),o=s.getUserDataCount();for(let t=0;t<o;t++){const i=new e;i.targetId=s.getUserDataId(t),i.targetType=a.getIdManager().getId(s.getUserDataTargetType(t)),i.value=new u(s.getUserDataValue(t)),this._userDataNodes.pushBack(i),i.targetType==r&&this._artMeshUserDataNode.pushBack(i)}s.release(),s=void 0}release(){for(let t=0;t<this._userDataNodes.getSize();++t)this._userDataNodes.set(t,null);this._userDataNodes=null}}t.CubismModelUserData=i}(s||(s={}))},"./src/Framework/model/cubismmodeluserdatajson.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/utils/cubismjson.ts"),o=i("./src/Framework/live2dcubismframework.ts").Live2DCubismFramework.CubismFramework,n=r.Live2DCubismFramework.CubismJson;!function(t){t.CubismModelUserDataJson=class{constructor(t,e){this._json=n.create(t,e)}release(){n.delete(this._json)}getUserDataCount(){return this._json.getRoot().getValueByString("Meta").getValueByString("UserDataCount").toInt()}getTotalUserDataSize(){return this._json.getRoot().getValueByString("Meta").getValueByString("TotalUserDataSize").toInt()}getUserDataTargetType(t){return this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Target").getRawString()}getUserDataId(t){return o.getIdManager().getId(this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Id").getRawString())}getUserDataValue(t){return this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Value").getRawString()}}}(s||(s={}))},"./src/Framework/model/cubismusermodel.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/live2dcubismframework.ts"),o=i("./src/Framework/motion/cubismmotionmanager.ts"),n=i("./src/Framework/math/cubismtargetpoint.ts"),a=i("./src/Framework/math/cubismmodelmatrix.ts"),l=i("./src/Framework/model/cubismmoc.ts"),u=i("./src/Framework/motion/cubismmotion.ts"),h=i("./src/Framework/motion/cubismexpressionmotion.ts"),_=i("./src/Framework/effect/cubismpose.ts"),c=i("./src/Framework/model/cubismmodeluserdata.ts"),d=i("./src/Framework/physics/cubismphysics.ts"),m=i("./src/Framework/effect/cubismbreath.ts"),p=i("./src/Framework/effect/cubismeyeblink.ts"),g=i("./src/Framework/rendering/cubismrenderer_webgl.ts"),f=i("./src/Framework/utils/cubismdebug.ts"),y=g.Live2DCubismFramework.CubismRenderer_WebGL,$=p.Live2DCubismFramework.CubismEyeBlink,S=m.Live2DCubismFramework.CubismBreath,v=r.Live2DCubismFramework.Constant,x=d.Live2DCubismFramework.CubismPhysics,b=c.Live2DCubismFramework.CubismModelUserData,P=_.Live2DCubismFramework.CubismPose,w=h.Live2DCubismFramework.CubismExpressionMotion,L=u.Live2DCubismFramework.CubismMotion,T=l.Live2DCubismFramework.CubismMoc,M=a.Live2DCubismFramework.CubismModelMatrix,C=n.Live2DCubismFramework.CubismTargetPoint,F=o.Live2DCubismFramework.CubismMotionManager;!function(t){class e{constructor(){this.loadMotion=(t,e,i,s)=>L.create(t,e,s),this._moc=null,this._model=null,this._motionManager=null,this._expressionManager=null,this._eyeBlink=null,this._breath=null,this._modelMatrix=null,this._pose=null,this._dragManager=null,this._physics=null,this._modelUserData=null,this._initialized=!1,this._updating=!1,this._opacity=1,this._lipsync=!0,this._lastLipSyncValue=0,this._dragX=0,this._dragY=0,this._accelerationX=0,this._accelerationY=0,this._accelerationZ=0,this._debugMode=!0,this._renderer=null,this._motionManager=new F,this._motionManager.setEventCallback(e.cubismDefaultMotionEventCallback,this),this._expressionManager=new F,this._dragManager=new C}isInitialized(){return this._initialized}setInitialized(t){this._initialized=t}isUpdating(){return this._updating}setUpdating(t){this._updating=t}setDragging(t,e){this._dragManager.set(t,e)}setAcceleration(t,e,i){this._accelerationX=t,this._accelerationY=e,this._accelerationZ=i}getModelMatrix(){return this._modelMatrix}setOpacity(t){this._opacity=t}getOpacity(){return this._opacity}loadModel(t){this._moc=T.create(t),this._model=this._moc.createModel(),this._model.saveParameters(),null!=this._moc&&null!=this._model?this._modelMatrix=new M(this._model.getCanvasWidth(),this._model.getCanvasHeight()):Object(f.CubismLogError)("Failed to CreateModel().")}loadExpression(t,e,i){return w.create(t,e)}loadPose(t,e){this._pose=P.create(t,e)}loadUserData(t,e){this._modelUserData=b.create(t,e)}loadPhysics(t,e){this._physics=x.create(t,e)}isHit(t,e,i){const s=this._model.getDrawableIndex(t);if(s<0)return!1;const r=this._model.getDrawableVertexCount(s),o=this._model.getDrawableVertices(s);let n=o[0],a=o[0],l=o[1],u=o[1];for(let t=1;t<r;++t){const e=o[v.vertexOffset+t*v.vertexStep],i=o[v.vertexOffset+t*v.vertexStep+1];e<n&&(n=e),e>a&&(a=e),i<l&&(l=i),i>u&&(u=i)}const h=this._modelMatrix.invertTransformX(e),_=this._modelMatrix.invertTransformY(i);return n<=h&&h<=a&&l<=_&&_<=u}getModel(){return this._model}getRenderer(){return this._renderer}createRenderer(){this._renderer&&this.deleteRenderer(),this._renderer=new y,this._renderer.initialize(this._model)}deleteRenderer(){null!=this._renderer&&(this._renderer.release(),this._renderer=null)}motionEventFired(t){Object(f.CubismLogInfo)("{0}",t.s)}static cubismDefaultMotionEventCallback(t,e,i){null!=i&&i.motionEventFired(e)}release(){null!=this._motionManager&&(this._motionManager.release(),this._motionManager=null),null!=this._expressionManager&&(this._expressionManager.release(),this._expressionManager=null),null!=this._moc&&(this._moc.deleteModel(this._model),this._moc.release(),this._moc=null),this._modelMatrix=null,P.delete(this._pose),$.delete(this._eyeBlink),S.delete(this._breath),this._dragManager=null,x.delete(this._physics),b.delete(this._modelUserData),this.deleteRenderer()}}t.CubismUserModel=e}(s||(s={}))},"./src/Framework/motion/acubismmotion.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismmath.ts"),o=i("./src/Framework/type/csmvector.ts"),n=i("./src/Framework/utils/cubismdebug.ts"),a=o.Live2DCubismFramework.csmVector,l=r.Live2DCubismFramework.CubismMath;!function(t){t.ACubismMotion=class{constructor(){this.setFinishedMotionHandler=t=>this._onFinishedMotion=t,this.getFinishedMotionHandler=()=>this._onFinishedMotion,this._fadeInSeconds=-1,this._fadeOutSeconds=-1,this._weight=1,this._offsetSeconds=0,this._firedEventValues=new a}static delete(t){t.release(),t=void 0,t=null}release(){this._weight=0}updateParameters(t,e,i){if(!e.isAvailable()||e.isFinished())return;if(!e.isStarted()){e.setIsStarted(!0),e.setStartTime(i-this._offsetSeconds),e.setFadeInStartTime(i);const t=this.getDuration();e.getEndTime()<0&&e.setEndTime(t<=0?-1:e.getStartTime()+t)}let s=this._weight;s=s*(0==this._fadeInSeconds?1:l.getEasingSine((i-e.getFadeInStartTime())/this._fadeInSeconds))*(0==this._fadeOutSeconds||e.getEndTime()<0?1:l.getEasingSine((e.getEndTime()-i)/this._fadeOutSeconds)),e.setState(i,s),Object(n.CSM_ASSERT)(0<=s&&s<=1),this.doUpdateParameters(t,i,s,e),e.getEndTime()>0&&e.getEndTime()<i&&e.setIsFinished(!0)}setFadeInTime(t){this._fadeInSeconds=t}setFadeOutTime(t){this._fadeOutSeconds=t}getFadeOutTime(){return this._fadeOutSeconds}getFadeInTime(){return this._fadeInSeconds}setWeight(t){this._weight=t}getWeight(){return this._weight}getDuration(){return-1}getLoopDuration(){return-1}setOffsetTime(t){this._offsetSeconds=t}getFiredEvent(t,e){return this._firedEventValues}}}(s||(s={}))},"./src/Framework/motion/cubismexpressionmotion.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/motion/acubismmotion.ts"),o=i("./src/Framework/utils/cubismjson.ts"),n=i("./src/Framework/live2dcubismframework.ts"),a=i("./src/Framework/type/csmvector.ts").Live2DCubismFramework.csmVector,l=n.Live2DCubismFramework.CubismFramework,u=o.Live2DCubismFramework.CubismJson,h=r.Live2DCubismFramework.ACubismMotion;!function(t){class e extends h{constructor(){super(),this._parameters=new a}static create(t,r){const o=new e,n=u.create(t,r),a=n.getRoot();o.setFadeInTime(a.getValueByString("FadeInTime").toFloat(1)),o.setFadeOutTime(a.getValueByString("FadeOutTime").toFloat(1));const h=a.getValueByString("Parameters").getSize();o._parameters.prepareCapacity(h);for(let t=0;t<h;++t){const e=a.getValueByString("Parameters").getValueByIndex(t),r=l.getIdManager().getId(e.getValueByString("Id").getRawString()),n=e.getValueByString("Value").toFloat();let u;u=e.getValueByString("Blend").isNull()||"Add"==e.getValueByString("Blend").getString()?i.ExpressionBlendType_Add:"Multiply"==e.getValueByString("Blend").getString()?i.ExpressionBlendType_Multiply:"Overwrite"==e.getValueByString("Blend").getString()?i.ExpressionBlendType_Overwrite:i.ExpressionBlendType_Add;const h=new s;h.parameterId=r,h.blendType=u,h.value=n,o._parameters.pushBack(h)}return u.delete(n),o}doUpdateParameters(t,e,s,r){for(let e=0;e<this._parameters.getSize();++e){const r=this._parameters.at(e);switch(r.blendType){case i.ExpressionBlendType_Add:t.addParameterValueById(r.parameterId,r.value,s);break;case i.ExpressionBlendType_Multiply:t.multiplyParameterValueById(r.parameterId,r.value,s);break;case i.ExpressionBlendType_Overwrite:t.setParameterValueById(r.parameterId,r.value,s)}}}}let i;t.CubismExpressionMotion=e,function(t){t[t.ExpressionBlendType_Add=0]="ExpressionBlendType_Add",t[t.ExpressionBlendType_Multiply=1]="ExpressionBlendType_Multiply",t[t.ExpressionBlendType_Overwrite=2]="ExpressionBlendType_Overwrite"}(i=t.ExpressionBlendType||(t.ExpressionBlendType={}));class s{}t.ExpressionParameter=s}(s||(s={}))},"./src/Framework/motion/cubismmotion.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/motion/cubismmotionjson.ts"),o=i("./src/Framework/motion/cubismmotioninternal.ts"),n=i("./src/Framework/motion/acubismmotion.ts"),a=i("./src/Framework/live2dcubismframework.ts"),l=i("./src/Framework/math/cubismmath.ts"),u=i("./src/Framework/type/csmstring.ts"),h=i("./src/Framework/utils/cubismdebug.ts"),_=u.Live2DCubismFramework.csmString,c=o.Live2DCubismFramework.CubismMotionData,d=o.Live2DCubismFramework.CubismMotionSegment,m=o.Live2DCubismFramework.CubismMotionPoint,p=o.Live2DCubismFramework.CubismMotionEvent,g=o.Live2DCubismFramework.CubismMotionSegmentType,f=o.Live2DCubismFramework.CubismMotionCurve,y=o.Live2DCubismFramework.CubismMotionCurveTarget,$=l.Live2DCubismFramework.CubismMath,S=a.Live2DCubismFramework.CubismFramework,v=n.Live2DCubismFramework.ACubismMotion,x=r.Live2DCubismFramework.CubismMotionJson;!function(t){function e(t,e,i){const s=new m;return s.time=t.time+(e.time-t.time)*i,s.value=t.value+(e.value-t.value)*i,s}function i(t,e){let i=(e-t[0].time)/(t[1].time-t[0].time);return i<0&&(i=0),t[0].value+(t[1].value-t[0].value)*i}function s(t,i){let s=(i-t[0].time)/(t[3].time-t[0].time);s<0&&(s=0);const r=e(t[0],t[1],s),o=e(t[1],t[2],s),n=e(t[2],t[3],s),a=e(r,o,s),l=e(o,n,s);return e(a,l,s).value}function r(t,e){return t[0].value}function o(t,e){return t[1].value}function n(t,e,i){const s=t.curves.at(e);let r=-1;const o=s.baseSegmentIndex+s.segmentCount;let n=0;for(let e=s.baseSegmentIndex;e<o;++e)if(n=t.segments.at(e).basePointIndex+(t.segments.at(e).segmentType==g.CubismMotionSegmentType_Bezier?3:1),t.points.at(n).time>i){r=e;break}if(-1==r)return t.points.at(n).value;const a=t.segments.at(r);return a.evaluate(t.points.get(a.basePointIndex),i)}class a extends v{constructor(){super(),this._sourceFrameRate=30,this._loopDurationSeconds=-1,this._isLoop=!1,this._isLoopFadeIn=!0,this._lastWeight=0,this._motionData=null,this._modelCurveIdEyeBlink=null,this._modelCurveIdLipSync=null,this._eyeBlinkParameterIds=null,this._lipSyncParameterIds=null}static create(t,e,i){const s=new a;return s.parse(t,e),s._sourceFrameRate=s._motionData.fps,s._loopDurationSeconds=s._motionData.duration,s._onFinishedMotion=i,s}doUpdateParameters(t,e,i,s){null==this._modelCurveIdEyeBlink&&(this._modelCurveIdEyeBlink=S.getIdManager().getId("EyeBlink")),null==this._modelCurveIdLipSync&&(this._modelCurveIdLipSync=S.getIdManager().getId("LipSync"));let r=e-s.getStartTime();r<0&&(r=0);let o=Number.MAX_VALUE,a=Number.MAX_VALUE;let l=0,u=0;this._eyeBlinkParameterIds.getSize()>64&&Object(h.CubismLogDebug)("too many eye blink targets : {0}",this._eyeBlinkParameterIds.getSize()),this._lipSyncParameterIds.getSize()>64&&Object(h.CubismLogDebug)("too many lip sync targets : {0}",this._lipSyncParameterIds.getSize());const _=this._fadeInSeconds<=0?1:$.getEasingSine((e-s.getFadeInStartTime())/this._fadeInSeconds),c=this._fadeOutSeconds<=0||s.getEndTime()<0?1:$.getEasingSine((s.getEndTime()-e)/this._fadeOutSeconds);let d,m,p,g=r;if(this._isLoop)for(;g>this._motionData.duration;)g-=this._motionData.duration;const f=this._motionData.curves;for(m=0;m<this._motionData.curveCount&&f.at(m).type==y.CubismMotionCurveTarget_Model;++m)d=n(this._motionData,m,g),f.at(m).id==this._modelCurveIdEyeBlink?a=d:f.at(m).id==this._modelCurveIdLipSync&&(o=d);for(;m<this._motionData.curveCount&&f.at(m).type==y.CubismMotionCurveTarget_Parameter;++m){if(p=t.getParameterIndex(f.at(m).id),-1==p)continue;const r=t.getParameterValueByIndex(p);if(d=n(this._motionData,m,g),a!=Number.MAX_VALUE)for(let t=0;t<this._eyeBlinkParameterIds.getSize()&&t<64;++t)if(this._eyeBlinkParameterIds.at(t)==f.at(m).id){d*=a,u|=1<<t;break}if(o!=Number.MAX_VALUE)for(let t=0;t<this._lipSyncParameterIds.getSize()&&t<64;++t)if(this._lipSyncParameterIds.at(t)==f.at(m).id){d+=o,l|=1<<t;break}let h;if(f.at(m).fadeInTime<0&&f.at(m).fadeOutTime<0)h=r+(d-r)*i;else{let t,i;t=f.at(m).fadeInTime<0?_:0==f.at(m).fadeInTime?1:$.getEasingSine((e-s.getFadeInStartTime())/f.at(m).fadeInTime),i=f.at(m).fadeOutTime<0?c:0==f.at(m).fadeOutTime||s.getEndTime()<0?1:$.getEasingSine((s.getEndTime()-e)/f.at(m).fadeOutTime);h=r+(d-r)*(this._weight*t*i)}t.setParameterValueByIndex(p,h,1)}if(a!=Number.MAX_VALUE)for(let e=0;e<this._eyeBlinkParameterIds.getSize()&&e<64;++e){const s=t.getParameterValueById(this._eyeBlinkParameterIds.at(e));if(u>>e&1)continue;const r=s+(a-s)*i;t.setParameterValueById(this._eyeBlinkParameterIds.at(e),r)}if(o!=Number.MAX_VALUE)for(let e=0;e<this._lipSyncParameterIds.getSize()&&e<64;++e){const s=t.getParameterValueById(this._lipSyncParameterIds.at(e));if(l>>e&1)continue;const r=s+(o-s)*i;t.setParameterValueById(this._lipSyncParameterIds.at(e),r)}for(;m<this._motionData.curveCount&&f.at(m).type==y.CubismMotionCurveTarget_PartOpacity;++m)p=t.getParameterIndex(f.at(m).id),-1!=p&&(d=n(this._motionData,m,g),t.setParameterValueByIndex(p,d));r>=this._motionData.duration&&(this._isLoop?(s.setStartTime(e),this._isLoopFadeIn&&s.setFadeInStartTime(e)):(this._onFinishedMotion&&this._onFinishedMotion(this),s.setIsFinished(!0))),this._lastWeight=i}setIsLoop(t){this._isLoop=t}isLoop(){return this._isLoop}setIsLoopFadeIn(t){this._isLoopFadeIn=t}isLoopFadeIn(){return this._isLoopFadeIn}getDuration(){return this._isLoop?-1:this._loopDurationSeconds}getLoopDuration(){return this._loopDurationSeconds}setParameterFadeInTime(t,e){const i=this._motionData.curves;for(let s=0;s<this._motionData.curveCount;++s)if(t==i.at(s).id)return void(i.at(s).fadeInTime=e)}setParameterFadeOutTime(t,e){const i=this._motionData.curves;for(let s=0;s<this._motionData.curveCount;++s)if(t==i.at(s).id)return void(i.at(s).fadeOutTime=e)}getParameterFadeInTime(t){const e=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==e.at(i).id)return e.at(i).fadeInTime;return-1}getParameterFadeOutTime(t){const e=this._motionData.curves;for(let i=0;i<this._motionData.curveCount;++i)if(t==e.at(i).id)return e.at(i).fadeOutTime;return-1}setEffectIds(t,e){this._eyeBlinkParameterIds=t,this._lipSyncParameterIds=e}release(){this._motionData=void 0,this._motionData=null}parse(t,e){this._motionData=new c;let n=new x(t,e);this._motionData.duration=n.getMotionDuration(),this._motionData.loop=n.isMotionLoop(),this._motionData.curveCount=n.getMotionCurveCount(),this._motionData.fps=n.getMotionFps(),this._motionData.eventCount=n.getEventCount(),n.isExistMotionFadeInTime()?this._fadeInSeconds=n.getMotionFadeInTime()<0?1:n.getMotionFadeInTime():this._fadeInSeconds=1,n.isExistMotionFadeOutTime()?this._fadeOutSeconds=n.getMotionFadeOutTime()<0?1:n.getMotionFadeOutTime():this._fadeOutSeconds=1,this._motionData.curves.updateSize(this._motionData.curveCount,f,!0),this._motionData.segments.updateSize(n.getMotionTotalSegmentCount(),d,!0),this._motionData.points.updateSize(n.getMotionTotalPointCount(),m,!0),this._motionData.events.updateSize(this._motionData.eventCount,p,!0);let a=0,l=0;for(let t=0;t<this._motionData.curveCount;++t){"Model"==n.getMotionCurveTarget(t)?this._motionData.curves.at(t).type=y.CubismMotionCurveTarget_Model:"Parameter"==n.getMotionCurveTarget(t)?this._motionData.curves.at(t).type=y.CubismMotionCurveTarget_Parameter:"PartOpacity"==n.getMotionCurveTarget(t)&&(this._motionData.curves.at(t).type=y.CubismMotionCurveTarget_PartOpacity),this._motionData.curves.at(t).id=n.getMotionCurveId(t),this._motionData.curves.at(t).baseSegmentIndex=l,this._motionData.curves.at(t).fadeInTime=n.isExistMotionCurveFadeInTime(t)?n.getMotionCurveFadeInTime(t):-1,this._motionData.curves.at(t).fadeOutTime=n.isExistMotionCurveFadeOutTime(t)?n.getMotionCurveFadeOutTime(t):-1;for(let e=0;e<n.getMotionCurveSegmentCount(t);){if(0==e){if(null==this._motionData.segments.at(l))break;if(this._motionData.segments.at(l).basePointIndex=a,null==this._motionData.points.at(a))break;this._motionData.points.at(a).time=n.getMotionCurveSegment(t,e),this._motionData.points.at(a).value=n.getMotionCurveSegment(t,e+1),a+=1,e+=2}else{if(null==this._motionData.segments.at(l))break;this._motionData.segments.at(l).basePointIndex=a-1}switch(n.getMotionCurveSegment(t,e)){case g.CubismMotionSegmentType_Linear:if(this._motionData.segments.at(l).segmentType=g.CubismMotionSegmentType_Linear,this._motionData.segments.at(l).evaluate=i,null==this._motionData.points.at(a))break;this._motionData.points.at(a).time=n.getMotionCurveSegment(t,e+1),this._motionData.points.at(a).value=n.getMotionCurveSegment(t,e+2),a+=1,e+=3;break;case g.CubismMotionSegmentType_Bezier:if(this._motionData.segments.at(l).segmentType=g.CubismMotionSegmentType_Bezier,this._motionData.segments.at(l).evaluate=s,null==this._motionData.points.at(a))break;this._motionData.points.at(a).time=n.getMotionCurveSegment(t,e+1),this._motionData.points.at(a).value=n.getMotionCurveSegment(t,e+2),this._motionData.points.at(a+1).time=n.getMotionCurveSegment(t,e+3),this._motionData.points.at(a+1).value=n.getMotionCurveSegment(t,e+4),this._motionData.points.at(a+2).time=n.getMotionCurveSegment(t,e+5),this._motionData.points.at(a+2).value=n.getMotionCurveSegment(t,e+6),a+=3,e+=7;break;case g.CubismMotionSegmentType_Stepped:if(this._motionData.segments.at(l).segmentType=g.CubismMotionSegmentType_Stepped,this._motionData.segments.at(l).evaluate=r,null==this._motionData.points.at(a))break;this._motionData.points.at(a).time=n.getMotionCurveSegment(t,e+1),this._motionData.points.at(a).value=n.getMotionCurveSegment(t,e+2),a+=1,e+=3;break;case g.CubismMotionSegmentType_InverseStepped:this._motionData.segments.at(l).segmentType=g.CubismMotionSegmentType_InverseStepped,this._motionData.segments.at(l).evaluate=o,this._motionData.points.at(a).time=n.getMotionCurveSegment(t,e+1),this._motionData.points.at(a).value=n.getMotionCurveSegment(t,e+2),a+=1,e+=3;break;default:Object(h.CSM_ASSERT)(0)}++this._motionData.curves.at(t).segmentCount,++l}}for(let t=0;t<n.getEventCount();++t)this._motionData.events.at(t).fireTime=n.getEventTime(t),this._motionData.events.at(t).value=n.getEventValue(t);n.release(),n=void 0,n=null}getFiredEvent(t,e){this._firedEventValues.updateSize(0);for(let i=0;i<this._motionData.eventCount;++i)this._motionData.events.at(i).fireTime>t&&this._motionData.events.at(i).fireTime<=e&&this._firedEventValues.pushBack(new _(this._motionData.events.at(i).value.s));return this._firedEventValues}}t.CubismMotion=a}(s||(s={}))},"./src/Framework/motion/cubismmotioninternal.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/type/csmvector.ts").Live2DCubismFramework.csmVector;!function(t){let e,i;!function(t){t[t.CubismMotionCurveTarget_Model=0]="CubismMotionCurveTarget_Model",t[t.CubismMotionCurveTarget_Parameter=1]="CubismMotionCurveTarget_Parameter",t[t.CubismMotionCurveTarget_PartOpacity=2]="CubismMotionCurveTarget_PartOpacity"}(e=t.CubismMotionCurveTarget||(t.CubismMotionCurveTarget={})),function(t){t[t.CubismMotionSegmentType_Linear=0]="CubismMotionSegmentType_Linear",t[t.CubismMotionSegmentType_Bezier=1]="CubismMotionSegmentType_Bezier",t[t.CubismMotionSegmentType_Stepped=2]="CubismMotionSegmentType_Stepped",t[t.CubismMotionSegmentType_InverseStepped=3]="CubismMotionSegmentType_InverseStepped"}(i=t.CubismMotionSegmentType||(t.CubismMotionSegmentType={}));t.CubismMotionPoint=class{constructor(){this.time=0,this.value=0}};t.CubismMotionSegment=class{constructor(){this.evaluate=null,this.basePointIndex=0,this.segmentType=0}};t.CubismMotionCurve=class{constructor(){this.type=e.CubismMotionCurveTarget_Model,this.segmentCount=0,this.baseSegmentIndex=0,this.fadeInTime=0,this.fadeOutTime=0}};t.CubismMotionEvent=class{constructor(){this.fireTime=0}};t.CubismMotionData=class{constructor(){this.duration=0,this.loop=!1,this.curveCount=0,this.eventCount=0,this.fps=0,this.curves=new r,this.segments=new r,this.points=new r,this.events=new r}}}(s||(s={}))},"./src/Framework/motion/cubismmotionjson.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/utils/cubismjson.ts"),o=i("./src/Framework/live2dcubismframework.ts"),n=i("./src/Framework/type/csmstring.ts").Live2DCubismFramework.csmString,a=o.Live2DCubismFramework.CubismFramework,l=r.Live2DCubismFramework.CubismJson;!function(t){const e="Meta";t.CubismMotionJson=class{constructor(t,e){this._json=l.create(t,e)}release(){l.delete(this._json)}getMotionDuration(){return this._json.getRoot().getValueByString(e).getValueByString("Duration").toFloat()}isMotionLoop(){return this._json.getRoot().getValueByString(e).getValueByString("Loop").toBoolean()}getMotionCurveCount(){return this._json.getRoot().getValueByString(e).getValueByString("CurveCount").toInt()}getMotionFps(){return this._json.getRoot().getValueByString(e).getValueByString("Fps").toFloat()}getMotionTotalSegmentCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalSegmentCount").toInt()}getMotionTotalPointCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalPointCount").toInt()}isExistMotionFadeInTime(){return!this._json.getRoot().getValueByString(e).getValueByString("FadeInTime").isNull()}isExistMotionFadeOutTime(){return!this._json.getRoot().getValueByString(e).getValueByString("FadeOutTime").isNull()}getMotionFadeInTime(){return this._json.getRoot().getValueByString(e).getValueByString("FadeInTime").toFloat()}getMotionFadeOutTime(){return this._json.getRoot().getValueByString(e).getValueByString("FadeOutTime").toFloat()}getMotionCurveTarget(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Target").getRawString()}getMotionCurveId(t){return a.getIdManager().getId(this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Id").getRawString())}isExistMotionCurveFadeInTime(t){return!this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeInTime").isNull()}isExistMotionCurveFadeOutTime(t){return!this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeOutTime").isNull()}getMotionCurveFadeInTime(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeInTime").toFloat()}getMotionCurveFadeOutTime(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("FadeOutTime").toFloat()}getMotionCurveSegmentCount(t){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Segments").getVector().getSize()}getMotionCurveSegment(t,e){return this._json.getRoot().getValueByString("Curves").getValueByIndex(t).getValueByString("Segments").getValueByIndex(e).toFloat()}getEventCount(){return this._json.getRoot().getValueByString(e).getValueByString("UserDataCount").toInt()}getTotalEventValueSize(){return this._json.getRoot().getValueByString(e).getValueByString("TotalUserDataSize").toInt()}getEventTime(t){return this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Time").toInt()}getEventValue(t){return new n(this._json.getRoot().getValueByString("UserData").getValueByIndex(t).getValueByString("Value").getRawString())}}}(s||(s={}))},"./src/Framework/motion/cubismmotionmanager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/motion/cubismmotionqueuemanager.ts").Live2DCubismFramework.CubismMotionQueueManager;!function(t){t.CubismMotionManager=class extends r{constructor(){super(),this._currentPriority=0,this._reservePriority=0}getCurrentPriority(){return this._currentPriority}getReservePriority(){return this._reservePriority}setReservePriority(t){this._reservePriority=t}startMotionPriority(t,e,i){return i==this._reservePriority&&(this._reservePriority=0),this._currentPriority=i,super.startMotion(t,e,this._userTimeSeconds)}updateMotion(t,e){this._userTimeSeconds+=e;const i=super.doUpdateMotion(t,this._userTimeSeconds);return this.isFinished()&&(this._currentPriority=0),i}reserveMotion(t){return!(t<=this._reservePriority||t<=this._currentPriority)&&(this._reservePriority=t,!0)}}}(s||(s={}))},"./src/Framework/motion/cubismmotionqueueentry.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/motion/acubismmotion.ts").Live2DCubismFramework.ACubismMotion;!function(t){t.CubismMotionQueueEntry=class{constructor(){this._autoDelete=!1,this._motion=null,this._available=!0,this._finished=!1,this._started=!1,this._startTimeSeconds=-1,this._fadeInStartTimeSeconds=0,this._endTimeSeconds=-1,this._stateTimeSeconds=0,this._stateWeight=0,this._lastEventCheckSeconds=0,this._motionQueueEntryHandle=this,this._fadeOutSeconds=0,this._isTriggeredFadeOut=!1}release(){this._autoDelete&&this._motion&&r.delete(this._motion)}setFadeOut(t){this._fadeOutSeconds=t,this._isTriggeredFadeOut=!0}startFadeOut(t,e){const i=e+t;this._isTriggeredFadeOut=!0,(this._endTimeSeconds<0||i<this._endTimeSeconds)&&(this._endTimeSeconds=i)}isFinished(){return this._finished}isStarted(){return this._started}getStartTime(){return this._startTimeSeconds}getFadeInStartTime(){return this._fadeInStartTimeSeconds}getEndTime(){return this._endTimeSeconds}setStartTime(t){this._startTimeSeconds=t}setFadeInStartTime(t){this._fadeInStartTimeSeconds=t}setEndTime(t){this._endTimeSeconds=t}setIsFinished(t){this._finished=t}setIsStarted(t){this._started=t}isAvailable(){return this._available}setIsAvailable(t){this._available=t}setState(t,e){this._stateTimeSeconds=t,this._stateWeight=e}getStateTime(){return this._stateTimeSeconds}getStateWeight(){return this._stateWeight}getLastCheckEventSeconds(){return this._lastEventCheckSeconds}setLastCheckEventSeconds(t){this._lastEventCheckSeconds=t}isTriggeredFadeOut(){return this._isTriggeredFadeOut&&this._endTimeSeconds<0}getFadeOutSeconds(){return this._fadeOutSeconds}}}(s||(s={}))},"./src/Framework/motion/cubismmotionqueuemanager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/motion/cubismmotionqueueentry.ts"),o=i("./src/Framework/type/csmvector.ts").Live2DCubismFramework.csmVector,n=r.Live2DCubismFramework.CubismMotionQueueEntry;!function(t){t.CubismMotionQueueManager=class{constructor(){this._userTimeSeconds=0,this._eventCallBack=null,this._eventCustomData=null,this._motions=new o}release(){for(let t=0;t<this._motions.getSize();++t)this._motions.at(t)&&(this._motions.at(t).release(),this._motions.set(t,void 0),this._motions.set(t,null));this._motions=null}startMotion(e,i,s){if(null==e)return t.InvalidMotionQueueEntryHandleValue;let r=null;for(let t=0;t<this._motions.getSize();++t)r=this._motions.at(t),null!=r&&r.setFadeOut(r._motion.getFadeOutTime());return r=new n,r._autoDelete=i,r._motion=e,this._motions.pushBack(r),r._motionQueueEntryHandle}isFinished(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let e=t.ptr();if(null==e){t=this._motions.erase(t);continue}if(null!=e._motion){if(!e.isFinished())return!1;t.preIncrement()}else e.release(),e=void 0,e=null,t=this._motions.erase(t)}return!0}isFinishedByHandle(t){for(let e=this._motions.begin();e.notEqual(this._motions.end());e.increment()){const i=e.ptr();if(null!=i&&(i._motionQueueEntryHandle==t&&!i.isFinished()))return!1}return!0}stopAllMotions(){for(let t=this._motions.begin();t.notEqual(this._motions.end());){let e=t.ptr();null!=e?(e.release(),e=void 0,e=null,t=this._motions.erase(t)):t=this._motions.erase(t)}}getCubismMotionQueueEntry(t){for(let e=this._motions.begin();e.notEqual(this._motions.end());e.preIncrement()){const i=e.ptr();if(null!=i&&i._motionQueueEntryHandle==t)return i}return null}setEventCallback(t,e=null){this._eventCallBack=t,this._eventCustomData=e}doUpdateMotion(t,e){let i=!1;for(let s=this._motions.begin();s.notEqual(this._motions.end());){let r=s.ptr();if(null==r){s=this._motions.erase(s);continue}const o=r._motion;if(null==o){r.release(),r=void 0,r=null,s=this._motions.erase(s);continue}o.updateParameters(t,r,e),i=!0;const n=o.getFiredEvent(r.getLastCheckEventSeconds()-r.getStartTime(),e-r.getStartTime());for(let t=0;t<n.getSize();++t)this._eventCallBack(this,n.at(t),this._eventCustomData);r.setLastCheckEventSeconds(e),r.isFinished()?(r.release(),r=void 0,r=null,s=this._motions.erase(s)):(r.isTriggeredFadeOut()&&r.startFadeOut(r.getFadeOutSeconds(),e),s.preIncrement())}return i}},t.InvalidMotionQueueEntryHandleValue=-1}(s||(s={}))},"./src/Framework/physics/cubismphysics.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/physics/cubismphysicsinternal.ts"),o=i("./src/Framework/math/cubismvector2.ts"),n=i("./src/Framework/math/cubismmath.ts"),a=i("./src/Framework/physics/cubismphysicsjson.ts").Live2DCubismFramework.CubismPhysicsJson,l=n.Live2DCubismFramework.CubismMath,u=r.Live2DCubismFramework.CubismPhysicsRig,h=r.Live2DCubismFramework.CubismPhysicsSubRig,_=r.Live2DCubismFramework.CubismPhysicsInput,c=r.Live2DCubismFramework.CubismPhysicsOutput,d=r.Live2DCubismFramework.CubismPhysicsParticle,m=r.Live2DCubismFramework.CubismPhysicsSource,p=r.Live2DCubismFramework.CubismPhysicsTargetType,g=o.Live2DCubismFramework.CubismVector2;!function(t){class e{constructor(){this._physicsRig=null,this._options=new i,this._options.gravity.y=-1,this._options.gravity.x=0,this._options.wind.x=0,this._options.wind.y=0}static create(t,i){const s=new e;return s.parse(t,i),s._physicsRig.gravity.y=0,s}static delete(t){null!=t&&(t.release(),t=null)}evaluate(t,e){let i,s,r,o;const n=new g;let a,u,h,_,c,d,m,p;c=t.getModel().parameters.values,d=t.getModel().parameters.maximumValues,m=t.getModel().parameters.minimumValues,p=t.getModel().parameters.defaultValues;for(let f=0;f<this._physicsRig.subRigCount;++f){i={angle:0},n.x=0,n.y=0,a=this._physicsRig.settings.at(f),u=this._physicsRig.inputs.get(a.baseInputIndex),h=this._physicsRig.outputs.get(a.baseOutputIndex),_=this._physicsRig.particles.get(a.baseParticleIndex);for(let e=0;e<a.inputCount;++e)s=u[e].weight/100,-1==u[e].sourceParameterIndex&&(u[e].sourceParameterIndex=t.getParameterIndex(u[e].source.id)),u[e].getNormalizedParameterValue(n,i,c[u[e].sourceParameterIndex],m[u[e].sourceParameterIndex],d[u[e].sourceParameterIndex],p[u[e].sourceParameterIndex],a.normalizationPosition,a.normalizationAngle,u[0].reflect,s);r=l.degreesToRadian(-i.angle),n.x=n.x*l.cos(r)-n.y*l.sin(r),n.y=n.x*l.sin(r)+n.y*l.cos(r),b(_,a.particleCount,n,i.angle,this._options.wind,.001*a.normalizationPosition.maximum,e,5);for(let e=0;e<a.outputCount;++e){const i=h[e].vertexIndex;if(i<1||i>=a.particleCount)break;-1==h[e].destinationParameterIndex&&(h[e].destinationParameterIndex=t.getParameterIndex(h[e].destination.id));const s=new g;s.x=_[i].position.x-_[i-1].position.x,s.y=_[i].position.y-_[i-1].position.y,o=h[e].getValue(s,_,i,h[e].reflect,this._options.gravity);const r=h[e].destinationParameterIndex,n=!Float32Array.prototype.slice&&"subarray"in Float32Array.prototype?JSON.parse(JSON.stringify(c.subarray(r))):c.slice(r);P(n,m[r],d[r],o,h[e]);for(let t=r,e=0;t<c.length;t++,e++)c[t]=n[e]}}}setOptions(t){this._options=t}getOption(){return this._options}release(){this._physicsRig=void 0,this._physicsRig=null}parse(t,e){this._physicsRig=new u;let i=new a(t,e);this._physicsRig.gravity=i.getGravity(),this._physicsRig.wind=i.getWind(),this._physicsRig.subRigCount=i.getSubRigCount(),this._physicsRig.settings.updateSize(this._physicsRig.subRigCount,h,!0),this._physicsRig.inputs.updateSize(i.getTotalInputCount(),_,!0),this._physicsRig.outputs.updateSize(i.getTotalOutputCount(),c,!0),this._physicsRig.particles.updateSize(i.getVertexCount(),d,!0);let l=0,g=0,$=0;for(let t=0;t<this._physicsRig.settings.getSize();++t){this._physicsRig.settings.at(t).normalizationPosition.minimum=i.getNormalizationPositionMinimumValue(t),this._physicsRig.settings.at(t).normalizationPosition.maximum=i.getNormalizationPositionMaximumValue(t),this._physicsRig.settings.at(t).normalizationPosition.defalut=i.getNormalizationPositionDefaultValue(t),this._physicsRig.settings.at(t).normalizationAngle.minimum=i.getNormalizationAngleMinimumValue(t),this._physicsRig.settings.at(t).normalizationAngle.maximum=i.getNormalizationAngleMaximumValue(t),this._physicsRig.settings.at(t).normalizationAngle.defalut=i.getNormalizationAngleDefaultValue(t),this._physicsRig.settings.at(t).inputCount=i.getInputCount(t),this._physicsRig.settings.at(t).baseInputIndex=l;for(let e=0;e<this._physicsRig.settings.at(t).inputCount;++e)this._physicsRig.inputs.at(l+e).sourceParameterIndex=-1,this._physicsRig.inputs.at(l+e).weight=i.getInputWeight(t,e),this._physicsRig.inputs.at(l+e).reflect=i.getInputReflect(t,e),"X"==i.getInputType(t,e)?(this._physicsRig.inputs.at(l+e).type=m.CubismPhysicsSource_X,this._physicsRig.inputs.at(l+e).getNormalizedParameterValue=s):"Y"==i.getInputType(t,e)?(this._physicsRig.inputs.at(l+e).type=m.CubismPhysicsSource_Y,this._physicsRig.inputs.at(l+e).getNormalizedParameterValue=r):"Angle"==i.getInputType(t,e)&&(this._physicsRig.inputs.at(l+e).type=m.CubismPhysicsSource_Angle,this._physicsRig.inputs.at(l+e).getNormalizedParameterValue=o),this._physicsRig.inputs.at(l+e).source.targetType=p.CubismPhysicsTargetType_Parameter,this._physicsRig.inputs.at(l+e).source.id=i.getInputSourceId(t,e);l+=this._physicsRig.settings.at(t).inputCount,this._physicsRig.settings.at(t).outputCount=i.getOutputCount(t),this._physicsRig.settings.at(t).baseOutputIndex=g;for(let e=0;e<this._physicsRig.settings.at(t).outputCount;++e)this._physicsRig.outputs.at(g+e).destinationParameterIndex=-1,this._physicsRig.outputs.at(g+e).vertexIndex=i.getOutputVertexIndex(t,e),this._physicsRig.outputs.at(g+e).angleScale=i.getOutputAngleScale(t,e),this._physicsRig.outputs.at(g+e).weight=i.getOutputWeight(t,e),this._physicsRig.outputs.at(g+e).destination.targetType=p.CubismPhysicsTargetType_Parameter,this._physicsRig.outputs.at(g+e).destination.id=i.getOutputDestinationId(t,e),"X"==i.getOutputType(t,e)?(this._physicsRig.outputs.at(g+e).type=m.CubismPhysicsSource_X,this._physicsRig.outputs.at(g+e).getValue=n,this._physicsRig.outputs.at(g+e).getScale=S):"Y"==i.getOutputType(t,e)?(this._physicsRig.outputs.at(g+e).type=m.CubismPhysicsSource_Y,this._physicsRig.outputs.at(g+e).getValue=f,this._physicsRig.outputs.at(g+e).getScale=v):"Angle"==i.getOutputType(t,e)&&(this._physicsRig.outputs.at(g+e).type=m.CubismPhysicsSource_Angle,this._physicsRig.outputs.at(g+e).getValue=y,this._physicsRig.outputs.at(g+e).getScale=x),this._physicsRig.outputs.at(g+e).reflect=i.getOutputReflect(t,e);g+=this._physicsRig.settings.at(t).outputCount,this._physicsRig.settings.at(t).particleCount=i.getParticleCount(t),this._physicsRig.settings.at(t).baseParticleIndex=$;for(let e=0;e<this._physicsRig.settings.at(t).particleCount;++e)this._physicsRig.particles.at($+e).mobility=i.getParticleMobility(t,e),this._physicsRig.particles.at($+e).delay=i.getParticleDelay(t,e),this._physicsRig.particles.at($+e).acceleration=i.getParticleAcceleration(t,e),this._physicsRig.particles.at($+e).radius=i.getParticleRadius(t,e),this._physicsRig.particles.at($+e).position=i.getParticlePosition(t,e);$+=this._physicsRig.settings.at(t).particleCount}this.initialize(),i.release(),i=void 0,i=null}initialize(){let t,e,i;for(let s=0;s<this._physicsRig.subRigCount;++s){e=this._physicsRig.settings.at(s),t=this._physicsRig.particles.get(e.baseParticleIndex),t[0].initialPosition=new g(0,0),t[0].lastPosition=new g(t[0].initialPosition.x,t[0].initialPosition.y),t[0].lastGravity=new g(0,-1),t[0].lastGravity.y*=-1,t[0].velocity=new g(0,0),t[0].force=new g(0,0);for(let s=1;s<e.particleCount;++s)i=new g(0,0),i.y=t[s].radius,t[s].initialPosition=new g(t[s-1].initialPosition.x+i.x,t[s-1].initialPosition.y+i.y),t[s].position=new g(t[s].initialPosition.x,t[s].initialPosition.y),t[s].lastPosition=new g(t[s].initialPosition.x,t[s].initialPosition.y),t[s].lastGravity=new g(0,-1),t[s].lastGravity.y*=-1,t[s].velocity=new g(0,0),t[s].force=new g(0,0)}}}t.CubismPhysics=e;class i{constructor(){this.gravity=new g(0,0),this.wind=new g(0,0)}}function s(t,e,i,s,r,o,n,a,l,u){t.x+=w(i,s,r,o,n.minimum,n.maximum,n.defalut,l)*u}function r(t,e,i,s,r,o,n,a,l,u){t.y+=w(i,s,r,o,n.minimum,n.maximum,n.defalut,l)*u}function o(t,e,i,s,r,o,n,a,l,u){e.angle+=w(i,s,r,o,a.minimum,a.maximum,a.defalut,l)*u}function n(t,e,i,s,r){let o=t.x;return s&&(o*=-1),o}function f(t,e,i,s,r){let o=t.y;return s&&(o*=-1),o}function y(t,e,i,s,r){let o;return r=i>=2?e[i-1].position.substract(e[i-2].position):r.multiplyByScaler(-1),o=l.directionToRadian(r,t),s&&(o*=-1),o}function $(t,e){return l.min(t,e)+function(t,e){const i=l.max(t,e),s=l.min(t,e);return l.abs(i-s)}(t,e)/2}function S(t,e){return JSON.parse(JSON.stringify(t.x))}function v(t,e){return JSON.parse(JSON.stringify(t.y))}function x(t,e){return JSON.parse(JSON.stringify(e))}function b(t,e,i,s,r,o,n,a){let u,h,_,c,d=new g(0,0),m=new g(0,0),p=new g(0,0),f=new g(0,0);t[0].position=new g(i.x,i.y),u=l.degreesToRadian(s),c=l.radianToDirection(u),c.normalize();for(let i=1;i<e;++i)t[i].force=c.multiplyByScaler(t[i].acceleration).add(r),t[i].lastPosition=new g(t[i].position.x,t[i].position.y),h=t[i].delay*n*30,d=t[i].position.substract(t[i-1].position),_=l.directionToRadian(t[i].lastGravity,c)/a,d.x=l.cos(_)*d.x-d.y*l.sin(_),d.y=l.sin(_)*d.x+d.y*l.cos(_),t[i].position=t[i-1].position.add(d),m=t[i].velocity.multiplyByScaler(h),p=t[i].force.multiplyByScaler(h).multiplyByScaler(h),t[i].position=t[i].position.add(m).add(p),f=t[i].position.substract(t[i-1].position),f.normalize(),t[i].position=t[i-1].position.add(f.multiplyByScaler(t[i].radius)),l.abs(t[i].position.x)<o&&(t[i].position.x=0),0!=h&&(t[i].velocity=t[i].position.substract(t[i].lastPosition),t[i].velocity=t[i].velocity.divisionByScalar(h),t[i].velocity=t[i].velocity.multiplyByScaler(t[i].mobility)),t[i].force=new g(0,0),t[i].lastGravity=new g(c.x,c.y)}function P(t,e,i,s,r){let o,n,a;o=r.getScale(r.translationScale,r.angleScale),n=s*o,n<e?(n<r.valueBelowMinimum&&(r.valueBelowMinimum=n),n=e):n>i&&(n>r.valueExceededMaximum&&(r.valueExceededMaximum=n),n=i),a=r.weight/100,a>=1||(n=t[0]*(1-a)+n*a),t[0]=n}function w(t,e,i,s,r,o,n,a){let u=0;const h=l.max(i,e);h<t&&(t=h);const _=l.min(i,e);_>t&&(t=_);const c=l.min(r,o),d=l.max(r,o),m=n,p=$(_,h),g=t-p;switch(function(t){let e=0;return t>0?e=1:t<0&&(e=-1),e}(g)){case 1:{const t=d-m,e=h-p;0!=e&&(u=g*(t/e),u+=m);break}case-1:{const t=c-m,e=_-p;0!=e&&(u=g*(t/e),u+=m);break}case 0:u=m}return a?u:-1*u}t.Options=i}(s||(s={}))},"./src/Framework/physics/cubismphysicsinternal.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismvector2.ts"),o=i("./src/Framework/type/csmvector.ts").Live2DCubismFramework.csmVector,n=r.Live2DCubismFramework.CubismVector2;!function(t){let e,i;!function(t){t[t.CubismPhysicsTargetType_Parameter=0]="CubismPhysicsTargetType_Parameter"}(e=t.CubismPhysicsTargetType||(t.CubismPhysicsTargetType={})),function(t){t[t.CubismPhysicsSource_X=0]="CubismPhysicsSource_X",t[t.CubismPhysicsSource_Y=1]="CubismPhysicsSource_Y",t[t.CubismPhysicsSource_Angle=2]="CubismPhysicsSource_Angle"}(i=t.CubismPhysicsSource||(t.CubismPhysicsSource={}));t.PhysicsJsonEffectiveForces=class{constructor(){this.gravity=new n(0,0),this.wind=new n(0,0)}};class s{}t.CubismPhysicsParameter=s;class r{}t.CubismPhysicsNormalization=r;t.CubismPhysicsParticle=class{constructor(){this.initialPosition=new n(0,0),this.position=new n(0,0),this.lastPosition=new n(0,0),this.lastGravity=new n(0,0),this.force=new n(0,0),this.velocity=new n(0,0)}};t.CubismPhysicsSubRig=class{constructor(){this.normalizationPosition=new r,this.normalizationAngle=new r}};t.CubismPhysicsInput=class{constructor(){this.source=new s}};t.CubismPhysicsOutput=class{constructor(){this.destination=new s,this.translationScale=new n(0,0)}};t.CubismPhysicsRig=class{constructor(){this.settings=new o,this.inputs=new o,this.outputs=new o,this.particles=new o,this.gravity=new n(0,0),this.wind=new n(0,0)}}}(s||(s={}))},"./src/Framework/physics/cubismphysicsjson.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/utils/cubismjson.ts"),o=i("./src/Framework/math/cubismvector2.ts"),n=i("./src/Framework/live2dcubismframework.ts").Live2DCubismFramework.CubismFramework,a=o.Live2DCubismFramework.CubismVector2,l=r.Live2DCubismFramework.CubismJson;!function(t){const e="Meta",i="PhysicsSettings";t.CubismPhysicsJson=class{constructor(t,e){this._json=l.create(t,e)}release(){l.delete(this._json)}getGravity(){const t=new a(0,0);return t.x=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Gravity").getValueByString("X").toFloat(),t.y=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Gravity").getValueByString("Y").toFloat(),t}getWind(){const t=new a(0,0);return t.x=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Wind").getValueByString("X").toFloat(),t.y=this._json.getRoot().getValueByString(e).getValueByString("EffectiveForces").getValueByString("Wind").getValueByString("Y").toFloat(),t}getSubRigCount(){return this._json.getRoot().getValueByString(e).getValueByString("PhysicsSettingCount").toInt()}getTotalInputCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalInputCount").toInt()}getTotalOutputCount(){return this._json.getRoot().getValueByString(e).getValueByString("TotalOutputCount").toInt()}getVertexCount(){return this._json.getRoot().getValueByString(e).getValueByString("VertexCount").toInt()}getNormalizationPositionMinimumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Position").getValueByString("Minimum").toFloat()}getNormalizationPositionMaximumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Position").getValueByString("Maximum").toFloat()}getNormalizationPositionDefaultValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Position").getValueByString("Default").toFloat()}getNormalizationAngleMinimumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Angle").getValueByString("Minimum").toFloat()}getNormalizationAngleMaximumValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Angle").getValueByString("Maximum").toFloat()}getNormalizationAngleDefaultValue(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Normalization").getValueByString("Angle").getValueByString("Default").toFloat()}getInputCount(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getVector().getSize()}getInputWeight(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Weight").toFloat()}getInputReflect(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Reflect").toBoolean()}getInputType(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Type").getRawString()}getInputSourceId(t,e){return n.getIdManager().getId(this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Input").getValueByIndex(e).getValueByString("Source").getValueByString("Id").getRawString())}getOutputCount(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getVector().getSize()}getOutputVertexIndex(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("VertexIndex").toInt()}getOutputAngleScale(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Scale").toFloat()}getOutputWeight(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Weight").toFloat()}getOutputDestinationId(t,e){return n.getIdManager().getId(this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Destination").getValueByString("Id").getRawString())}getOutputType(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Type").getRawString()}getOutputReflect(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Output").getValueByIndex(e).getValueByString("Reflect").toBoolean()}getParticleCount(t){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getVector().getSize()}getParticleMobility(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Mobility").toFloat()}getParticleDelay(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Delay").toFloat()}getParticleAcceleration(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Acceleration").toFloat()}getParticleRadius(t,e){return this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Radius").toInt()}getParticlePosition(t,e){const s=new a(0,0);return s.x=this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Position").getValueByString("X").toFloat(),s.y=this._json.getRoot().getValueByString(i).getValueByIndex(t).getValueByString("Vertices").getValueByIndex(e).getValueByString("Position").getValueByString("Y").toFloat(),s}}}(s||(s={}))},"./src/Framework/rendering/cubismrenderer.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/math/cubismmatrix44.ts").Live2DCubismFramework.CubismMatrix44;!function(t){let e;t.CubismRenderer=class{constructor(){this._isCulling=!1,this._isPremultipliedAlpha=!1,this._anisortopy=0,this._model=null,this._modelColor=new i,this._mvpMatrix4x4=new r,this._mvpMatrix4x4.loadIdentity()}static create(){return null}static delete(t){null}initialize(t){this._model=t}drawModel(){null!=this.getModel()&&this.doDrawModel()}setMvpMatrix(t){this._mvpMatrix4x4.setMatrix(t.getArray())}getMvpMatrix(){return this._mvpMatrix4x4}setModelColor(t,e,i,s){t<0?t=0:t>1&&(t=1),e<0?e=0:e>1&&(e=1),i<0?i=0:i>1&&(i=1),s<0?s=0:s>1&&(s=1),this._modelColor.R=t,this._modelColor.G=e,this._modelColor.B=i,this._modelColor.A=s}getModelColor(){return JSON.parse(JSON.stringify(this._modelColor))}setIsPremultipliedAlpha(t){this._isPremultipliedAlpha=t}isPremultipliedAlpha(){return this._isPremultipliedAlpha}setIsCulling(t){this._isCulling=t}isCulling(){return this._isCulling}setAnisotropy(t){this._anisortopy=t}getAnisotropy(){return this._anisortopy}getModel(){return this._model}},function(t){t[t.CubismBlendMode_Normal=0]="CubismBlendMode_Normal",t[t.CubismBlendMode_Additive=1]="CubismBlendMode_Additive",t[t.CubismBlendMode_Multiplicative=2]="CubismBlendMode_Multiplicative"}(e=t.CubismBlendMode||(t.CubismBlendMode={}));class i{constructor(){this.R=1,this.G=1,this.B=1,this.A=1}}t.CubismTextureColor=i}(s||(s={}))},"./src/Framework/rendering/cubismrenderer_webgl.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/live2dcubismframework.ts"),o=i("./src/Framework/type/csmrectf.ts"),n=i("./src/Framework/rendering/cubismrenderer.ts"),a=i("./src/Framework/math/cubismmatrix44.ts"),l=i("./src/Framework/type/csmmap.ts"),u=i("./src/Framework/type/csmvector.ts"),h=i("./src/Framework/utils/cubismdebug.ts"),_=r.Live2DCubismFramework.Constant,c=a.Live2DCubismFramework.CubismMatrix44,d=o.Live2DCubismFramework.csmRect,m=l.Live2DCubismFramework.csmMap,p=u.Live2DCubismFramework.csmVector,g=n.Live2DCubismFramework.CubismRenderer,f=n.Live2DCubismFramework.CubismBlendMode,y=n.Live2DCubismFramework.CubismTextureColor;!function(t){let e,i,s,r;class o{constructor(){this._maskRenderTexture=null,this._colorBuffer=null,this._currentFrameNo=0,this._clippingMaskBufferSize=256,this._clippingContextListForMask=new p,this._clippingContextListForDraw=new p,this._channelColors=new p,this._tmpBoundsOnModel=new d,this._tmpMatrix=new c,this._tmpMatrixForMask=new c,this._tmpMatrixForDraw=new c,this._maskTexture=null;let t=new y;t.R=1,t.G=0,t.B=0,t.A=0,this._channelColors.pushBack(t),t=new y,t.R=0,t.G=1,t.B=0,t.A=0,this._channelColors.pushBack(t),t=new y,t.R=0,t.G=0,t.B=1,t.A=0,this._channelColors.pushBack(t),t=new y,t.R=0,t.G=0,t.B=0,t.A=1,this._channelColors.pushBack(t)}getChannelFlagAsColor(t){return this._channelColors.at(t)}getMaskRenderTexture(){let t=0;if(this._maskTexture&&0!=this._maskTexture.texture&&(this._maskTexture.frameNo=this._currentFrameNo,t=this._maskTexture.texture),0==t){const e=this._clippingMaskBufferSize;this._colorBuffer=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this._colorBuffer),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),t=this.gl.createFramebuffer(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,this._colorBuffer,0),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,s),this._maskTexture=new n(this._currentFrameNo,t)}return t}setGL(t){this.gl=t}calcClippedDrawTotalBounds(t,e){let i=Number.MAX_VALUE,s=Number.MAX_VALUE,r=Number.MIN_VALUE,o=Number.MIN_VALUE;const n=e._clippedDrawableIndexList.length;for(let a=0;a<n;a++){const n=e._clippedDrawableIndexList[a],l=t.getDrawableVertexCount(n),u=t.getDrawableVertices(n);let h=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,m=Number.MIN_VALUE;const p=l*_.vertexStep;for(let t=_.vertexOffset;t<p;t+=_.vertexStep){const e=u[t],i=u[t+1];e<h&&(h=e),e>d&&(d=e),i<c&&(c=i),i>m&&(m=i)}if(h!=Number.MAX_VALUE)if(h<i&&(i=h),c<s&&(s=c),d>r&&(r=d),m>o&&(o=m),i==Number.MAX_VALUE)e._allClippedDrawRect.x=0,e._allClippedDrawRect.y=0,e._allClippedDrawRect.width=0,e._allClippedDrawRect.height=0,e._isUsing=!1;else{e._isUsing=!0;const t=r-i,n=o-s;e._allClippedDrawRect.x=i,e._allClippedDrawRect.y=s,e._allClippedDrawRect.width=t,e._allClippedDrawRect.height=n}}}release(){for(let t=0;t<this._clippingContextListForMask.getSize();t++)this._clippingContextListForMask.at(t)&&(this._clippingContextListForMask.at(t).release(),this._clippingContextListForMask.set(t,void 0)),this._clippingContextListForMask.set(t,null);this._clippingContextListForMask=null;for(let t=0;t<this._clippingContextListForDraw.getSize();t++)this._clippingContextListForDraw.set(t,null);this._clippingContextListForDraw=null,this._maskTexture&&(this.gl.deleteFramebuffer(this._maskTexture.texture),this._maskTexture=null);for(let t=0;t<this._channelColors.getSize();t++)this._channelColors.set(t,null);this._channelColors=null,this.gl.deleteTexture(this._colorBuffer),this._colorBuffer=null}initialize(t,e,i,s){for(let t=0;t<e;t++){if(s[t]<=0){this._clippingContextListForDraw.pushBack(null);continue}let e=this.findSameClip(i[t],s[t]);null==e&&(e=new a(this,i[t],s[t]),this._clippingContextListForMask.pushBack(e)),e.addClippedDrawable(t),this._clippingContextListForDraw.pushBack(e)}}setupClippingContext(t,e){this._currentFrameNo++;let r=0;for(let e=0;e<this._clippingContextListForMask.getSize();e++){const i=this._clippingContextListForMask.at(e);this.calcClippedDrawTotalBounds(t,i),i._isUsing&&r++}if(r>0){this.gl.viewport(0,0,this._clippingMaskBufferSize,this._clippingMaskBufferSize),this._maskRenderTexture=this.getMaskRenderTexture();e.getMvpMatrix();e.preDraw(),this.setupLayoutBounds(r),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this._maskRenderTexture),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);for(let i=0;i<this._clippingContextListForMask.getSize();i++){const s=this._clippingContextListForMask.at(i),r=s._allClippedDrawRect,o=s._layoutBounds,n=.05;this._tmpBoundsOnModel.setRect(r),this._tmpBoundsOnModel.expand(r.width*n,r.height*n);const a=o.width/this._tmpBoundsOnModel.width,l=o.height/this._tmpBoundsOnModel.height;this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(-1,-1),this._tmpMatrix.scaleRelative(2,2),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(a,l),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForMask.setMatrix(this._tmpMatrix.getArray()),this._tmpMatrix.loadIdentity(),this._tmpMatrix.translateRelative(o.x,o.y),this._tmpMatrix.scaleRelative(a,l),this._tmpMatrix.translateRelative(-this._tmpBoundsOnModel.x,-this._tmpBoundsOnModel.y),this._tmpMatrixForDraw.setMatrix(this._tmpMatrix.getArray()),s._matrixForMask.setMatrix(this._tmpMatrixForMask.getArray()),s._matrixForDraw.setMatrix(this._tmpMatrixForDraw.getArray());const u=s._clippingIdCount;for(let i=0;i<u;i++){const r=s._clippingIdList[i];t.getDrawableDynamicFlagVertexPositionsDidChange(r)&&(e.setIsCulling(0!=t.getDrawableCulling(r)),e.setClippingContextBufferForMask(s),e.drawMesh(t.getDrawableTextureIndices(r),t.getDrawableVertexIndexCount(r),t.getDrawableVertexCount(r),t.getDrawableVertexIndices(r),t.getDrawableVertices(r),t.getDrawableVertexUvs(r),t.getDrawableOpacity(r),f.CubismBlendMode_Normal,!1))}}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,s),e.setClippingContextBufferForMask(null),this.gl.viewport(i[0],i[1],i[2],i[3])}}findSameClip(t,e){for(let i=0;i<this._clippingContextListForMask.getSize();i++){const s=this._clippingContextListForMask.at(i),r=s._clippingIdCount;if(r!=e)continue;let o=0;for(let e=0;e<r;e++){const i=s._clippingIdList[e];for(let e=0;e<r;e++)if(t[e]==i){o++;break}}if(o==r)return s}return null}setupLayoutBounds(t){let e=t/4,i=t%4;e=~~e,i=~~i;let s=0;for(let t=0;t<4;t++){const r=e+(t<i?1:0);if(0==r);else if(1==r){const e=this._clippingContextListForMask.at(s++);e._layoutChannelNo=t,e._layoutBounds.x=0,e._layoutBounds.y=0,e._layoutBounds.width=1,e._layoutBounds.height=1}else if(2==r)for(let e=0;e<r;e++){let i=e%2;i=~~i;const r=this._clippingContextListForMask.at(s++);r._layoutChannelNo=t,r._layoutBounds.x=.5*i,r._layoutBounds.y=0,r._layoutBounds.width=.5,r._layoutBounds.height=1}else if(r<=4)for(let e=0;e<r;e++){let i=e%2,r=e/2;i=~~i,r=~~r;const o=this._clippingContextListForMask.at(s++);o._layoutChannelNo=t,o._layoutBounds.x=.5*i,o._layoutBounds.y=.5*r,o._layoutBounds.width=.5,o._layoutBounds.height=.5}else if(r<=9)for(let e=0;e<r;e++){let i=e%3,r=e/3;i=~~i,r=~~r;const o=this._clippingContextListForMask.at(s++);o._layoutChannelNo=t,o._layoutBounds.x=i/3,o._layoutBounds.y=r/3,o._layoutBounds.width=1/3,o._layoutBounds.height=1/3}else Object(h.CubismLogError)("not supported mask count : {0}",r)}}getColorBuffer(){return this._colorBuffer}getClippingContextListForDraw(){return this._clippingContextListForDraw}setClippingMaskBufferSize(t){this._clippingMaskBufferSize=t}getClippingMaskBufferSize(){return this._clippingMaskBufferSize}}t.CubismClippingManager_WebGL=o;class n{constructor(t,e){this.frameNo=t,this.texture=e}}t.CubismRenderTextureResource=n;class a{constructor(t,e,i){this._owner=t,this._clippingIdList=e,this._clippingIdCount=i,this._allClippedDrawRect=new d,this._layoutBounds=new d,this._clippedDrawableIndexList=[],this._matrixForMask=new c,this._matrixForDraw=new c}release(){null!=this._layoutBounds&&(this._layoutBounds=null),null!=this._allClippedDrawRect&&(this._allClippedDrawRect=null),null!=this._clippedDrawableIndexList&&(this._clippedDrawableIndexList=null)}addClippedDrawable(t){this._clippedDrawableIndexList.push(t)}getClippingManager(){return this._owner}setGl(t){this._owner.setGL(t)}}t.CubismClippingContext=a;class l{constructor(){this._shaderSets=new p}static getInstance(){return null==e?(e=new l,e):e}static deleteInstance(){e&&(e.release(),e=null)}release(){this.releaseShaderProgram()}setupShaderProgram(t,e,i,s,o,n,a,l,_,c,d,m,p){let g,y,$,S;if(d||Object(h.CubismLogError)("NoPremultipliedAlpha is not allowed"),0==this._shaderSets.getSize()&&this.generateShaders(),null!=t.getClippingContextBufferForMask()){const i=this._shaderSets.at(r.ShaderNames_SetupMask);this.gl.useProgram(i.shaderProgram),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(i.samplerTexture0Location,0),null==a.vertex&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(i.attributePositionLocation),this.gl.vertexAttribPointer(i.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==a.uv&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(i.attributeTexCoordLocation),this.gl.vertexAttribPointer(i.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0);const o=t.getClippingContextBufferForMask()._layoutChannelNo,l=t.getClippingContextBufferForMask().getClippingManager().getChannelFlagAsColor(o);this.gl.uniform4f(i.uniformChannelFlagLocation,l.R,l.G,l.B,l.A),this.gl.uniformMatrix4fv(i.uniformClipMatrixLocation,!1,t.getClippingContextBufferForMask()._matrixForMask.getArray());const u=t.getClippingContextBufferForMask()._layoutBounds;this.gl.uniform4f(i.uniformBaseColorLocation,2*u.x-1,2*u.y-1,2*u.getRight()-1,2*u.getBottom()-1),g=this.gl.ZERO,y=this.gl.ONE_MINUS_SRC_COLOR,$=this.gl.ZERO,S=this.gl.ONE_MINUS_SRC_ALPHA}else{const i=null!=t.getClippingContextBufferForDraw(),o=i?p?2:1:0;let l=new u;switch(_){case f.CubismBlendMode_Normal:default:l=this._shaderSets.at(r.ShaderNames_NormalPremultipliedAlpha+o),g=this.gl.ONE,y=this.gl.ONE_MINUS_SRC_ALPHA,$=this.gl.ONE,S=this.gl.ONE_MINUS_SRC_ALPHA;break;case f.CubismBlendMode_Additive:l=this._shaderSets.at(r.ShaderNames_AddPremultipliedAlpha+o),g=this.gl.ONE,y=this.gl.ONE,$=this.gl.ZERO,S=this.gl.ONE;break;case f.CubismBlendMode_Multiplicative:l=this._shaderSets.at(r.ShaderNames_MultPremultipliedAlpha+o),g=this.gl.DST_COLOR,y=this.gl.ONE_MINUS_SRC_ALPHA,$=this.gl.ZERO,S=this.gl.ONE}if(this.gl.useProgram(l.shaderProgram),null==a.vertex&&(a.vertex=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.vertex),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(l.attributePositionLocation),this.gl.vertexAttribPointer(l.attributePositionLocation,2,this.gl.FLOAT,!1,0,0),null==a.uv&&(a.uv=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,a.uv),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.enableVertexAttribArray(l.attributeTexCoordLocation),this.gl.vertexAttribPointer(l.attributeTexCoordLocation,2,this.gl.FLOAT,!1,0,0),i){this.gl.activeTexture(this.gl.TEXTURE1);const e=t.getClippingContextBufferForDraw().getClippingManager().getColorBuffer();this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(l.samplerTexture1Location,1),this.gl.uniformMatrix4fv(l.uniformClipMatrixLocation,!1,t.getClippingContextBufferForDraw()._matrixForDraw.getArray());const i=t.getClippingContextBufferForDraw()._layoutChannelNo,s=t.getClippingContextBufferForDraw().getClippingManager().getChannelFlagAsColor(i);this.gl.uniform4f(l.uniformChannelFlagLocation,s.R,s.G,s.B,s.A)}this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(l.samplerTexture0Location,0),this.gl.uniformMatrix4fv(l.uniformMatrixLocation,!1,m.getArray()),this.gl.uniform4f(l.uniformBaseColorLocation,c.R,c.G,c.B,c.A)}null==a.index&&(a.index=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,a.index),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,o,this.gl.DYNAMIC_DRAW),this.gl.blendFuncSeparate(g,y,$,S)}releaseShaderProgram(){for(let t=0;t<this._shaderSets.getSize();t++)this.gl.deleteProgram(this._shaderSets.at(t).shaderProgram),this._shaderSets.at(t).shaderProgram=0,this._shaderSets.set(t,void 0),this._shaderSets.set(t,null)}generateShaders(){for(let t=0;t<10;t++)this._shaderSets.pushBack(new u);this._shaderSets.at(0).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcSetupMask,t.fragmentShaderSrcsetupMask),this._shaderSets.at(1).shaderProgram=this.loadShaderProgram(t.vertexShaderSrc,t.fragmentShaderSrcPremultipliedAlpha),this._shaderSets.at(2).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcMasked,t.fragmentShaderSrcMaskPremultipliedAlpha),this._shaderSets.at(3).shaderProgram=this.loadShaderProgram(t.vertexShaderSrcMasked,t.fragmentShaderSrcMaskInvertedPremultipliedAlpha),this._shaderSets.at(4).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(5).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(6).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(7).shaderProgram=this._shaderSets.at(1).shaderProgram,this._shaderSets.at(8).shaderProgram=this._shaderSets.at(2).shaderProgram,this._shaderSets.at(9).shaderProgram=this._shaderSets.at(3).shaderProgram,this._shaderSets.at(0).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_position"),this._shaderSets.at(0).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(0).shaderProgram,"a_texCoord"),this._shaderSets.at(0).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"s_texture0"),this._shaderSets.at(0).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_clipMatrix"),this._shaderSets.at(0).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_channelFlag"),this._shaderSets.at(0).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(0).shaderProgram,"u_baseColor"),this._shaderSets.at(1).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_position"),this._shaderSets.at(1).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(1).shaderProgram,"a_texCoord"),this._shaderSets.at(1).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"s_texture0"),this._shaderSets.at(1).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_matrix"),this._shaderSets.at(1).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(1).shaderProgram,"u_baseColor"),this._shaderSets.at(2).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_position"),this._shaderSets.at(2).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(2).shaderProgram,"a_texCoord"),this._shaderSets.at(2).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture0"),this._shaderSets.at(2).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"s_texture1"),this._shaderSets.at(2).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_matrix"),this._shaderSets.at(2).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_clipMatrix"),this._shaderSets.at(2).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_channelFlag"),this._shaderSets.at(2).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(2).shaderProgram,"u_baseColor"),this._shaderSets.at(3).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_position"),this._shaderSets.at(3).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(3).shaderProgram,"a_texCoord"),this._shaderSets.at(3).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture0"),this._shaderSets.at(3).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"s_texture1"),this._shaderSets.at(3).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_matrix"),this._shaderSets.at(3).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_clipMatrix"),this._shaderSets.at(3).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_channelFlag"),this._shaderSets.at(3).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(3).shaderProgram,"u_baseColor"),this._shaderSets.at(4).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_position"),this._shaderSets.at(4).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(4).shaderProgram,"a_texCoord"),this._shaderSets.at(4).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"s_texture0"),this._shaderSets.at(4).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_matrix"),this._shaderSets.at(4).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(4).shaderProgram,"u_baseColor"),this._shaderSets.at(5).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_position"),this._shaderSets.at(5).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(5).shaderProgram,"a_texCoord"),this._shaderSets.at(5).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture0"),this._shaderSets.at(5).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"s_texture1"),this._shaderSets.at(5).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_matrix"),this._shaderSets.at(5).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_clipMatrix"),this._shaderSets.at(5).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_channelFlag"),this._shaderSets.at(5).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(5).shaderProgram,"u_baseColor"),this._shaderSets.at(6).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_position"),this._shaderSets.at(6).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(6).shaderProgram,"a_texCoord"),this._shaderSets.at(6).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture0"),this._shaderSets.at(6).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"s_texture1"),this._shaderSets.at(6).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_matrix"),this._shaderSets.at(6).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_clipMatrix"),this._shaderSets.at(6).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_channelFlag"),this._shaderSets.at(6).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(6).shaderProgram,"u_baseColor"),this._shaderSets.at(7).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_position"),this._shaderSets.at(7).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(7).shaderProgram,"a_texCoord"),this._shaderSets.at(7).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"s_texture0"),this._shaderSets.at(7).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_matrix"),this._shaderSets.at(7).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(7).shaderProgram,"u_baseColor"),this._shaderSets.at(8).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_position"),this._shaderSets.at(8).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(8).shaderProgram,"a_texCoord"),this._shaderSets.at(8).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture0"),this._shaderSets.at(8).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"s_texture1"),this._shaderSets.at(8).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_matrix"),this._shaderSets.at(8).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_clipMatrix"),this._shaderSets.at(8).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_channelFlag"),this._shaderSets.at(8).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(8).shaderProgram,"u_baseColor"),this._shaderSets.at(9).attributePositionLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_position"),this._shaderSets.at(9).attributeTexCoordLocation=this.gl.getAttribLocation(this._shaderSets.at(9).shaderProgram,"a_texCoord"),this._shaderSets.at(9).samplerTexture0Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture0"),this._shaderSets.at(9).samplerTexture1Location=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"s_texture1"),this._shaderSets.at(9).uniformMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_matrix"),this._shaderSets.at(9).uniformClipMatrixLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_clipMatrix"),this._shaderSets.at(9).uniformChannelFlagLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_channelFlag"),this._shaderSets.at(9).uniformBaseColorLocation=this.gl.getUniformLocation(this._shaderSets.at(9).shaderProgram,"u_baseColor")}loadShaderProgram(t,e){let i=this.gl.createProgram(),s=this.compileShaderSource(this.gl.VERTEX_SHADER,t);if(!s)return Object(h.CubismLogError)("Vertex shader compile error!"),0;let r=this.compileShaderSource(this.gl.FRAGMENT_SHADER,e);if(!r)return Object(h.CubismLogError)("Vertex shader compile error!"),0;this.gl.attachShader(i,s),this.gl.attachShader(i,r),this.gl.linkProgram(i);return this.gl.getProgramParameter(i,this.gl.LINK_STATUS)?(this.gl.deleteShader(s),this.gl.deleteShader(r),i):(Object(h.CubismLogError)("Failed to link program: {0}",i),this.gl.deleteShader(s),s=0,this.gl.deleteShader(r),r=0,i&&(this.gl.deleteProgram(i),i=0),0)}compileShaderSource(t,e){const i=e,s=this.gl.createShader(t);if(this.gl.shaderSource(s,i),this.gl.compileShader(s),!s){const t=this.gl.getShaderInfoLog(s);Object(h.CubismLogError)("Shader compile log: {0} ",t)}return this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS)?s:(this.gl.deleteShader(s),null)}setGl(t){this.gl=t}}t.CubismShader_WebGL=l;class u{}t.CubismShaderSet=u,function(t){t[t.ShaderNames_SetupMask=0]="ShaderNames_SetupMask",t[t.ShaderNames_NormalPremultipliedAlpha=1]="ShaderNames_NormalPremultipliedAlpha",t[t.ShaderNames_NormalMaskedPremultipliedAlpha=2]="ShaderNames_NormalMaskedPremultipliedAlpha",t[t.ShaderNames_NomralMaskedInvertedPremultipliedAlpha=3]="ShaderNames_NomralMaskedInvertedPremultipliedAlpha",t[t.ShaderNames_AddPremultipliedAlpha=4]="ShaderNames_AddPremultipliedAlpha",t[t.ShaderNames_AddMaskedPremultipliedAlpha=5]="ShaderNames_AddMaskedPremultipliedAlpha",t[t.ShaderNames_AddMaskedPremultipliedAlphaInverted=6]="ShaderNames_AddMaskedPremultipliedAlphaInverted",t[t.ShaderNames_MultPremultipliedAlpha=7]="ShaderNames_MultPremultipliedAlpha",t[t.ShaderNames_MultMaskedPremultipliedAlpha=8]="ShaderNames_MultMaskedPremultipliedAlpha",t[t.ShaderNames_MultMaskedPremultipliedAlphaInverted=9]="ShaderNames_MultMaskedPremultipliedAlphaInverted"}(r=t.ShaderNames||(t.ShaderNames={})),t.vertexShaderSrcSetupMask="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_myPos;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_clipMatrix * a_position;   v_myPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.fragmentShaderSrcsetupMask="precision mediump float;varying vec2       v_texCoord;varying vec4       v_myPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;void main(){   float isInside =        step(u_baseColor.x, v_myPos.x/v_myPos.w)       * step(u_baseColor.y, v_myPos.y/v_myPos.w)       * step(v_myPos.x/v_myPos.w, u_baseColor.z)       * step(v_myPos.y/v_myPos.w, u_baseColor.w);   gl_FragColor = u_channelFlag * texture2D(s_texture0, v_texCoord).a * isInside;}",t.vertexShaderSrc="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;uniform mat4       u_matrix;void main(){   gl_Position = u_matrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.vertexShaderSrcMasked="attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform mat4       u_matrix;uniform mat4       u_clipMatrix;void main(){   gl_Position = u_matrix * a_position;   v_clipPos = u_clipMatrix * a_position;   v_texCoord = a_texCoord;   v_texCoord.y = 1.0 - v_texCoord.y;}",t.fragmentShaderSrcPremultipliedAlpha="precision mediump float;varying vec2       v_texCoord;uniform vec4       u_baseColor;uniform sampler2D  s_texture0;void main(){   gl_FragColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;}",t.fragmentShaderSrcMaskPremultipliedAlpha="precision mediump float;varying vec2       v_texCoord;varying vec4       v_clipPos;uniform vec4       u_baseColor;uniform vec4       u_channelFlag;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;void main(){   vec4 col_formask = texture2D(s_texture0 , v_texCoord) * u_baseColor;   vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;   float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;   col_formask = col_formask * maskVal;   gl_FragColor = col_formask;}",t.fragmentShaderSrcMaskInvertedPremultipliedAlpha="precision mediump float;varying vec2 v_texCoord;varying vec4 v_clipPos;uniform sampler2D s_texture0;uniform sampler2D s_texture1;uniform vec4 u_channelFlag;uniform vec4 u_baseColor;void main(){vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;vec4 clipMask = (1.0 - texture2D(s_texture1, v_clipPos.xy / v_clipPos.w)) * u_channelFlag;float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;col_formask = col_formask * (1.0 - maskVal);gl_FragColor = col_formask;}";class $ extends g{constructor(){super(),this._clippingContextBufferForMask=null,this._clippingContextBufferForDraw=null,this._clippingManager=new o,this.firstDraw=!0,this._textures=new m,this._sortedDrawableIndexList=new p,this._bufferData={vertex:WebGLBuffer=null,uv:WebGLBuffer=null,index:WebGLBuffer=null},this._textures.prepareCapacity(32,!0)}initialize(t){t.isUsingMasking()&&(this._clippingManager=new o,this._clippingManager.initialize(t,t.getDrawableCount(),t.getDrawableMasks(),t.getDrawableMaskCounts())),this._sortedDrawableIndexList.resize(t.getDrawableCount(),0),super.initialize(t)}bindTexture(t,e){this._textures.setValue(t,e)}getBindedTextures(){return this._textures}setClippingMaskBufferSize(t){this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this._clippingManager=new o,this._clippingManager.setClippingMaskBufferSize(t),this._clippingManager.initialize(this.getModel(),this.getModel().getDrawableCount(),this.getModel().getDrawableMasks(),this.getModel().getDrawableMaskCounts())}getClippingMaskBufferSize(){return this._clippingManager.getClippingMaskBufferSize()}release(){this._clippingManager.release(),this._clippingManager=void 0,this._clippingManager=null,this.gl.deleteBuffer(this._bufferData.vertex),this._bufferData.vertex=null,this.gl.deleteBuffer(this._bufferData.uv),this._bufferData.uv=null,this.gl.deleteBuffer(this._bufferData.index),this._bufferData.index=null,this._bufferData=null,this._textures=null}doDrawModel(){null!=this._clippingManager&&(this.preDraw(),this._clippingManager.setupClippingContext(this.getModel(),this)),this.preDraw();const t=this.getModel().getDrawableCount(),e=this.getModel().getDrawableRenderOrders();for(let i=0;i<t;++i){const t=e[i];this._sortedDrawableIndexList.set(t,i)}for(let e=0;e<t;++e){const t=this._sortedDrawableIndexList.at(e);this.getModel().getDrawableDynamicFlagIsVisible(t)&&(this.setClippingContextBufferForDraw(null!=this._clippingManager?this._clippingManager.getClippingContextListForDraw().at(t):null),this.setIsCulling(this.getModel().getDrawableCulling(t)),this.drawMesh(this.getModel().getDrawableTextureIndices(t),this.getModel().getDrawableVertexIndexCount(t),this.getModel().getDrawableVertexCount(t),this.getModel().getDrawableVertexIndices(t),this.getModel().getDrawableVertices(t),this.getModel().getDrawableVertexUvs(t),this.getModel().getDrawableOpacity(t),this.getModel().getDrawableBlendMode(t),this.getModel().getDrawableInvertedMaskBit(t)))}}drawMesh(t,e,i,s,r,o,n,a,u){this.isCulling()?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW);const h=this.getModelColor();let _;null==this.getClippingContextBufferForMask()&&(h.A*=n,this.isPremultipliedAlpha()&&(h.R*=h.A,h.G*=h.A,h.B*=h.A)),_=null!=this._textures.getValue(t)?this._textures.getValue(t):null,l.getInstance().setupShaderProgram(this,_,i,r,s,o,this._bufferData,n,a,h,this.isPremultipliedAlpha(),this.getMvpMatrix(),u),this.gl.drawElements(this.gl.TRIANGLES,e,this.gl.UNSIGNED_SHORT,0),this.gl.useProgram(null),this.setClippingContextBufferForDraw(null),this.setClippingContextBufferForMask(null)}static doStaticRelease(){l.deleteInstance()}setRenderState(t,e){s=t,i=e}preDraw(){this.firstDraw&&(this.firstDraw=!1,this._anisortopy=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")),this.gl.disable(this.gl.SCISSOR_TEST),this.gl.disable(this.gl.STENCIL_TEST),this.gl.disable(this.gl.DEPTH_TEST),this.gl.frontFace(this.gl.CW),this.gl.enable(this.gl.BLEND),this.gl.colorMask(!0,!0,!0,!0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)}setClippingContextBufferForMask(t){this._clippingContextBufferForMask=t}getClippingContextBufferForMask(){return this._clippingContextBufferForMask}setClippingContextBufferForDraw(t){this._clippingContextBufferForDraw=t}getClippingContextBufferForDraw(){return this._clippingContextBufferForDraw}startUp(t){this.gl=t,this._clippingManager.setGL(t),l.getInstance().setGl(t)}}t.CubismRenderer_WebGL=$,g.staticRelease=()=>{$.doStaticRelease()}}(s||(s={}))},"./src/Framework/type/csmmap.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/utils/cubismdebug.ts");!function(t){class e{constructor(t,e){this.first=null==t?null:t,this.second=null==e?null:e}}t.csmPair=e;class i{constructor(t){null!=t?t<1?(this._keyValues=[],this._dummyValue=null,this._size=0):(this._keyValues=new Array(t),this._size=t):(this._keyValues=[],this._dummyValue=null,this._size=0)}release(){this.clear()}appendKey(t){this.prepareCapacity(this._size+1,!1),this._keyValues[this._size]=new e(t),this._size+=1}getValue(t){let e=-1;for(let i=0;i<this._size;i++)if(this._keyValues[i].first==t){e=i;break}return e>=0?this._keyValues[e].second:(this.appendKey(t),this._keyValues[this._size-1].second)}setValue(t,e){let i=-1;for(let e=0;e<this._size;e++)if(this._keyValues[e].first==t){i=e;break}i>=0?this._keyValues[i].second=e:(this.appendKey(t),this._keyValues[this._size-1].second=e)}isExist(t){for(let e=0;e<this._size;e++)if(this._keyValues[e].first==t)return!0;return!1}clear(){this._keyValues=void 0,this._keyValues=null,this._keyValues=[],this._size=0}getSize(){return this._size}prepareCapacity(t,e){t>this._keyValues.length&&(0==this._keyValues.length?(!e&&t<i.DefaultSize&&(t=i.DefaultSize),this._keyValues.length=t):(!e&&t<2*this._keyValues.length&&(t=2*this._keyValues.length),this._keyValues.length=t))}begin(){return new s(this,0)}end(){return new s(this,this._size)}erase(t){const e=t._index;if(e<0||this._size<=e)return t;this._keyValues.splice(e,1),--this._size;return new s(this,e)}dumpAsInt(){for(let t=0;t<this._size;t++)Object(r.CubismLogDebug)("{0} ,",this._keyValues[t]),Object(r.CubismLogDebug)("\n")}}i.DefaultSize=10,t.csmMap=i;class s{constructor(t,e){this._map=null!=t?t:new i,this._index=null!=e?e:0}set(t){return this._index=t._index,this._map=t._map,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new s(this._map,this._index++)}decrement(){const t=new s(this._map,this._index);return this._map=t._map,this._index=t._index,this}ptr(){return this._map._keyValues[this._index]}notEqual(t){return this._index!=t._index||this._map!=t._map}}t.iterator=s}(s||(s={}))},"./src/Framework/type/csmrectf.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){t.csmRect=class{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}getCenterX(){return this.x+.5*this.width}getCenterY(){return this.y+.5*this.height}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}setRect(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}expand(t,e){this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e}}}(s||(s={}))},"./src/Framework/type/csmstring.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){t.csmString=class{constructor(t){this.s=t}append(t,e){return this.s+=void 0!==e?t.substr(0,e):t,this}expansion(t,e){for(let i=0;i<t;i++)this.append(e);return this}getBytes(){return encodeURIComponent(this.s).replace(/%../g,"x").length}getLength(){return this.s.length}isLess(t){return this.s<t.s}isGreat(t){return this.s>t.s}isEqual(t){return this.s==t}isEmpty(){return 0==this.s.length}}}(s||(s={}))},"./src/Framework/type/csmvector.ts":function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s})),function(t){class e{constructor(t=0){t<1?(this._ptr=[],this._capacity=0,this._size=0):(this._ptr=new Array(t),this._capacity=t,this._size=0)}at(t){return this._ptr[t]}set(t,e){this._ptr[t]=e}get(t=0){const e=new Array;for(let i=t;i<this._size;i++)e.push(this._ptr[i]);return e}pushBack(t){this._size>=this._capacity&&this.prepareCapacity(0==this._capacity?e.s_defaultSize:2*this._capacity),this._ptr[this._size++]=t}clear(){this._ptr.length=0,this._size=0}getSize(){return this._size}assign(t,e){this._size<t&&this.prepareCapacity(t);for(let i=0;i<t;i++)this._ptr[i]=e;this._size=t}resize(t,e=null){this.updateSize(t,e,!0)}updateSize(t,e=null,i=!0){if(this._size<t)if(this.prepareCapacity(t),i)for(let i=this._size;i<t;i++)this._ptr[i]="function"==typeof e?JSON.parse(JSON.stringify(new e)):e;else for(let i=this._size;i<t;i++)this._ptr[i]=e;else{const e=this._size-t;this._ptr.splice(this._size-e,e)}this._size=t}insert(t,e,i){let s=t._index;const r=e._index,o=i._index,n=o-r;this.prepareCapacity(this._size+n);const a=this._size-s;if(a>0)for(let t=0;t<a;t++)this._ptr.splice(s+t,0,null);for(let t=r;t<o;t++,s++)this._ptr[s]=e._vector._ptr[t];this._size=this._size+n}remove(t){return!(t<0||this._size<=t)&&(this._ptr.splice(t,1),--this._size,!0)}erase(t){const e=t._index;if(e<0||this._size<=e)return t;this._ptr.splice(e,1),--this._size;return new i(this,e)}prepareCapacity(t){t>this._capacity&&(0==this._capacity?(this._ptr=new Array(t),this._capacity=t):(this._ptr.length=t,this._capacity=t))}begin(){return 0==this._size?this.end():new i(this,0)}end(){return new i(this,this._size)}getOffset(t){const i=new e;return i._ptr=this.get(t),i._size=this.get(t).length,i._capacity=this.get(t).length,i}}e.s_defaultSize=10,t.csmVector=e;class i{constructor(t,e){this._vector=null!=t?t:null,this._index=null!=e?e:0}set(t){return this._index=t._index,this._vector=t._vector,this}preIncrement(){return++this._index,this}preDecrement(){return--this._index,this}increment(){return new i(this._vector,this._index++)}decrement(){return new i(this._vector,this._index--)}ptr(){return this._vector._ptr[this._index]}substitution(t){return this._index=t._index,this._vector=t._vector,this}notEqual(t){return this._index!=t._index||this._vector!=t._vector}}t.iterator=i}(s||(s={}))},"./src/Framework/utils/cubismdebug.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"CubismLogPrint",(function(){return o})),i.d(e,"CubismLogPrintIn",(function(){return n})),i.d(e,"CSM_ASSERT",(function(){return a})),i.d(e,"CubismLogVerbose",(function(){return l})),i.d(e,"CubismLogDebug",(function(){return u})),i.d(e,"CubismLogInfo",(function(){return h})),i.d(e,"CubismLogWarning",(function(){return _})),i.d(e,"CubismLogError",(function(){return c})),i.d(e,"Live2DCubismFramework",(function(){return d}));var s=i("./src/Framework/live2dcubismframework.ts"),r=i("./src/Framework/cubismframeworkconfig.ts");const o=(t,e,i)=>{d.CubismDebug.print(t,"[CSM]"+e,i)},n=(t,e,i)=>{o(t,e+"\n",i)},a=t=>{console.assert(t)};let l,u,h,_,c;var d;r.CSM_LOG_LEVEL<=r.CSM_LOG_LEVEL_VERBOSE?(l=(t,...e)=>{n(s.LogLevel.LogLevel_Verbose,"[V]"+t,e)},u=(t,...e)=>{n(s.LogLevel.LogLevel_Debug,"[D]"+t,e)},h=(t,...e)=>{n(s.LogLevel.LogLevel_Info,"[I]"+t,e)},_=(t,...e)=>{n(s.LogLevel.LogLevel_Warning,"[W]"+t,e)},c=(t,...e)=>{n(s.LogLevel.LogLevel_Error,"[E]"+t,e)}):r.CSM_LOG_LEVEL==r.CSM_LOG_LEVEL_DEBUG?(u=(t,...e)=>{n(s.LogLevel.LogLevel_Debug,"[D]"+t,e)},h=(t,...e)=>{n(s.LogLevel.LogLevel_Info,"[I]"+t,e)},_=(t,...e)=>{n(s.LogLevel.LogLevel_Warning,"[W]"+t,e)},c=(t,...e)=>{n(s.LogLevel.LogLevel_Error,"[E]"+t,e)}):r.CSM_LOG_LEVEL==r.CSM_LOG_LEVEL_INFO?(h=(t,...e)=>{n(s.LogLevel.LogLevel_Info,"[I]"+t,e)},_=(t,...e)=>{n(s.LogLevel.LogLevel_Warning,"[W]"+t,e)},c=(t,...e)=>{n(s.LogLevel.LogLevel_Error,"[E]"+t,e)}):r.CSM_LOG_LEVEL==r.CSM_LOG_LEVEL_WARNING?(_=(t,...e)=>{n(s.LogLevel.LogLevel_Warning,"[W]"+t,e)},c=(t,...e)=>{n(s.LogLevel.LogLevel_Error,"[E]"+t,e)}):r.CSM_LOG_LEVEL==r.CSM_LOG_LEVEL_ERROR&&(c=(t,...e)=>{n(s.LogLevel.LogLevel_Error,"[E]"+t,e)}),function(t){t.CubismDebug=class{static print(t,e,i){if(t<s.Live2DCubismFramework.CubismFramework.getLoggingLevel())return;const r=s.Live2DCubismFramework.CubismFramework.coreLogFunction;if(!r)return;r(e.replace(/\{(\d+)\}/g,(t,e)=>i[e]))}static dumpBytes(t,e,i){for(let s=0;s<i;s++)s%16==0&&s>0?this.print(t,"\n"):s%8==0&&s>0&&this.print(t,"  "),this.print(t,"{0} ",[255&e[s]]);this.print(t,"\n")}constructor(){}}}(d||(d={}))},"./src/Framework/utils/cubismjson.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"Live2DCubismFramework",(function(){return s}));var s,r=i("./src/Framework/type/csmstring.ts"),o=i("./src/Framework/type/csmmap.ts"),n=i("./src/Framework/type/csmvector.ts"),a=i("./src/Framework/utils/cubismdebug.ts"),l=i("./src/Framework/live2dcubismframework.ts"),u=n.Live2DCubismFramework.csmVector,h=o.Live2DCubismFramework.csmMap,_=r.Live2DCubismFramework.csmString;!function(t){class e{constructor(){}getRawString(t,e){return this.getString(t,e)}toInt(t=0){return t}toFloat(t=0){return t}toBoolean(t=!1){return t}getSize(){return 0}getArray(t=null){return t}getVector(t){return t}getMap(t){return t}getValueByIndex(t){return e.errorValue.setErrorNotForClientCall("Error: type mismatch")}getValueByString(t){return e.nullValue.setErrorNotForClientCall("Error: type mismatch")}getKeys(){return e.s_dummyKeys}isError(){return!1}isNull(){return!1}isBool(){return!1}isFloat(){return!1}isString(){return!1}isArray(){return!1}isMap(){return!1}equals(t){return!1}isStatic(){return!1}setErrorNotForClientCall(t){return n.errorValue}static staticInitializeNotForClientCall(){r.trueValue=new r(!0),r.falseValue=new r(!1),n.errorValue=new n("ERROR",!0),this.nullValue=new c,e.s_dummyKeys=new u}static staticReleaseNotForClientCall(){r.trueValue=null,r.falseValue=null,n.errorValue=null,e.nullValue=null,e.s_dummyKeys=null,r.trueValue=null,r.falseValue=null,n.errorValue=null,e.nullValue=null,e.s_dummyKeys=null}}t.Value=e;class i{constructor(t,e){this._error=null,this._lineCount=0,this._root=null,null!=t&&this.parseBytes(t,e)}static create(t,e){const s=new i;return s.parseBytes(t,e)?s:(i.delete(s),null)}static delete(t){null}getRoot(){return this._root}arrayBufferToString(t){const e=new Uint8Array(t);let i="";for(let t=0,s=e.length;t<s;++t)i+="%"+this.pad(e[t].toString(16));return i=decodeURIComponent(i),i}pad(t){return t.length<2?"0"+t:t}parseBytes(t,e){const i=new Array(1),s=this.arrayBufferToString(t);if(this._root=this.parseValue(s,e,0,i),this._error){let t="\0";return t="Json parse error : @line "+(this._lineCount+1)+"\n",this._root=new o(t),Object(a.CubismLogInfo)("{0}",this._root.getRawString()),!1}return null!=this._root||(this._root=new n(new _(this._error),!1),!1)}getParseError(){return this._error}checkEndOfFile(){return this._root.getArray()[1].equals("EOF")}parseValue(t,e,i,n){if(this._error)return null;let a,u=null,h=i;for(;h<e;h++){switch(t[h]){case"-":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{const e=new Array(1);return a=Object(l.strtod)(t.slice(h),e),n[0]=t.indexOf(e[0]),new s(a)}case'"':return new o(this.parseString(t,e,h+1,n));case"[":return u=this.parseArray(t,e,h+1,n),u;case"{":return u=this.parseObject(t,e,h+1,n),u;case"n":return h+3<e?(u=new c,n[0]=h+4):this._error="parse null",u;case"t":return h+3<e?(u=r.trueValue,n[0]=h+4):this._error="parse true",u;case"f":return h+4<e?(u=r.falseValue,n[0]=h+5):this._error="illegal ',' position",u;case",":return this._error="illegal ',' position",null;case"]":return n[0]=h,null;case"\n":this._lineCount++}}return this._error="illegal end of value",null}parseString(t,e,i,s){if(this._error)return null;let r,o,n=i;const a=new _("");let l=i;for(;n<e;n++)switch(r=t[n],r){case'"':return s[0]=n+1,a.append(t.slice(l),n-l),a.s;case"//":if(n++,n-1>l&&a.append(t.slice(l),n-l),l=n+1,n<e)switch(o=t[n],o){case"\\":a.expansion(1,"\\");break;case'"':a.expansion(1,'"');break;case"/":a.expansion(1,"/");break;case"b":a.expansion(1,"\b");break;case"f":a.expansion(1,"\f");break;case"n":a.expansion(1,"\n");break;case"r":a.expansion(1,"\r");break;case"t":a.expansion(1,"\t");break;case"u":this._error="parse string/unicord escape not supported"}else this._error="parse string/escape error"}return this._error="parse string/illegal end",null}parseObject(t,e,i,s){if(this._error)return null;const r=new m;let o="",n=i,a="";const l=Array(1);let u=!1;for(;n<e;n++){t:for(;n<e;n++)switch(a=t[n],a){case'"':if(o=this.parseString(t,e,n+1,l),this._error)return null;n=l[0],u=!0;break t;case"}":return s[0]=n+1,r;case":":this._error="illegal ':' position";break;case"\n":this._lineCount++}if(!u)return this._error="key not found",null;u=!1;t:for(;n<e;n++)switch(a=t[n],a){case":":u=!0,n++;break t;case"}":this._error="illegal '}' position";break;case"\n":this._lineCount++}if(!u)return this._error="':' not found",null;const i=this.parseValue(t,e,n,l);if(this._error)return null;n=l[0],r.put(o,i);t:for(;n<e;n++)switch(a=t[n],a){case",":break t;case"}":return s[0]=n+1,r;case"\n":this._lineCount++}}return this._error="illegal end of perseObject",null}parseArray(t,e,i,s){if(this._error)return null;let r,o=new d,n=i;const a=new Array(1);for(;n<e;n++){const i=this.parseValue(t,e,n,a);if(this._error)return null;n=a[0],i&&o.add(i);t:for(;n<e;n++)switch(r=t[n],r){case",":break t;case"]":return s[0]=n+1,o;case"\n":++this._lineCount}}return o=void 0,this._error="illegal end of parseObject",null}}t.CubismJson=i;class s extends e{constructor(t){super(),this._value=t}isFloat(){return!0}getString(t,e){return this._value=parseFloat("\0"),this._stringBuffer="\0",this._stringBuffer}toInt(t=0){return parseInt(this._value.toString())}toFloat(t=0){return this._value}equals(t){return"number"==typeof t&&(!Math.round(t)&&t==this._value)}}t.JsonFloat=s;class r extends e{constructor(t){super(),this._boolValue=t}isBool(){return!0}toBoolean(t=!1){return this._boolValue}getString(t,e){return this._stringBuffer=this._boolValue?"true":"false",this._stringBuffer}equals(t){return"boolean"==typeof t&&t==this._boolValue}isStatic(){return!0}}t.JsonBoolean=r;class o extends e{constructor(t){super(),"string"==typeof t&&(this._stringBuffer=t),t instanceof _&&(this._stringBuffer=t.s)}isString(){return!0}getString(t,e){return this._stringBuffer}equals(t){return"string"==typeof t?this._stringBuffer==t:t instanceof _&&this._stringBuffer==t.s}}t.JsonString=o;class n extends o{constructor(t,e){super(t),this._isStatic=e}isStatic(){return this._isStatic}setErrorNotForClientCall(t){return this._stringBuffer=t,this}isError(){return!0}}t.JsonError=n;class c extends e{isNull(){return!0}getString(t,e){return this._stringBuffer}isStatic(){return!0}constructor(){super(),this._stringBuffer="NullValue"}}t.JsonNullvalue=c;class d extends e{constructor(){super(),this._array=new u}release(){for(let t=this._array.begin();t.notEqual(this._array.end());t.preIncrement()){let e=t.ptr();e&&!e.isStatic()&&(e=void 0,e=null)}}isArray(){return!0}getValueByIndex(t){if(t<0||this._array.getSize()<=t)return e.errorValue.setErrorNotForClientCall("Error: index out of bounds");const i=this._array.at(t);return null==i?e.nullValue:i}getValueByString(t){return e.errorValue.setErrorNotForClientCall("Error: type mismatch")}getString(t,e){const i=e+"[\n";for(let t=this._array.begin();t.notEqual(this._array.end());t.increment()){const i=t.ptr();this._stringBuffer+=e+""+i.getString(e+" ")+"\n"}return this._stringBuffer=i+e+"]\n",this._stringBuffer}add(t){this._array.pushBack(t)}getVector(t=null){return this._array}getSize(){return this._array.getSize()}}t.JsonArray=d;class m extends e{constructor(){super(),this._map=new h}release(){const t=this._map.begin();for(;t.notEqual(this._map.end());){let e=t.ptr().second;e&&!e.isStatic()&&(e=void 0,e=null),t.preIncrement()}}isMap(){return!0}getValueByString(t){if(t instanceof _){const i=this._map.getValue(t.s);return null==i?e.nullValue:i}for(let i=this._map.begin();i.notEqual(this._map.end());i.preIncrement())if(i.ptr().first==t)return null==i.ptr().second?e.nullValue:i.ptr().second;return e.nullValue}getValueByIndex(t){return e.errorValue.setErrorNotForClientCall("Error: type mismatch")}getString(t,e){this._stringBuffer=e+"{\n";const i=this._map.begin();for(;i.notEqual(this._map.end());){const t=i.ptr().first,s=i.ptr().second;this._stringBuffer+=e+" "+t+" : "+s.getString(e+"   ")+" \n",i.preIncrement()}return this._stringBuffer+=e+"}\n",this._stringBuffer}getMap(t){return this._map}put(t,e){this._map.setValue(t,e)}getKeys(){if(!this._keys){this._keys=new u;const t=this._map.begin();for(;t.notEqual(this._map.end());){const e=t.ptr().first;this._keys.pushBack(e),t.preIncrement()}}return this._keys}getSize(){return this._keys.getSize()}}t.JsonMap=m}(s||(s={}))},"./src/LAppLive2DManager_v2.js":function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return a}));var s=i("./src/lib/Live2DFramework.js"),r=i("./src/PlatformManager.js"),o=i("./src/LAppModel_v2.js"),n=i("./src/lappdefine.ts");function a(){this.models=[],this.count=-1,this.reloadFlg=!1,Live2D.init(),s.Live2DFramework.setPlatformManager(new r.default)}a.prototype.createModel=function(){var t=new o.default;return this.models.push(t),t},a.prototype.changeModel=function(t,e){this.reloadFlg&&(this.reloadFlg=!1,this.releaseModel(0,t),this.createModel(),this.models[0].load(t,e))},a.prototype.getModel=function(t){return t>=this.models.length?null:this.models[t]},a.prototype.releaseModel=function(t,e){this.models.length<=t||(this.models[t].release(e),delete this.models[t],this.models.splice(t,1))},a.prototype.numModels=function(){return this.models.length},a.prototype.setDrag=function(t,e){for(var i=0;i<this.models.length;i++)this.models[i].setDrag(t,e)},a.prototype.maxScaleEvent=function(){n.DebugLogEnable&&console.log("Max scale event.");for(var t=0;t<this.models.length;t++)this.models[t].startRandomMotion(n.MotionGroupPinchIn,n.PriorityNormal)},a.prototype.minScaleEvent=function(){n.DebugLogEnable&&console.log("Min scale event.");for(var t=0;t<this.models.length;t++)this.models[t].startRandomMotion(n.MotionGroupPinchOut,n.PriorityNormal)},a.prototype.tapEvent=function(t,e){n.DebugLogEnable&&console.log("tapEvent view x:"+t+" y:"+e);for(var i=0;i<this.models.length;i++)this.models[i].hitTest(n.HitAreaNameHead.toLowerCase(),t,e)?(n.DebugLogEnable&&console.log("Tap face."),this.models[i].setRandomExpression()):this.models[i].hitTest(n.HitAreaNameBody.toLowerCase(),t,e)?(n.DebugLogEnable&&console.log("Tap body. models["+i+"]"),this.models[i].startRandomMotion(n.MOTION_GROUP_TAP_BODY,n.PriorityNormal)):this.models[i].hitTestCustom("head",t,e)?(n.DebugLogEnable&&console.log("Tap face."),this.models[i].startRandomMotion(n.MotionGroupFlickHead,n.PriorityNormal)):this.models[i].hitTestCustom("body",t,e)&&(n.DebugLogEnable&&console.log("Tap body. models["+i+"]"),this.models[i].startRandomMotion(n.MOTION_GROUP_TAP_BODY,n.PriorityNormal));return!0}},"./src/LAppModel_v2.js":function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return n}));var s=i("./src/lib/Live2DFramework.js"),r=i("./src/lib/ModelSettingJson.js"),o=i("./src/lappdefine.ts");function n(){s.L2DBaseModel.prototype.constructor.call(this),this.modelHomeDir="",this.modelSetting=null,this.tmpMatrix=[]}n.prototype=new s.L2DBaseModel,n.prototype.load=function(t,e,i){this.setUpdating(!0),this.setInitialized(!1),this.modelHomeDir=e.substring(0,e.lastIndexOf("/")+1),this.modelSetting=new r.default;var s=this;this.modelSetting.loadModelSetting(e,(function(){var t=s.modelHomeDir+s.modelSetting.getModelFile();s.loadModelData(t,(function(t){for(var e=0;e<s.modelSetting.getTextureNum();e++){let t="";t=/^https?:\/\/|^\/\//i.test(s.modelSetting.getTextureFile(e))?s.modelSetting.getTextureFile(e):s.modelHomeDir+s.modelSetting.getTextureFile(e),s.loadTexture(e,t,(function(){if(s.isTexLoaded){if(s.modelSetting.getExpressionNum()>0){s.expressions={};for(var t=0;t<s.modelSetting.getExpressionNum();t++){var e=s.modelSetting.getExpressionName(t),r=s.modelHomeDir+s.modelSetting.getExpressionFile(t);s.loadExpression(e,r)}}else s.expressionManager=null,s.expressions={};if(s.eyeBlink,null!=s.modelSetting.getPhysicsFile()?s.loadPhysics(s.modelHomeDir+s.modelSetting.getPhysicsFile()):s.physics=null,null!=s.modelSetting.getPoseFile()?s.loadPose(s.modelHomeDir+s.modelSetting.getPoseFile(),(function(){s.pose.updateParam(s.live2DModel)})):s.pose=null,null!=s.modelSetting.getLayout()){var n=s.modelSetting.getLayout();null!=n.width&&s.modelMatrix.setWidth(n.width),null!=n.height&&s.modelMatrix.setHeight(n.height),null!=n.x&&s.modelMatrix.setX(n.x),null!=n.y&&s.modelMatrix.setY(n.y),null!=n.center_x&&s.modelMatrix.centerX(n.center_x),null!=n.center_y&&s.modelMatrix.centerY(n.center_y),null!=n.top&&s.modelMatrix.top(n.top),null!=n.bottom&&s.modelMatrix.bottom(n.bottom),null!=n.left&&s.modelMatrix.left(n.left),null!=n.right&&s.modelMatrix.right(n.right)}if(null!=s.modelSetting.getHitAreasCustom()){var a=s.modelSetting.getHitAreasCustom();null!=a.head_x&&o.setHitAreasCustomHead_x(a.head_x),null!=a.head_y&&o.setHitAreasCustomHead_y(a.head_y),null!=a.body_x&&o.setHitAreasCustomBody_x(a.body_x),null!=a.body_y&&o.setHitAreasCustomBody_y(a.body_y)}for(t=0;t<s.modelSetting.getInitParamNum();t++)s.live2DModel.setParamFloat(s.modelSetting.getInitParamID(t),s.modelSetting.getInitParamValue(t));for(t=0;t<s.modelSetting.getInitPartsVisibleNum();t++)s.live2DModel.setPartsOpacity(s.modelSetting.getInitPartsVisibleID(t),s.modelSetting.getInitPartsVisibleValue(t));s.live2DModel.saveParam(),s.preloadMotionGroup(o.MotionGroupIdle.toLowerCase()),s.preloadMotionGroup(o.MotionGroupSleepy),s.mainMotionManager.stopAllMotions(),s.setUpdating(!1),s.setInitialized(!0),"function"==typeof i&&i()}}))}}))}))},n.prototype.release=function(t){var e=s.Live2DFramework.getPlatformManager();t.deleteTexture(e.texture)},n.prototype.preloadMotionGroup=function(t){for(var e=this,i=0;i<this.modelSetting.getMotionNum(t);i++){var s=this.modelSetting.getMotionFile(t,i);this.loadMotion(s,this.modelHomeDir+s,(function(s){s.setFadeIn(e.modelSetting.getMotionFadeIn(t,i)),s.setFadeOut(e.modelSetting.getMotionFadeOut(t,i))}))}},n.prototype.update=function(){if(null!=this.live2DModel){var t=2*((UtSystem.getUserTimeMSec()-this.startTimeMSec)/1e3)*Math.PI;if(this.mainMotionManager.isFinished())"1"===sessionStorage.getItem("Sleepy")?this.startRandomMotion(o.MotionGroupSleepy,o.PrioritySleepy):this.startRandomMotion(o.MotionGroupIdle.toLowerCase(),o.PriorityIdle);this.live2DModel.loadParam(),this.mainMotionManager.updateParam(this.live2DModel)||null!=this.eyeBlink&&this.eyeBlink.updateParam(this.live2DModel),this.live2DModel.saveParam(),null==this.expressionManager||null==this.expressions||this.expressionManager.isFinished()||this.expressionManager.updateParam(this.live2DModel),this.live2DModel.addToParamFloat("PARAM_ANGLE_X",30*this.dragX,1),this.live2DModel.addToParamFloat("PARAM_ANGLE_Y",30*this.dragY,1),this.live2DModel.addToParamFloat("PARAM_ANGLE_Z",this.dragX*this.dragY*-30,1),this.live2DModel.addToParamFloat("PARAM_BODY_ANGLE_X",10*this.dragX,1),this.live2DModel.addToParamFloat("PARAM_EYE_BALL_X",this.dragX,1),this.live2DModel.addToParamFloat("PARAM_EYE_BALL_Y",this.dragY,1),this.live2DModel.addToParamFloat("PARAM_ANGLE_X",Number(15*Math.sin(t/6.5345)),.5),this.live2DModel.addToParamFloat("PARAM_ANGLE_Y",Number(8*Math.sin(t/3.5345)),.5),this.live2DModel.addToParamFloat("PARAM_ANGLE_Z",Number(10*Math.sin(t/5.5345)),.5),this.live2DModel.addToParamFloat("PARAM_BODY_ANGLE_X",Number(4*Math.sin(t/15.5345)),.5),this.live2DModel.setParamFloat("PARAM_BREATH",Number(.5+.5*Math.sin(t/3.2345)),1),null!=this.physics&&this.physics.updateParam(this.live2DModel),null==this.lipSync&&this.live2DModel.setParamFloat("PARAM_MOUTH_OPEN_Y",this.lipSyncValue),null!=this.pose&&this.pose.updateParam(this.live2DModel),this.live2DModel.update()}else o.DebugLogEnable&&console.error("Failed to update.")},n.prototype.setRandomExpression=function(){var t=[];for(var e in this.expressions)t.push(e);var i=parseInt(Math.random()*t.length);this.setExpression(t[i])},n.prototype.startRandomMotion=function(t,e){var i=this.modelSetting.getMotionNum(t),s=parseInt(Math.random()*i);this.startMotion(t,s,e)},n.prototype.startMotion=function(t,e,i){var s=this.modelSetting.getMotionFile(t,e);if(null!=s&&""!=s){if(i==o.PriorityForce)this.mainMotionManager.setReservePriority(i);else if(!this.mainMotionManager.reserveMotion(i))return void(o.DebugLogEnable&&console.log("Motion is running."));var r,n=this;null==this.motions[t]?this.loadMotion(null,this.modelHomeDir+s,(function(s){r=s,n.setFadeInFadeOut(t,e,i,r)})):(r=this.motions[t],n.setFadeInFadeOut(t,e,i,r))}else o.DebugLogEnable&&console.error("Failed to motion.")},n.prototype.setFadeInFadeOut=function(t,e,i,s){var r=this.modelSetting.getMotionFile(t,e);if(s.setFadeIn(this.modelSetting.getMotionFadeIn(t,e)),s.setFadeOut(this.modelSetting.getMotionFadeOut(t,e)),o.DebugLogEnable&&console.log("Start motion : "+r),null==this.modelSetting.getMotionSound(t,e))this.mainMotionManager.startMotionPrio(s,i);else{var n=this.modelSetting.getMotionSound(t,e),a=document.createElement("audio");a.src=this.modelHomeDir+n,o.DebugLogEnable&&console.log("Start sound : "+n),a.play(),this.mainMotionManager.startMotionPrio(s,i)}},n.prototype.setExpression=function(t){var e=this.expressions[t];o.DebugLogEnable&&console.log("Expression : "+t),this.expressionManager.startMotion(e,!1)},n.prototype.draw=function(t){t.multMatrix(this.modelMatrix.getArray()),this.tmpMatrix=t.getMatrix(),this.live2DModel.setMatrix(this.tmpMatrix),this.live2DModel.draw()},n.prototype.hitTest=function(t,e,i){for(var s=this.modelSetting.getHitAreaNum(),r=0;r<s;r++)if(t==this.modelSetting.getHitAreaName(r)){var o=this.modelSetting.getHitAreaID(r);return this.hitTestSimple(o,e,i)}return!1},n.prototype.hitTestCustom=function(t,e,i){return"head"==t?this.hitTestSimpleCustom(o.getHitAreasCustomHead_x(),o.getHitAreasCustomHead_y(),e,i):"body"==t&&this.hitTestSimpleCustom(o.getHitAreasCustomBody_x(),o.getHitAreasCustomBody_y(),e,i)}},"./src/PlatformManager.js":function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return o}));var s=i("./src/lappdefine.ts"),r=i("./src/Framework/utils/cubismjson.ts");function o(){}var n={};o.prototype.loadBytes=function(t,e){if(void 0===n[t]){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){switch(i.status){case 200:n[t]=i.response,e(i.response);break;default:console.error("Failed to load ("+i.status+") : "+t)}},i.send(null)}else e(n[t])},o.prototype.loadString=function(t,e){this.loadBytes(t,(function(t){let i=(new r.Live2DCubismFramework.CubismJson).arrayBufferToString(t);e(i)}))},o.prototype.loadLive2DModel=function(t,e){var i=null;this.loadBytes(t,(function(t){i=Live2DModelWebGL.loadModel(t),e(i)}))},o.prototype.loadTexture=function(t,e,i,r){var o=new Image;o.crossOrigin="Anonymous",o.src=i;o.onload=function(){var i=Object(s.getContext)(),n=i.createTexture();if(!n)return console.error("Failed to generate gl texture name."),-1;0==t.isPremultipliedAlpha()&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST),i.generateMipmap(i.TEXTURE_2D),t.setTexture(e,n),n=null,"function"==typeof r&&r()},o.onerror=function(){console.error("Failed to load image : "+i)}},o.prototype.jsonParseFromBytes=function(t){var e,i=new Uint8Array(t,0,3);return e=239==i[0]&&187==i[1]&&191==i[2]?String.fromCharCode.apply(null,new Uint8Array(t,3)):String.fromCharCode.apply(null,new Uint8Array(t)),JSON.parse(e)},o.prototype.log=function(t){}},"./src/lappdefine.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"ViewMaxScale",(function(){return r})),i.d(e,"ViewMinScale",(function(){return o})),i.d(e,"ViewLogicalLeft",(function(){return n})),i.d(e,"ViewLogicalRight",(function(){return a})),i.d(e,"ViewLogicalMaxLeft",(function(){return l})),i.d(e,"ViewLogicalMaxRight",(function(){return u})),i.d(e,"ViewLogicalMaxBottom",(function(){return h})),i.d(e,"ViewLogicalMaxTop",(function(){return _})),i.d(e,"MotionGroupIdle",(function(){return c})),i.d(e,"MotionGroupTapBody",(function(){return d})),i.d(e,"MotionGroupSleepy",(function(){return m})),i.d(e,"MotionGroupFlickHead",(function(){return p})),i.d(e,"MOTION_GROUP_TAP_BODY",(function(){return g})),i.d(e,"MotionGroupPinchIn",(function(){return f})),i.d(e,"MotionGroupPinchOut",(function(){return y})),i.d(e,"MotionGroupShake",(function(){return $})),i.d(e,"HitAreaNameHead",(function(){return S})),i.d(e,"HitAreaNameBody",(function(){return v})),i.d(e,"PriorityNone",(function(){return x})),i.d(e,"PriorityIdle",(function(){return b})),i.d(e,"PrioritySleepy",(function(){return P})),i.d(e,"PriorityNormal",(function(){return w})),i.d(e,"PriorityForce",(function(){return L})),i.d(e,"DebugLogEnable",(function(){return T})),i.d(e,"DebugTouchLogEnable",(function(){return M})),i.d(e,"DebugDrawHitArea",(function(){return C})),i.d(e,"DebugDrawAlphaModel",(function(){return F})),i.d(e,"CubismLoggingLevel",(function(){return I})),i.d(e,"setContext",(function(){return j})),i.d(e,"getContext",(function(){return V})),i.d(e,"setHitAreasCustomHead_x",(function(){return O})),i.d(e,"getHitAreasCustomHead_x",(function(){return N})),i.d(e,"setHitAreasCustomHead_y",(function(){return U})),i.d(e,"getHitAreasCustomHead_y",(function(){return z})),i.d(e,"setHitAreasCustomBody_x",(function(){return G})),i.d(e,"getHitAreasCustomBody_x",(function(){return Y})),i.d(e,"setHitAreasCustomBody_y",(function(){return X})),i.d(e,"getHitAreasCustomBody_y",(function(){return H})),i.d(e,"setJsonPath",(function(){return q})),i.d(e,"getJsonPath",(function(){return W}));var s=i("./src/Framework/live2dcubismframework.ts");const r=2,o=.8,n=-1,a=1,l=-2,u=2,h=-2,_=2,c="Idle",d="TapBody",m="sleepy",p="flick_head",g="tap_body",f="pinch_in",y="pinch_out",$="shake",S="Head",v="Body",x=0,b=1,P=2,w=2,L=3,T=!0,M=!0,C=!0,F=!0,I=s.LogLevel.LogLevel_Verbose;let E=void 0,D=void 0,B=void 0,A=void 0,R=void 0,k="";function j(t){E=t}function V(){return E}function O(t){D=t}function N(){return D}function U(t){B=t}function z(){return B}function G(t){A=t}function Y(){return A}function X(t){R=t}function H(){return R}function q(t){k=t}function W(){return k}},"./src/lappdelegate.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"canvas",(function(){return h})),i.d(e,"s_instance",(function(){return _})),i.d(e,"gl",(function(){return c})),i.d(e,"frameBuffer",(function(){return d})),i.d(e,"_jsonPath",(function(){return m})),i.d(e,"LAppDelegate",(function(){return p}));var s=i("./src/Framework/live2dcubismframework.ts"),r=i("./src/lappview.ts"),o=i("./src/lapppal.ts"),n=i("./src/lapptexturemanager.ts"),a=i("./src/lapplive2dmanager.ts"),l=i("./src/lappdefine.ts"),u=s.Live2DCubismFramework.CubismFramework;let h=null,_=null,c=null,d=null,m=null;class p{constructor(){this._captured=!1,this._captureFrame=!1,this._mouseX=0,this._mouseY=0,this._isEnd=!1,this._cubismOption=new s.Option,this._view=new r.LAppView,this._textureManager=new n.LAppTextureManager,this._magnification=2,this._head_pos=.5}static getInstance(){return null==_&&(_=new p),_}static releaseInstance(){null!=_&&_.release(),_=null}initialize(t){return m=t,c=function(t){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=0;i<e.length;i++)try{var s=t.getContext(e[i],{premultipliedAlpha:!0});if(s)return s}catch(t){}return null}(h),c?(d||(d=c.getParameter(c.FRAMEBUFFER_BINDING)),c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),this._view.initialize(),this.initializeCubism(),!0):(alert("Cannot initialize WebGL. This browser does not support."),c=null,document.body.innerHTML="This browser does not support the <code>&lt;canvas&gt;</code> element.",!1)}release(){this._textureManager.release(),this._textureManager=null,this._view.release(),this._view=null,a.LAppLive2DManager.releaseInstance(),u.dispose()}run(){const t=()=>{if(null!=_){if(o.LAppPal.updateTime(),c.clearColor(0,0,0,0),c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),c.clearDepth(1),c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),this._view._magnification=this._magnification,this._view._head_pos=this._head_pos,this._view.render(),this._captureFrame){this._captureFrame=!1;var e=document.createElement("a");document.body.appendChild(e),e.setAttribute("type","hidden"),e.href=h.toDataURL(),e.download=this._captureName||"live2d.png",e.click()}requestAnimationFrame(t)}};t()}createShader(){const t=c.createShader(c.VERTEX_SHADER);if(null==t)return o.LAppPal.printMessage("failed to create vertexShader"),null;c.shaderSource(t,"precision mediump float;attribute vec3 position;attribute vec2 uv;varying vec2 vuv;void main(void){   gl_Position = vec4(position, 1.0);   vuv = uv;}"),c.compileShader(t);const e=c.createShader(c.FRAGMENT_SHADER);if(null==e)return o.LAppPal.printMessage("failed to create fragmentShader"),null;c.shaderSource(e,"precision mediump float;varying vec2 vuv;uniform sampler2D texture;void main(void){   gl_FragColor = texture2D(texture, vuv);}"),c.compileShader(e);const i=c.createProgram();return c.attachShader(i,t),c.attachShader(i,e),c.deleteShader(t),c.deleteShader(e),c.linkProgram(i),c.useProgram(i),i}getView(){return this._view}getTextureManager(){return this._textureManager}initializeCubism(){this._cubismOption.logFunction=o.LAppPal.printMessage,this._cubismOption.loggingLevel=l.CubismLoggingLevel,u.startUp(this._cubismOption),u.initialize(),l.setJsonPath(m),a.LAppLive2DManager.getInstance(),o.LAppPal.updateTime(),this._view.initializeSprite()}initL2dCanvas(t){h=document.getElementById(t);"ontouchend"in h?(h.ontouchstart=$,window.ontouchmove=S,h.ontouchend=v,h.ontouchcancel=x):(h.onmousedown=g,window.onmousemove=f,h.onmouseup=y,document.onmouseleave=b)}}function g(t){if(!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");p.getInstance()._captured=!0;const e=t.pageX,i=t.pageY;p.getInstance()._view.onTouchesBegan(e,i)}function f(t){if(!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");const e=h.getBoundingClientRect();p.getInstance()._view.onTouchesMoved(t.clientX,t.clientY,e)}function y(t){if(p.getInstance()._captured=!1,!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.clientX-e.left,s=t.clientY-e.top;p.getInstance()._view.onTouchesEnded(i,s)}function $(t){if(!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");p.getInstance()._captured=!0;const e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY;p.getInstance()._view.onTouchesBegan(e,i)}function S(t){if(!p.getInstance()._captured)return;if(!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY;p.getInstance()._view.onTouchesMoved(i,s,e)}function v(t){if(p.getInstance()._captured=!1,!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.changedTouches[0].clientX-e.left,s=t.changedTouches[0].clientY-e.top;p.getInstance()._view.onTouchesEnded(i,s)}function x(t){if(p.getInstance()._captured=!1,!p.getInstance()._view)return void o.LAppPal.printMessage("view notfound");const e=t.target.getBoundingClientRect(),i=t.changedTouches[0].clientX-e.left,s=t.changedTouches[0].clientY-e.top;p.getInstance()._view.onTouchesEnded(i,s)}function b(t){p.getInstance()._captured=!1,p.getInstance()._view?p.getInstance()._view.onTouchesEnded(0,0):o.LAppPal.printMessage("view notfound")}},"./src/lapplive2dmanager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"s_instance",(function(){return u})),i.d(e,"LAppLive2DManager",(function(){return h}));var s=i("./src/Framework/math/cubismmatrix44.ts"),r=i("./src/lappmodel.ts"),o=i("./src/lapppal.ts"),n=i("./src/lappdelegate.ts"),a=i("./src/lappdefine.ts"),l=s.Live2DCubismFramework.CubismMatrix44;let u=null;class h{constructor(t=a.getJsonPath()){this._finishedMotion=t=>{o.LAppPal.printMessage("Motion Finished:"),console.log(t)};const e=t,i=e.substring(0,e.lastIndexOf("/")+1);if(this._viewMatrix=new l,this._model=new r.LAppModel,e.indexOf("model3.json")>0){const t=e.substring(e.lastIndexOf("/")+1);this._model.loadAssets(i,t)}else this._model.loadUrlAssets(i,e)}static getInstance(){return null==u&&(u=new h),u}static releaseInstance(){null!=u&&(u=void 0),u=null}releaseAllModel(){this._model.release()}onDrag(t,e){this._model&&this._model.setDragging(t,e)}onTap(t,e){a.DebugLogEnable&&o.LAppPal.printMessage(`[APP]tap point: {x: ${t.toFixed(2)} y: ${e.toFixed(2)}}`),this._model.hitTest(a.HitAreaNameHead,t,e)?(a.DebugLogEnable&&o.LAppPal.printMessage(`[APP]hit area: [${a.HitAreaNameHead}]`),this._model.setRandomExpression()):this._model.hitTest(a.HitAreaNameBody,t,e)&&(a.DebugLogEnable&&o.LAppPal.printMessage(`[APP]hit area: [${a.HitAreaNameBody}]`),this._model.startRandomMotion(a.MotionGroupTapBody,a.PriorityNormal,this._finishedMotion))}onUpdate(t=2){let e=new l;const{width:i,height:s}=n.canvas;e.scale(t,t*i/s),null!=this._viewMatrix&&e.multiplyByMatrix(this._viewMatrix);const r=e.clone(),o=this._model;e=r.clone(),o.update(),o.draw(e)}}},"./src/lappmodel.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"LAppModel",(function(){return M}));var s,r=i("./src/Framework/live2dcubismframework.ts"),o=i("./src/Framework/model/cubismusermodel.ts"),n=i("./src/Framework/cubismmodelsettingjson.ts"),a=i("./src/Framework/cubismdefaultparameterid.ts"),l=i("./src/Framework/motion/acubismmotion.ts"),u=i("./src/Framework/effect/cubismeyeblink.ts"),h=i("./src/Framework/effect/cubismbreath.ts"),_=i("./src/Framework/type/csmvector.ts"),c=i("./src/Framework/type/csmmap.ts"),d=i("./src/Framework/motion/cubismmotionqueuemanager.ts"),m=i("./src/lapppal.ts"),p=i("./src/lappdelegate.ts"),g=i("./src/lappdefine.ts"),f=(i("./node_modules/whatwg-fetch/fetch.js"),d.Live2DCubismFramework.InvalidMotionQueueEntryHandleValue),y=c.Live2DCubismFramework.csmMap,$=_.Live2DCubismFramework.csmVector,S=h.Live2DCubismFramework.CubismBreath,v=h.Live2DCubismFramework.BreathParameterData,x=u.Live2DCubismFramework.CubismEyeBlink,b=l.Live2DCubismFramework.ACubismMotion,P=r.Live2DCubismFramework.CubismFramework,w=o.Live2DCubismFramework.CubismUserModel,L=n.Live2DCubismFramework.CubismModelSettingJson,T=a.Live2DCubismFramework;!function(t){t[t.LoadAssets=0]="LoadAssets",t[t.LoadModel=1]="LoadModel",t[t.WaitLoadModel=2]="WaitLoadModel",t[t.LoadExpression=3]="LoadExpression",t[t.WaitLoadExpression=4]="WaitLoadExpression",t[t.LoadPhysics=5]="LoadPhysics",t[t.WaitLoadPhysics=6]="WaitLoadPhysics",t[t.LoadPose=7]="LoadPose",t[t.WaitLoadPose=8]="WaitLoadPose",t[t.SetupEyeBlink=9]="SetupEyeBlink",t[t.SetupBreath=10]="SetupBreath",t[t.LoadUserData=11]="LoadUserData",t[t.WaitLoadUserData=12]="WaitLoadUserData",t[t.SetupEyeBlinkIds=13]="SetupEyeBlinkIds",t[t.SetupLipSyncIds=14]="SetupLipSyncIds",t[t.SetupLayout=15]="SetupLayout",t[t.LoadMotion=16]="LoadMotion",t[t.WaitLoadMotion=17]="WaitLoadMotion",t[t.CompleteInitialize=18]="CompleteInitialize",t[t.CompleteSetupModel=19]="CompleteSetupModel",t[t.LoadTexture=20]="LoadTexture",t[t.WaitLoadTexture=21]="WaitLoadTexture",t[t.CompleteSetup=22]="CompleteSetup"}(s||(s={}));class M extends w{constructor(){super(),this._modelSetting=null,this._modelHomeDir=null,this._userTimeSeconds=0,this._eyeBlinkIds=new $,this._lipSyncIds=new $,this._motions=new y,this._expressions=new y,this._hitArea=new $,this._userArea=new $,this._idParamAngleX=P.getIdManager().getId(T.ParamAngleX),this._idParamAngleY=P.getIdManager().getId(T.ParamAngleY),this._idParamAngleZ=P.getIdManager().getId(T.ParamAngleZ),this._idParamEyeBallX=P.getIdManager().getId(T.ParamEyeBallX),this._idParamEyeBallY=P.getIdManager().getId(T.ParamEyeBallY),this._idParamBodyAngleX=P.getIdManager().getId(T.ParamBodyAngleX),this._state=s.LoadAssets,this._expressionCount=0,this._textureCount=0,this._motionCount=0,this._allMotionCount=0}loadAssets(t,e){this._modelHomeDir=t,fetch(`${this._modelHomeDir}/${e}`).then(t=>t.arrayBuffer()).then(t=>{const e=new L(t,t.byteLength);this._state=s.LoadModel,this.setupModel(e)})}loadUrlAssets(t,e){this._modelHomeDir=t,fetch(""+e).then(t=>t.arrayBuffer()).then(t=>{const e=new L(t,t.byteLength);this._state=s.LoadModel,this.setupModel(e)})}setupModel(t){if(this._updating=!0,this._initialized=!1,this._modelSetting=t,""!=this._modelSetting.getModelFileName()){const t=this._modelSetting.getModelFileName();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadModel(t),this._state=s.LoadExpression,e()}),this._state=s.WaitLoadModel}else m.LAppPal.printMessage("Model data does not exist.");const e=()=>{if(this._modelSetting.getExpressionCount()>0){const t=this._modelSetting.getExpressionCount();for(let e=0;e<t;e++){const r=this._modelSetting.getExpressionName(e),o=this._modelSetting.getExpressionFileName(e);fetch(`${this._modelHomeDir}/${o}`).then(t=>t.arrayBuffer()).then(e=>{const o=this.loadExpression(e,e.byteLength,r);null!=this._expressions.getValue(r)&&(b.delete(this._expressions.getValue(r)),this._expressions.setValue(r,null)),this._expressions.setValue(r,o),this._expressionCount++,this._expressionCount>=t&&(this._state=s.LoadPhysics,i())})}this._state=s.WaitLoadExpression}else this._state=s.LoadPhysics,i()},i=()=>{if(""!=this._modelSetting.getPhysicsFileName()){const t=this._modelSetting.getPhysicsFileName();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadPhysics(t,t.byteLength),this._state=s.LoadPose,r()}),this._state=s.WaitLoadPhysics}else this._state=s.LoadPose,r()},r=()=>{if(""!=this._modelSetting.getPoseFileName()){const t=this._modelSetting.getPoseFileName();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadPose(t,t.byteLength),this._state=s.SetupEyeBlink,o()}),this._state=s.WaitLoadPose}else this._state=s.SetupEyeBlink,o()},o=()=>{this._modelSetting.getEyeBlinkParameterCount()>0&&(this._eyeBlink=x.create(this._modelSetting),this._state=s.SetupBreath),n()},n=()=>{this._breath=S.create();const t=new $;t.pushBack(new v(this._idParamAngleX,0,15,6.5345,.5)),t.pushBack(new v(this._idParamAngleY,0,8,3.5345,.5)),t.pushBack(new v(this._idParamAngleZ,0,10,5.5345,.5)),t.pushBack(new v(this._idParamBodyAngleX,0,4,15.5345,.5)),t.pushBack(new v(P.getIdManager().getId(T.ParamBreath),0,.5,3.2345,.5)),this._breath.setParameters(t),this._state=s.LoadUserData,a()},a=()=>{if(""!=this._modelSetting.getUserDataFile()){const t=this._modelSetting.getUserDataFile();fetch(`${this._modelHomeDir}/${t}`).then(t=>t.arrayBuffer()).then(t=>{this.loadUserData(t,t.byteLength),this._state=s.SetupEyeBlinkIds,l()}),this._state=s.WaitLoadUserData}else this._state=s.SetupEyeBlinkIds,l()},l=()=>{const t=this._modelSetting.getEyeBlinkParameterCount();for(let e=0;e<t;++e)this._eyeBlinkIds.pushBack(this._modelSetting.getEyeBlinkParameterId(e));this._state=s.SetupLipSyncIds,u()},u=()=>{const t=this._modelSetting.getLipSyncParameterCount();for(let e=0;e<t;++e)this._lipSyncIds.pushBack(this._modelSetting.getLipSyncParameterId(e));this._state=s.SetupLayout,h()},h=()=>{const t=new y;this._modelSetting.getLayoutMap(t),this._modelMatrix.setupFromLayout(t),this._state=s.LoadMotion,_()},_=()=>{this._state=s.WaitLoadMotion,this._model.saveParameters(),this._allMotionCount=0,this._motionCount=0;const t=[],e=this._modelSetting.getMotionGroupCount();for(let i=0;i<e;i++)t[i]=this._modelSetting.getMotionGroupName(i),this._allMotionCount+=this._modelSetting.getMotionCount(t[i]);for(let i=0;i<e;i++)this.preLoadMotionGroup(t[i]);0==e&&(this._state=s.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(p.gl))}}setupTextures(){if(this._state==s.LoadTexture){const t=this._modelSetting.getTextureCount();for(let e=0;e<t;e++){if(""==this._modelSetting.getTextureFileName(e)){console.log("getTextureFileName null");continue}let i=this._modelSetting.getTextureFileName(e);i=this._modelHomeDir+i;const r=i=>{this.getRenderer().bindTexture(e,i.id),this._textureCount++,this._textureCount>=t&&(this._state=s.CompleteSetup)};p.LAppDelegate.getInstance().getTextureManager().createTextureFromPngFile(i,!0,r),this.getRenderer().setIsPremultipliedAlpha(!0)}this._state=s.WaitLoadTexture}}reloadRenderer(){this.deleteRenderer(),this.createRenderer(),this.setupTextures()}update(){if(this._state!=s.CompleteSetup)return;const t=m.LAppPal.getDeltaTime();this._userTimeSeconds+=t,this._dragManager.update(t),this._dragX=this._dragManager.getX(),this._dragY=this._dragManager.getY();let e=!1;if(this._model.loadParameters(),this._motionManager.isFinished()?this.startRandomMotion(g.MotionGroupIdle,g.PriorityIdle):e=this._motionManager.updateMotion(this._model,t),this._model.saveParameters(),e||null!=this._eyeBlink&&this._eyeBlink.updateParameters(this._model,t),null!=this._expressionManager&&this._expressionManager.updateMotion(this._model,t),this._model.addParameterValueById(this._idParamAngleX,30*this._dragX),this._model.addParameterValueById(this._idParamAngleY,30*this._dragY),this._model.addParameterValueById(this._idParamAngleZ,this._dragX*this._dragY*-30),this._model.addParameterValueById(this._idParamBodyAngleX,10*this._dragX),this._model.addParameterValueById(this._idParamEyeBallX,this._dragX),this._model.addParameterValueById(this._idParamEyeBallY,this._dragY),null!=this._breath&&this._breath.updateParameters(this._model,t),null!=this._physics&&this._physics.evaluate(this._model,t),this._lipsync){const t=0;for(let e=0;e<this._lipSyncIds.getSize();++e)this._model.addParameterValueById(this._lipSyncIds.at(e),t,.8)}null!=this._pose&&this._pose.updateParameters(this._model,t),this._model.update()}startMotion(t,e,i,s){if(i==g.PriorityForce)this._motionManager.setReservePriority(i);else if(!this._motionManager.reserveMotion(i))return this._debugMode&&m.LAppPal.printMessage("[APP]can't start motion."),f;const r=this._modelSetting.getMotionFileName(t,e),o=`${t}_${e}`;let n=this._motions.getValue(o),a=!1;return null==n?fetch(`${this._modelHomeDir}/${r}`).then(t=>t.arrayBuffer()).then(i=>{n=this.loadMotion(i,i.byteLength,null,s);let r=this._modelSetting.getMotionFadeInTimeValue(t,e);r>=0&&n.setFadeInTime(r),r=this._modelSetting.getMotionFadeOutTimeValue(t,e),r>=0&&n.setFadeOutTime(r),n.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),a=!0}):n.setFinishedMotionHandler(s),this._debugMode&&m.LAppPal.printMessage(`[APP]start motion: [${t}_${e}`),this._motionManager.startMotionPriority(n,a,i)}startRandomMotion(t,e,i){if(0==this._modelSetting.getMotionCount(t))return f;const s=Math.floor(Math.random()*this._modelSetting.getMotionCount(t));return this.startMotion(t,s,e,i)}setExpression(t){const e=this._expressions.getValue(t);this._debugMode&&m.LAppPal.printMessage(`[APP]expression: [${t}]`),null!=e?this._expressionManager.startMotionPriority(e,!1,g.PriorityForce):this._debugMode&&m.LAppPal.printMessage(`[APP]expression[${t}] is null`)}setRandomExpression(){if(0==this._expressions.getSize())return;const t=Math.floor(Math.random()*this._expressions.getSize());for(let e=0;e<this._expressions.getSize();e++)if(e==t){const t=this._expressions._keyValues[e].first;return void this.setExpression(t)}}motionEventFired(t){}hitTest(t,e,i){if(this._opacity<1)return!1;try{const s=this._modelSetting.getHitAreasCount();for(let r=0;r<s;r++)if(this._modelSetting.getHitAreaName(r)==t){const t=this._modelSetting.getHitAreaId(r);return this.isHit(t,e,i)}}catch(t){console.log("数据可能还没有准备好"+t)}return!1}preLoadMotionGroup(t){for(let e=0;e<this._modelSetting.getMotionCount(t);e++){const i=this._modelSetting.getMotionFileName(t,e),r=`${t}_${e}`;this._debugMode&&m.LAppPal.printMessage(`[APP]load motion: ${i} => [${r}]`),fetch(`${this._modelHomeDir}/${i}`).then(t=>t.arrayBuffer()).then(i=>{const o=this.loadMotion(i,i.byteLength,r);let n=this._modelSetting.getMotionFadeInTimeValue(t,e);n>=0&&o.setFadeInTime(n),n=this._modelSetting.getMotionFadeOutTimeValue(t,e),n>=0&&o.setFadeOutTime(n),o.setEffectIds(this._eyeBlinkIds,this._lipSyncIds),null!=this._motions.getValue(r)&&b.delete(this._motions.getValue(r)),this._motions.setValue(r,o),this._motionCount++,this._motionCount>=this._allMotionCount&&(this._state=s.LoadTexture,this._motionManager.stopAllMotions(),this._updating=!1,this._initialized=!0,this.createRenderer(),this.setupTextures(),this.getRenderer().startUp(p.gl))})}}releaseMotions(){this._motions.clear()}releaseExpressions(){this._expressions.clear()}doDraw(){if(null==this._model)return;const t=[0,0,p.canvas.width,p.canvas.height];this.getRenderer().setRenderState(p.frameBuffer,t),this.getRenderer().drawModel()}draw(t){null!=this._model&&this._state==s.CompleteSetup&&(t.multiplyByMatrix(this._modelMatrix),this.getRenderer().setMvpMatrix(t),this.doDraw())}}},"./src/lapppal.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"LAppPal",(function(){return s}));class s{static loadFileAsBytes(t,e){fetch(t).then(t=>t.arrayBuffer()).then(t=>e(t,t.byteLength))}static getDeltaTime(){return this.s_deltaTime}static updateTime(){this.s_currentFrame=Date.now(),this.s_deltaTime=(this.s_currentFrame-this.s_lastFrame)/1e3,this.s_lastFrame=this.s_currentFrame}static printMessage(t){console.log(t)}static modelUrlVersion(t){let e=null;fetch(t,{mode:"cors",method:"GET"}).then((function(t){200===t.status&&(e=t.arrayBuffer)}));JSON.stringify(e);return 2}}s.lastUpdate=Date.now(),s.s_currentFrame=0,s.s_lastFrame=0,s.s_deltaTime=0},"./src/lapptexturemanager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"LAppTextureManager",(function(){return n})),i.d(e,"TextureInfo",(function(){return a}));var s=i("./src/Framework/type/csmvector.ts"),r=i("./src/lappdelegate.ts"),o=s.Live2DCubismFramework.csmVector;class n{constructor(){this._textures=new o}release(){for(let t=this._textures.begin();t.notEqual(this._textures.end());t.preIncrement())r.gl.deleteTexture(t.ptr().id);this._textures=null}createTextureFromPngFile(t,e,i){for(let s=this._textures.begin();s.notEqual(this._textures.end());s.preIncrement())if(s.ptr().fileName==t&&s.ptr().usePremultply==e)return s.ptr().img=new Image,s.ptr().img.crossOrigin="Anonymous",s.ptr().img.onload=()=>i(s.ptr()),void(s.ptr().img.src=t);const s=new Image;s.crossOrigin="Anonymous",s.onload=()=>{const o=r.gl.createTexture();r.gl.bindTexture(r.gl.TEXTURE_2D,o),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_MIN_FILTER,r.gl.LINEAR_MIPMAP_LINEAR),r.gl.texParameteri(r.gl.TEXTURE_2D,r.gl.TEXTURE_MAG_FILTER,r.gl.LINEAR),e&&r.gl.pixelStorei(r.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),r.gl.texImage2D(r.gl.TEXTURE_2D,0,r.gl.RGBA,r.gl.RGBA,r.gl.UNSIGNED_BYTE,s),r.gl.generateMipmap(r.gl.TEXTURE_2D),r.gl.bindTexture(r.gl.TEXTURE_2D,null);const n=new a;null!=n&&(n.fileName=t,n.width=s.width,n.height=s.height,n.id=o,n.img=s,n.usePremultply=e,this._textures.pushBack(n)),i(n)},s.src=t}releaseTextures(){for(let t=0;t<this._textures.getSize();t++)this._textures.set(t,null);this._textures.clear()}releaseTextureByTexture(t){for(let e=0;e<this._textures.getSize();e++)if(this._textures.at(e).id==t){this._textures.set(e,null),this._textures.remove(e);break}}releaseTextureByFilePath(t){for(let e=0;e<this._textures.getSize();e++)if(this._textures.at(e).fileName==t){this._textures.set(e,null),this._textures.remove(e);break}}}class a{constructor(){this.id=null,this.width=0,this.height=0}}},"./src/lappview.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"_jsonPath",(function(){return c})),i.d(e,"LAppView",(function(){return d}));var s=i("./src/Framework/math/cubismmatrix44.ts"),r=i("./src/Framework/math/cubismviewmatrix.ts"),o=i("./src/touchmanager.ts"),n=i("./src/lapplive2dmanager.ts"),a=i("./src/lappdelegate.ts"),l=i("./src/lapppal.ts"),u=i("./src/lappdefine.ts"),h=r.Live2DCubismFramework.CubismViewMatrix,_=s.Live2DCubismFramework.CubismMatrix44;let c=null;class d{constructor(){this._programId=null,this._back=null,this._gear=null,this._touchManager=new o.TouchManager,this._deviceToScreen=new _,this._viewMatrix=new h,this._magnification=2,this._head_pos=.5}initialize(){const{width:t,height:e}=a.canvas,i=e/t,s=u.ViewLogicalLeft,r=u.ViewLogicalRight,o=-i,n=i;this._viewMatrix.setScreenRect(s,r,o,n);const l=Math.abs(s-r);this._deviceToScreen.scaleRelative(l/t,-l/t),this._deviceToScreen.translateRelative(.5*-t,.5*-e),this._viewMatrix.setMaxScale(u.ViewMaxScale),this._viewMatrix.setMinScale(u.ViewMinScale),this._viewMatrix.setMaxScreenRect(u.ViewLogicalMaxLeft,u.ViewLogicalMaxRight,u.ViewLogicalMaxBottom,u.ViewLogicalMaxTop)}release(){this._viewMatrix=null,this._touchManager=null,this._deviceToScreen=null,this._gear&&(this._gear.release(),this._gear=null),this._back&&(this._back.release(),this._back=null),a.gl.deleteProgram(this._programId),this._programId=null}render(){a.gl.useProgram(this._programId),this._back&&this._back.render(this._programId),this._gear&&this._gear.render(this._programId),a.gl.flush();n.LAppLive2DManager.getInstance().onUpdate(this._magnification)}initializeSprite(){null==this._programId&&(this._programId=a.LAppDelegate.getInstance().createShader())}onTouchesBegan(t,e){this._touchManager.touchesBegan(t,e)}onTouchesMoved(t,e,i){const s=this.transformScreenX(t-i.left),r=this.transformScreenY(e-i.top),o=this.transformRect({x:i.left+i.width/2,y:i.top+i.height*this._head_pos},{x:t,y:e},i),a=this.transformViewX(o.x-i.left),l=this.transformViewY(o.y-i.top);this._touchManager.touchesMoved(s,r);n.LAppLive2DManager.getInstance().onDrag(a,l)}onTouchesEnded(t,e){const i=n.LAppLive2DManager.getInstance();i.onDrag(0,0);{const t=this._deviceToScreen.transformX(this._touchManager.getX()),e=this._deviceToScreen.transformY(this._touchManager.getY());u.DebugTouchLogEnable&&l.LAppPal.printMessage(`[APP]touchesEnded x: ${t} y: ${e}`),i.onTap(t,e)}}transformViewX(t){const e=this._deviceToScreen.transformX(t);return this._viewMatrix.invertTransformX(e)}transformViewY(t){const e=this._deviceToScreen.transformY(t);return this._viewMatrix.invertTransformY(e)}transformScreenX(t){return this._deviceToScreen.transformX(t)}transformScreenY(t){return this._deviceToScreen.transformY(t)}transformRect(t,e,i){if(e.x<i.left+i.width&&e.y<i.top+i.height&&e.x>i.left&&e.y>i.top)return e;let s=t.x-e.x,r=t.y-e.y;function o(t,e){return 180*Math.acos(d.dot({x:0,y:1},d.normalize(t,e)))/Math.PI}let n=o(s,r);e.x<t.x&&(n=360-n);let a=360-o(i.left-t.x,-1*(i.top-t.y)),l=360-o(i.left-t.x,-1*(i.top+i.height-t.y)),u=o(i.left+i.width-t.x,-1*(i.top-t.y)),h=o(i.left+i.width-t.x,-1*(i.top+i.height-t.y)),_=r/s,c={};if(n<u){let e=i.top-t.y,s=e/_;c={y:t.y+e,x:t.x+s}}else if(n<h){let e=i.left+i.width-t.x,s=e*_;c={y:t.y+s,x:t.x+e}}else if(n<l){let e=i.top+i.height-t.y,s=e/_;c={y:t.y+e,x:t.x+s}}else if(n<a){let e=t.x-i.left,s=e*_;c={y:t.y-s,x:t.x-e}}else{let e=i.top-t.y,s=e/_;c={y:t.y+e,x:t.x+s}}return c}transformRange(t,e,i){let s={x:e.x-t.x,y:e.y-t.y},r=Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2));return r>i?(s={x:s.x/r*i+t.x,y:s.y/r*i+t.y},s):e}static dot(t,e){return t.x*e.x+t.y*e.y}static normalize(t,e){let i=Math.sqrt(t*t+e*e);return{x:t/i,y:e/i}}}},"./src/lib/Live2DFramework.js":function(t,e){function i(){this.live2DModel=null,this.modelMatrix=null,this.eyeBlink=null,this.physics=null,this.pose=null,this.debugMode=!1,this.initialized=!1,this.updating=!1,this.alpha=1,this.accAlpha=0,this.lipSync=!1,this.lipSyncValue=0,this.accelX=0,this.accelY=0,this.accelZ=0,this.dragX=0,this.dragY=0,this.startTimeMSec=null,this.mainMotionManager=new h,this.expressionManager=new h,this.motions={},this.expressions={},this.isTexLoaded=!1}var s=0;function r(){AMotion.prototype.constructor.call(this),this.paramList=new Array}function o(){this.id="",this.type=-1,this.value=null}function n(){this.nextBlinkTime=null,this.stateStartTime=null,this.blinkIntervalMsec=null,this.eyeState=a.STATE_FIRST,this.blinkIntervalMsec=4e3,this.closingMotionMsec=100,this.closedMotionMsec=50,this.openingMotionMsec=150,this.closeIfZero=!0,this.eyeID_L="PARAM_EYE_L_OPEN",this.eyeID_R="PARAM_EYE_R_OPEN"}i.prototype.getModelMatrix=function(){return this.modelMatrix},i.prototype.setAlpha=function(t){t>.999&&(t=1),t<.001&&(t=0),this.alpha=t},i.prototype.getAlpha=function(){return this.alpha},i.prototype.isInitialized=function(){return this.initialized},i.prototype.setInitialized=function(t){this.initialized=t},i.prototype.isUpdating=function(){return this.updating},i.prototype.setUpdating=function(t){this.updating=t},i.prototype.getLive2DModel=function(){return this.live2DModel},i.prototype.setLipSync=function(t){this.lipSync=t},i.prototype.setLipSyncValue=function(t){this.lipSyncValue=t},i.prototype.setAccel=function(t,e,i){this.accelX=t,this.accelY=e,this.accelZ=i},i.prototype.setDrag=function(t,e){this.dragX=t,this.dragY=e},i.prototype.getMainMotionManager=function(){return this.mainMotionManager},i.prototype.getExpressionManager=function(){return this.expressionManager},i.prototype.loadModelData=function(t,e){var i=g.getPlatformManager();this.debugMode&&i.log("Load model : "+t);var s=this;i.loadLive2DModel(t,(function(t){s.live2DModel=t,s.live2DModel.saveParam(),0==Live2D.getError()?(s.modelMatrix=new u(s.live2DModel.getCanvasWidth(),s.live2DModel.getCanvasHeight()),s.modelMatrix.setWidth(2),s.modelMatrix.setCenterPosition(0,0),e(s.live2DModel)):console.error("Error : Failed to loadModelData().")}))},i.prototype.loadTexture=function(t,e,i){s++;var r=g.getPlatformManager();this.debugMode&&r.log("Load Texture : "+e);var o=this;r.loadTexture(this.live2DModel,t,e,(function(){0==--s&&(o.isTexLoaded=!0),"function"==typeof i&&i()}))},i.prototype.loadMotion=function(t,e,i){var s=g.getPlatformManager();this.debugMode&&s.log("Load Motion : "+e);var r=null,o=this;s.loadBytes(e,(function(e){r=Live2DMotion.loadMotion(e),null!=t&&(o.motions[t]=r),i(r)}))},i.prototype.loadExpression=function(t,e,i){var s=g.getPlatformManager();this.debugMode&&s.log("Load Expression : "+e);var o=this;s.loadBytes(e,(function(e){null!=t&&(o.expressions[t]=r.loadJson(e)),"function"==typeof i&&i()}))},i.prototype.loadPose=function(t,e){var i=g.getPlatformManager();this.debugMode&&i.log("Load Pose : "+t);var s=this;try{i.loadBytes(t,(function(t){s.pose=c.load(t),"function"==typeof e&&e()}))}catch(t){console.warn(t)}},i.prototype.loadPhysics=function(t){var e=g.getPlatformManager();this.debugMode&&e.log("Load Physics : "+t);var i=this;try{e.loadBytes(t,(function(t){i.physics=_.load(t)}))}catch(t){console.warn(t)}},i.prototype.hitTestSimple=function(t,e,i){if(null===this.live2DModel)return!1;var s=this.live2DModel.getDrawDataIndex(t);if(s<0)return!1;for(var r=this.live2DModel.getTransformedPoints(s),o=this.live2DModel.getCanvasWidth(),n=0,a=this.live2DModel.getCanvasHeight(),l=0,u=0;u<r.length;u+=2){var h=r[u],_=r[u+1];h<o&&(o=h),h>n&&(n=h),_<a&&(a=_),_>l&&(l=_)}var c=this.modelMatrix.invertTransformX(e),d=this.modelMatrix.invertTransformY(i);return o<=c&&c<=n&&a<=d&&d<=l},i.prototype.hitTestSimpleCustom=function(t,e,i,s){if(null===this.live2DModel)return!1;try{return i>=t[0]&&i<=e[0]&&s<=t[1]&&s>=e[1]}catch(r){return console.log("数据可能还没有准备好 view x:"+t+" y:"+e+" testX:"+i+" testY:"+s+" Error:"+r),!1}},r.prototype=new AMotion,r.EXPRESSION_DEFAULT="DEFAULT",r.TYPE_SET=0,r.TYPE_ADD=1,r.TYPE_MULT=2,r.loadJson=function(t){var e=new r,i=g.getPlatformManager().jsonParseFromBytes(t);if(e.setFadeIn(parseInt(i.fade_in)>0?parseInt(i.fade_in):1e3),e.setFadeOut(parseInt(i.fade_out)>0?parseInt(i.fade_out):1e3),null==i.params)return e;var s=i.params,n=s.length;e.paramList=[];for(var a=0;a<n;a++){var l=s[a],u=l.id.toString(),h=parseFloat(l.val),_=r.TYPE_ADD,c=null!=l.calc?l.calc.toString():"add";if((_="add"===c?r.TYPE_ADD:"mult"===c?r.TYPE_MULT:"set"===c?r.TYPE_SET:r.TYPE_ADD)==r.TYPE_ADD)h-=d=null==l.def?0:parseFloat(l.def);else if(_==r.TYPE_MULT){var d;0==(d=null==l.def?1:parseFloat(l.def))&&(d=1),h/=d}var m=new o;m.id=u,m.type=_,m.value=h,e.paramList.push(m)}return e},r.prototype.updateParamExe=function(t,e,i,s){for(var o=this.paramList.length-1;o>=0;--o){var n=this.paramList[o];n.type==r.TYPE_ADD?t.addToParamFloat(n.id,n.value,i):n.type==r.TYPE_MULT?t.multParamFloat(n.id,n.value,i):n.type==r.TYPE_SET&&t.setParamFloat(n.id,n.value,i)}},n.prototype.calcNextBlink=function(){return UtSystem.getUserTimeMSec()+Math.random()*(2*this.blinkIntervalMsec-1)},n.prototype.setInterval=function(t){this.blinkIntervalMsec=t},n.prototype.setEyeMotion=function(t,e,i){this.closingMotionMsec=t,this.closedMotionMsec=e,this.openingMotionMsec=i},n.prototype.updateParam=function(t){var e,i=UtSystem.getUserTimeMSec(),s=0;switch(this.eyeState){case a.STATE_CLOSING:(s=(i-this.stateStartTime)/this.closingMotionMsec)>=1&&(s=1,this.eyeState=a.STATE_CLOSED,this.stateStartTime=i),e=1-s;break;case a.STATE_CLOSED:(s=(i-this.stateStartTime)/this.closedMotionMsec)>=1&&(this.eyeState=a.STATE_OPENING,this.stateStartTime=i),e=0;break;case a.STATE_OPENING:(s=(i-this.stateStartTime)/this.openingMotionMsec)>=1&&(s=1,this.eyeState=a.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink()),e=s;break;case a.STATE_INTERVAL:this.nextBlinkTime<i&&(this.eyeState=a.STATE_CLOSING,this.stateStartTime=i),e=1;break;case a.STATE_FIRST:default:this.eyeState=a.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink(),e=1}this.closeIfZero||(e=-e),t.setParamFloat(this.eyeID_L,e),t.setParamFloat(this.eyeID_R,e)};var a=function(){};function l(){this.tr=new Float32Array(16),this.identity()}function u(t,e){l.prototype.constructor.call(this),this.width=t,this.height=e}function h(){MotionQueueManager.prototype.constructor.call(this),this.currentPriority=null,this.reservePriority=null,this.super=MotionQueueManager.prototype}function _(){this.physicsList=new Array,this.startTimeMSec=UtSystem.getUserTimeMSec()}function c(){this.lastTime=0,this.lastModel=null,this.partsGroups=new Array}function d(t){this.paramIndex=-1,this.partsIndex=-1,this.link=null,this.id=t}function m(){this.EPSILON=.01,this.faceTargetX=0,this.faceTargetY=0,this.faceX=0,this.faceY=0,this.faceVX=0,this.faceVY=0,this.lastTimeSec=0}function p(){l.prototype.constructor.call(this),this.screenLeft=null,this.screenRight=null,this.screenTop=null,this.screenBottom=null,this.maxLeft=null,this.maxRight=null,this.maxTop=null,this.maxBottom=null,this.max=Number.MAX_VALUE,this.min=0}function g(){}a.STATE_FIRST="STATE_FIRST",a.STATE_INTERVAL="STATE_INTERVAL",a.STATE_CLOSING="STATE_CLOSING",a.STATE_CLOSED="STATE_CLOSED",a.STATE_OPENING="STATE_OPENING",l.mul=function(t,e,i){var s,r,o,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<4;s++)for(r=0;r<4;r++)for(o=0;o<4;o++)n[s+4*r]+=t[s+4*o]*e[o+4*r];for(s=0;s<16;s++)i[s]=n[s]},l.prototype.identity=function(){for(var t=0;t<16;t++)this.tr[t]=t%5==0?1:0},l.prototype.getArray=function(){return this.tr},l.prototype.getCopyMatrix=function(){return new Float32Array(this.tr)},l.prototype.setMatrix=function(t){if(null!=this.tr&&this.tr.length==this.tr.length)for(var e=0;e<16;e++)this.tr[e]=t[e]},l.prototype.getScaleX=function(){return this.tr[0]},l.prototype.getScaleY=function(){return this.tr[5]},l.prototype.transformX=function(t){return this.tr[0]*t+this.tr[12]},l.prototype.transformY=function(t){return this.tr[5]*t+this.tr[13]},l.prototype.invertTransformX=function(t){return(t-this.tr[12])/this.tr[0]},l.prototype.invertTransformY=function(t){return(t-this.tr[13])/this.tr[5]},l.prototype.multTranslate=function(t,e){var i=[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1];l.mul(i,this.tr,this.tr)},l.prototype.translate=function(t,e){this.tr[12]=t,this.tr[13]=e},l.prototype.translateX=function(t){this.tr[12]=t},l.prototype.translateY=function(t){this.tr[13]=t},l.prototype.multScale=function(t,e){var i=[t,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1];l.mul(i,this.tr,this.tr)},l.prototype.scale=function(t,e){this.tr[0]=t,this.tr[5]=e},u.prototype=new l,u.prototype.setPosition=function(t,e){this.translate(t,e)},u.prototype.setCenterPosition=function(t,e){var i=this.width*this.getScaleX(),s=this.height*this.getScaleY();this.translate(t-i/2,e-s/2)},u.prototype.top=function(t){this.setY(t)},u.prototype.bottom=function(t){var e=this.height*this.getScaleY();this.translateY(t-e)},u.prototype.left=function(t){this.setX(t)},u.prototype.right=function(t){var e=this.width*this.getScaleX();this.translateX(t-e)},u.prototype.centerX=function(t){var e=this.width*this.getScaleX();this.translateX(t-e/2)},u.prototype.centerY=function(t){var e=this.height*this.getScaleY();this.translateY(t-e/2)},u.prototype.setX=function(t){this.translateX(t)},u.prototype.setY=function(t){this.translateY(t)},u.prototype.setHeight=function(t){var e=t/this.height,i=-e;this.scale(e,i)},u.prototype.setWidth=function(t){var e=t/this.width,i=-e;this.scale(e,i)},h.prototype=new MotionQueueManager,h.prototype.getCurrentPriority=function(){return this.currentPriority},h.prototype.getReservePriority=function(){return this.reservePriority},h.prototype.reserveMotion=function(t){return!(this.reservePriority>=t)&&(!(this.currentPriority>=t)&&(this.reservePriority=t,!0))},h.prototype.setReservePriority=function(t){this.reservePriority=t},h.prototype.updateParam=function(t){var e=MotionQueueManager.prototype.updateParam.call(this,t);return this.isFinished()&&(this.currentPriority=0),e},h.prototype.startMotionPrio=function(t,e){return e==this.reservePriority&&(this.reservePriority=0),this.currentPriority=e,this.startMotion(t,!1)},_.load=function(t){for(var e=new _,i=g.getPlatformManager().jsonParseFromBytes(t).physics_hair,s=i.length,r=0;r<s;r++){var o=i[r],n=new PhysicsHair,a=o.setup,l=parseFloat(a.length),u=parseFloat(a.regist),h=parseFloat(a.mass);n.setup(l,u,h);for(var c=o.src,d=c.length,m=0;m<d;m++){var p=c[m],f=p.id,y=PhysicsHair.Src.SRC_TO_X;"x"===(b=p.ptype)?y=PhysicsHair.Src.SRC_TO_X:"y"===b?y=PhysicsHair.Src.SRC_TO_Y:"angle"===b?y=PhysicsHair.Src.SRC_TO_G_ANGLE:UtDebug.error("live2d","Invalid parameter:PhysicsHair.Src");var $=parseFloat(p.scale),S=parseFloat(p.weight);n.addSrcParam(y,f,$,S)}var v=o.targets,x=v.length;for(m=0;m<x;m++){var b,P=v[m];f=P.id,y=PhysicsHair.Target.TARGET_FROM_ANGLE;"angle"===(b=P.ptype)?y=PhysicsHair.Target.TARGET_FROM_ANGLE:"angle_v"===b?y=PhysicsHair.Target.TARGET_FROM_ANGLE_V:UtDebug.error("live2d","Invalid parameter:PhysicsHair.Target");$=parseFloat(P.scale),S=parseFloat(P.weight);n.addTargetParam(y,f,$,S)}e.physicsList.push(n)}return e},_.prototype.updateParam=function(t){for(var e=UtSystem.getUserTimeMSec()-this.startTimeMSec,i=0;i<this.physicsList.length;i++)this.physicsList[i].update(t,e)},c.load=function(t){for(var e=new c,i=g.getPlatformManager().jsonParseFromBytes(t).parts_visible,s=i.length,r=0;r<s;r++){for(var o=i[r].group,n=o.length,a=new Array,l=0;l<n;l++){var u=o[l],h=new d(u.id);if(a[l]=h,null!=u.link){var _=u.link,m=_.length;h.link=new Array;for(var p=0;p<m;p++){var f=new d(_[p]);h.link.push(f)}}}e.partsGroups.push(a)}return e},c.prototype.updateParam=function(t){if(null!=t){t!=this.lastModel&&this.initParam(t),this.lastModel=t;var e=UtSystem.getUserTimeMSec(),i=0==this.lastTime?0:(e-this.lastTime)/1e3;this.lastTime=e,i<0&&(i=0);for(var s=0;s<this.partsGroups.length;s++)this.normalizePartsOpacityGroup(t,this.partsGroups[s],i),this.copyOpacityOtherParts(t,this.partsGroups[s])}},c.prototype.initParam=function(t){if(null!=t)for(var e=0;e<this.partsGroups.length;e++)for(var i=this.partsGroups[e],s=0;s<i.length;s++){i[s].initIndex(t);var r=i[s].partsIndex,o=i[s].paramIndex;if(!(r<0)){var n=0!=t.getParamFloat(o);if(t.setPartsOpacity(r,n?1:0),t.setParamFloat(o,n?1:0),null!=i[s].link)for(var a=0;a<i[s].link.length;a++)i[s].link[a].initIndex(t)}}},c.prototype.normalizePartsOpacityGroup=function(t,e,i){for(var s=-1,r=1,o=0;o<e.length;o++){var n=e[o].partsIndex,a=e[o].paramIndex;if(!(n<0)&&0!=t.getParamFloat(a)){if(s>=0)break;s=o,r=t.getPartsOpacity(n),(r+=i/.5)>1&&(r=1)}}s<0&&(s=0,r=1);for(o=0;o<e.length;o++){if(!((n=e[o].partsIndex)<0))if(s==o)t.setPartsOpacity(n,r);else{var l,u=t.getPartsOpacity(n);(1-(l=r<.5?-.5*r/.5+1:.5*(1-r)/.5))*(1-r)>.15&&(l=1-.15/(1-r)),u>l&&(u=l),t.setPartsOpacity(n,u)}}},c.prototype.copyOpacityOtherParts=function(t,e){for(var i=0;i<e.length;i++){var s=e[i];if(null!=s.link&&!(s.partsIndex<0))for(var r=t.getPartsOpacity(s.partsIndex),o=0;o<s.link.length;o++){var n=s.link[o];n.partsIndex<0||t.setPartsOpacity(n.partsIndex,r)}}},d.prototype.initIndex=function(t){this.paramIndex=t.getParamIndex("VISIBLE:"+this.id),this.partsIndex=t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)},m.FRAME_RATE=30,m.prototype.setPoint=function(t,e){this.faceTargetX=t,this.faceTargetY=e},m.prototype.getX=function(){return this.faceX},m.prototype.getY=function(){return this.faceY},m.prototype.update=function(){var t=40/7.5/m.FRAME_RATE;if(0!=this.lastTimeSec){var e=UtSystem.getUserTimeMSec(),i=(e-this.lastTimeSec)*m.FRAME_RATE/1e3;this.lastTimeSec=e;var s=i*t/(.15*m.FRAME_RATE),r=this.faceTargetX-this.faceX,o=this.faceTargetY-this.faceY;if(!(Math.abs(r)<=this.EPSILON&&Math.abs(o)<=this.EPSILON)){var n=Math.sqrt(r*r+o*o),a=t*o/n,l=t*r/n-this.faceVX,u=a-this.faceVY,h=Math.sqrt(l*l+u*u);(h<-s||h>s)&&(l*=s/h,u*=s/h,h=s),this.faceVX+=l,this.faceVY+=u;var _=.5*(Math.sqrt(s*s+16*s*n-8*s*n)-s),c=Math.sqrt(this.faceVX*this.faceVX+this.faceVY*this.faceVY);c>_&&(this.faceVX*=_/c,this.faceVY*=_/c),this.faceX+=this.faceVX,this.faceY+=this.faceVY}}else this.lastTimeSec=UtSystem.getUserTimeMSec()},p.prototype=new l,p.prototype.getMaxScale=function(){return this.max},p.prototype.getMinScale=function(){return this.min},p.prototype.setMaxScale=function(t){this.max=t},p.prototype.setMinScale=function(t){this.min=t},p.prototype.isMaxScale=function(){return this.getScaleX()==this.max},p.prototype.isMinScale=function(){return this.getScaleX()==this.min},p.prototype.adjustTranslate=function(t,e){this.tr[0]*this.maxLeft+(this.tr[12]+t)>this.screenLeft&&(t=this.screenLeft-this.tr[0]*this.maxLeft-this.tr[12]),this.tr[0]*this.maxRight+(this.tr[12]+t)<this.screenRight&&(t=this.screenRight-this.tr[0]*this.maxRight-this.tr[12]),this.tr[5]*this.maxTop+(this.tr[13]+e)<this.screenTop&&(e=this.screenTop-this.tr[5]*this.maxTop-this.tr[13]),this.tr[5]*this.maxBottom+(this.tr[13]+e)>this.screenBottom&&(e=this.screenBottom-this.tr[5]*this.maxBottom-this.tr[13]);var i=[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1];l.mul(i,this.tr,this.tr)},p.prototype.adjustScale=function(t,e,i){var s=i*this.tr[0];s<this.min?this.tr[0]>0&&(i=this.min/this.tr[0]):s>this.max&&this.tr[0]>0&&(i=this.max/this.tr[0]);var r=[1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1],o=[i,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1],n=[1,0,0,0,0,1,0,0,0,0,1,0,-t,-e,0,1];l.mul(n,this.tr,this.tr),l.mul(o,this.tr,this.tr),l.mul(r,this.tr,this.tr)},p.prototype.setScreenRect=function(t,e,i,s){this.screenLeft=t,this.screenRight=e,this.screenTop=s,this.screenBottom=i},p.prototype.setMaxScreenRect=function(t,e,i,s){this.maxLeft=t,this.maxRight=e,this.maxTop=s,this.maxBottom=i},p.prototype.getScreenLeft=function(){return this.screenLeft},p.prototype.getScreenRight=function(){return this.screenRight},p.prototype.getScreenBottom=function(){return this.screenBottom},p.prototype.getScreenTop=function(){return this.screenTop},p.prototype.getMaxLeft=function(){return this.maxLeft},p.prototype.getMaxRight=function(){return this.maxRight},p.prototype.getMaxBottom=function(){return this.maxBottom},p.prototype.getMaxTop=function(){return this.maxTop},g.platformManager=null,g.getPlatformManager=function(){return g.platformManager},g.setPlatformManager=function(t){g.platformManager=t},t.exports={L2DTargetPoint:m,Live2DFramework:g,L2DViewMatrix:p,L2DPose:c,L2DPartsParam:d,L2DPhysics:_,L2DMotionManager:h,L2DModelMatrix:u,L2DMatrix44:l,EYE_STATE:a,L2DEyeBlink:n,L2DExpressionParam:o,L2DExpressionMotion:r,L2DBaseModel:i}},"./src/lib/MatrixStack.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"MatrixStack",(function(){return s}));class s{constructor(){this.depth=0,this.matrixStack=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.currentMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.tmp=new Array(16)}reset(){this.depth=0}loadIdentity(){for(var t=0;t<16;t++)this.currentMatrix[t]=t%5==0?1:0}push(){this.depth;let t=16*(this.depth+1);this.matrixStack.length<t+16&&(this.matrixStack.length=t+16);for(let e=0;e<16;e++)this.matrixStack[t+e]=this.currentMatrix[e];this.depth++}pop(){this.depth--,this.depth<0&&(console.log("Invalid matrix stack. 无效的矩阵堆栈"),this.depth=0);let t=16*this.depth;for(let e=0;e<16;e++)this.currentMatrix[e]=this.matrixStack[t+e]}getMatrix(){return this.currentMatrix}multMatrix(t){let e,i,s;for(e=0;e<16;e++)this.tmp[e]=0;for(e=0;e<4;e++)for(i=0;i<4;i++)for(s=0;s<4;s++)this.tmp[e+4*i]+=this.currentMatrix[e+4*s]*t[s+4*i];for(e=0;e<16;e++)this.currentMatrix[e]=this.tmp[e]}}},"./src/lib/ModelSettingJson.js":function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return r}));var s=i("./src/lib/Live2DFramework.js");function r(){this.NAME="name",this.ID="id",this.MODEL="model",this.TEXTURES="textures",this.HIT_AREAS="hit_areas",this.PHYSICS="physics",this.POSE="pose",this.EXPRESSIONS="expressions",this.MOTION_GROUPS="motions",this.SOUND="sound",this.FADE_IN="fade_in",this.FADE_OUT="fade_out",this.LAYOUT="layout",this.HIT_AREAS_CUSTOM="hit_areas_custom",this.INIT_PARAM="init_param",this.INIT_PARTS_VISIBLE="init_parts_visible",this.VALUE="val",this.FILE="file",this.json={}}r.prototype.loadModelSetting=function(t,e){var i=this;s.Live2DFramework.getPlatformManager().loadBytes(t,(function(t){var s=String.fromCharCode.apply(null,new Uint8Array(t));i.json=JSON.parse(s),e()}))},r.prototype.getTextureFile=function(t){return null==this.json[this.TEXTURES]||null==this.json[this.TEXTURES][t]?null:this.json[this.TEXTURES][t]},r.prototype.getModelFile=function(){return this.json[this.MODEL]},r.prototype.getTextureNum=function(){return null==this.json[this.TEXTURES]?0:this.json[this.TEXTURES].length},r.prototype.getHitAreaNum=function(){return null==this.json[this.HIT_AREAS]?0:this.json[this.HIT_AREAS].length},r.prototype.getHitAreaID=function(t){return null==this.json[this.HIT_AREAS]||null==this.json[this.HIT_AREAS][t]?null:this.json[this.HIT_AREAS][t][this.ID]},r.prototype.getHitAreaName=function(t){return null==this.json[this.HIT_AREAS]||null==this.json[this.HIT_AREAS][t]?null:this.json[this.HIT_AREAS][t][this.NAME]},r.prototype.getPhysicsFile=function(){return this.json[this.PHYSICS]},r.prototype.getPoseFile=function(){return this.json[this.POSE]},r.prototype.getExpressionNum=function(){return null==this.json[this.EXPRESSIONS]?0:this.json[this.EXPRESSIONS].length},r.prototype.getExpressionFile=function(t){return null==this.json[this.EXPRESSIONS]?null:this.json[this.EXPRESSIONS][t][this.FILE]},r.prototype.getExpressionName=function(t){return null==this.json[this.EXPRESSIONS]?null:this.json[this.EXPRESSIONS][t][this.NAME]},r.prototype.getLayout=function(){return this.json[this.LAYOUT]},r.prototype.getHitAreasCustom=function(){return this.json[this.HIT_AREAS_CUSTOM]},r.prototype.getInitParamNum=function(){return null==this.json[this.INIT_PARAM]?0:this.json[this.INIT_PARAM].length},r.prototype.getMotionNum=function(t){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]?0:this.json[this.MOTION_GROUPS][t].length},r.prototype.getMotionFile=function(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]?null:this.json[this.MOTION_GROUPS][t][e][this.FILE]},r.prototype.getMotionSound=function(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]||null==this.json[this.MOTION_GROUPS][t][e][this.SOUND]?null:this.json[this.MOTION_GROUPS][t][e][this.SOUND]},r.prototype.getMotionFadeIn=function(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]||null==this.json[this.MOTION_GROUPS][t][e][this.FADE_IN]?1e3:this.json[this.MOTION_GROUPS][t][e][this.FADE_IN]},r.prototype.getMotionFadeOut=function(t,e){return null==this.json[this.MOTION_GROUPS]||null==this.json[this.MOTION_GROUPS][t]||null==this.json[this.MOTION_GROUPS][t][e]||null==this.json[this.MOTION_GROUPS][t][e][this.FADE_OUT]?1e3:this.json[this.MOTION_GROUPS][t][e][this.FADE_OUT]},r.prototype.getInitParamID=function(t){return null==this.json[this.INIT_PARAM]||null==this.json[this.INIT_PARAM][t]?null:this.json[this.INIT_PARAM][t][this.ID]},r.prototype.getInitParamValue=function(t){return null==this.json[this.INIT_PARAM]||null==this.json[this.INIT_PARAM][t]?NaN:this.json[this.INIT_PARAM][t][this.VALUE]},r.prototype.getInitPartsVisibleNum=function(){return null==this.json[this.INIT_PARTS_VISIBLE]?0:this.json[this.INIT_PARTS_VISIBLE].length},r.prototype.getInitPartsVisibleID=function(t){return null==this.json[this.INIT_PARTS_VISIBLE]||null==this.json[this.INIT_PARTS_VISIBLE][t]?null:this.json[this.INIT_PARTS_VISIBLE][t][this.ID]},r.prototype.getInitPartsVisibleValue=function(t){return null==this.json[this.INIT_PARTS_VISIBLE]||null==this.json[this.INIT_PARTS_VISIBLE][t]?NaN:this.json[this.INIT_PARTS_VISIBLE][t][this.VALUE]}},"./src/lib/live2d.min.js":function(t,e,i){(function(t){!function(){var e=!0;function i(){e||(this._$MT=null,this._$5S=null,this._$NP=0,i._$42++,this._$5S=new U(this))}function s(t){if(!e){this.clipContextList=new Array,this.glcontext=t.gl,this.dp_webgl=t,this.curFrameNo=0,this.firstError_clipInNotUpdate=!0,this.colorBuffer=0,this.isInitGLFBFunc=!1,this.tmpBoundsOnModel=new b,ut.glContext.length>ut.frameBuffers.length&&(this.curFrameNo=this.getMaskRenderTexture()),this.tmpModelToViewMatrix=new B,this.tmpMatrix2=new B,this.tmpMatrixForMask=new B,this.tmpMatrixForDraw=new B,this.CHANNEL_COLORS=new Array;var i=new M;(i=new M).r=0,i.g=0,i.b=0,i.a=1,this.CHANNEL_COLORS.push(i),(i=new M).r=1,i.g=0,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),(i=new M).r=0,i.g=1,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),(i=new M).r=0,i.g=0,i.b=1,i.a=0,this.CHANNEL_COLORS.push(i);for(var s=0;s<this.CHANNEL_COLORS.length;s++)this.dp_webgl.setChannelFlagAsColor(s,this.CHANNEL_COLORS[s])}}function r(t,e,i){this.clipIDList=new Array,this.clipIDList=i,this.clippingMaskDrawIndexList=new Array;for(var s=0;s<i.length;s++)this.clippingMaskDrawIndexList.push(e.getDrawDataIndex(i[s]));this.clippedDrawContextList=new Array,this.isUsing=!0,this.layoutChannelNo=0,this.layoutBounds=new b,this.allClippedDrawRect=new b,this.matrixForMask=new Float32Array(16),this.matrixForDraw=new Float32Array(16),this.owner=t}function o(t,e){this._$gP=t,this.drawDataIndex=e}function n(){e||(this.color=null)}function a(){e||(this._$dP=null,this._$eo=null,this._$V0=null,this._$dP=1e3,this._$eo=1e3,this._$V0=1,this._$a0())}function l(){}function u(){this._$r=null,this._$0S=null}function h(){e||(this.x=null,this.y=null,this.width=null,this.height=null)}function _(t){e||rt.prototype.constructor.call(this,t)}function c(t){e||rt.prototype.constructor.call(this,t)}function d(){e||(this._$vo=null,this._$F2=null,this._$ao=400,this._$1S=400,d._$42++)}function p(){e||(this.p1=new g,this.p2=new g,this._$Fo=0,this._$Db=0,this._$L2=0,this._$M2=0,this._$ks=0,this._$9b=0,this._$iP=0,this._$iT=0,this._$lL=new Array,this._$qP=new Array,this.setup(.3,.5,.1))}function g(){this._$p=1,this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.fx=0,this.fy=0,this._$s0=0,this._$70=0,this._$7L=0,this._$HL=0}function f(t,e,i){this._$wL=null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=e,this._$V0=i}function y(t,e,i,s){f.prototype.constructor.call(this,e,i,s),this._$tL=null,this._$tL=t}function $(t,e,i){this._$wL=null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=e,this._$V0=i}function S(t,e,i,s){$.prototype.constructor.call(this,e,i,s),this._$YP=null,this._$YP=t}function v(){e||(this._$fL=0,this._$gL=0,this._$B0=1,this._$z0=1,this._$qT=0,this.reflectX=!1,this.reflectY=!1)}i._$0s=1,i._$4s=2,i._$42=0,i._$62=function(t,e){try{if(e instanceof ArrayBuffer&&(e=new DataView(e)),!(e instanceof DataView))throw new _t("_$SS#loadModel(b) / b _$x be DataView or ArrayBuffer");var s,r=new bt(e),o=r._$ST(),n=r._$ST(),a=r._$ST();if(109!=o||111!=n||99!=a)throw new _t("_$gi _$C _$li , _$Q0 _$P0.");if(s=r._$ST(),r._$gr(s),s>N._$T7)throw t._$NP|=i._$4s,new _t("_$gi _$C _$li , _$n0 _$_ version _$li ( SDK : "+N._$T7+" < _$f0 : "+s+" )@_$SS#loadModel()\n");var u=r._$nP();if(s>=N._$s7){var h=r._$9T(),_=r._$9T();if(-30584!=h||-30584!=_)throw t._$NP|=i._$0s,new _t("_$gi _$C _$li , _$0 _$6 _$Ui.")}t._$KS(u);var c=t.getModelContext();c.setDrawParam(t.getDrawParam()),c.init()}catch(t){l._$Rb(t)}},i.prototype._$KS=function(t){this._$MT=t},i.prototype.getModelImpl=function(){return null==this._$MT&&(this._$MT=new d,this._$MT._$zP()),this._$MT},i.prototype.getCanvasWidth=function(){return null==this._$MT?0:this._$MT.getCanvasWidth()},i.prototype.getCanvasHeight=function(){return null==this._$MT?0:this._$MT.getCanvasHeight()},i.prototype.getParamFloat=function(t){return"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),this._$5S.getParamFloat(t)},i.prototype.setParamFloat=function(t,e,i){"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),arguments.length<3&&(i=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)*(1-i)+e*i)},i.prototype.addToParamFloat=function(t,e,i){"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),arguments.length<3&&(i=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)+e*i)},i.prototype.multParamFloat=function(t,e,i){"number"!=typeof t&&(t=this._$5S.getParamIndex(c.getID(t))),arguments.length<3&&(i=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)*(1+(e-1)*i))},i.prototype.getParamIndex=function(t){return this._$5S.getParamIndex(c.getID(t))},i.prototype.loadParam=function(){this._$5S.loadParam()},i.prototype.saveParam=function(){this._$5S.saveParam()},i.prototype.init=function(){this._$5S.init()},i.prototype.update=function(){this._$5S.update()},i.prototype._$Rs=function(){return l._$li("_$60 _$PT _$Rs()"),-1},i.prototype._$Ds=function(t){l._$li("_$60 _$PT _$SS#_$Ds() \n")},i.prototype._$K2=function(){},i.prototype.draw=function(){},i.prototype.getModelContext=function(){return this._$5S},i.prototype._$s2=function(){return this._$NP},i.prototype._$P7=function(t,e,i,s){var r=-1,o=0,n=this;if(0!=i)if(1==t.length){d=t[0];var a=0!=n.getParamFloat(d),l=(m=e[0],n.getPartsOpacity(m)),u=i/s;a?(l+=u)>1&&(l=1):(l-=u)<0&&(l=0),n.setPartsOpacity(m,l)}else{for(c=0;c<t.length;c++){d=t[c];if(p=0!=n.getParamFloat(d)){if(r>=0)break;r=c;m=e[c];o=n.getPartsOpacity(m),(o+=i/s)>1&&(o=1)}}r<0&&(console.log("No _$wi _$q0/ _$U default[%s]",t[0]),r=0,o=1,n.loadParam(),n.setParamFloat(t[r],o),n.saveParam());for(c=0;c<t.length;c++){m=e[c];if(r==c)n.setPartsOpacity(m,o);else{var h,_=n.getPartsOpacity(m);(1-(h=o<.5?-.5*o/.5+1:.5*(1-o)/.5))*(1-o)>.15&&(h=1-.15/(1-o)),_>h&&(_=h),n.setPartsOpacity(m,_)}}}else for(var c=0;c<t.length;c++){var d=t[c],m=e[c],p=0!=n.getParamFloat(d);n.setPartsOpacity(m,p?1:0)}},i.prototype.setPartsOpacity=function(t,e){"number"!=typeof t&&(t=this._$5S.getPartsDataIndex(_.getID(t))),this._$5S.setPartsOpacity(t,e)},i.prototype.getPartsDataIndex=function(t){return t instanceof _||(t=_.getID(t)),this._$5S.getPartsDataIndex(t)},i.prototype.getPartsOpacity=function(t){return"number"!=typeof t&&(t=this._$5S.getPartsDataIndex(_.getID(t))),t<0?0:this._$5S.getPartsOpacity(t)},i.prototype.getDrawParam=function(){},i.prototype.getDrawDataIndex=function(t){return this._$5S.getDrawDataIndex(A.getID(t))},i.prototype.getDrawData=function(t){return this._$5S.getDrawData(t)},i.prototype.getTransformedPoints=function(t){var e=this._$5S._$C2(t);return e instanceof dt?e.getTransformedPoints():null},i.prototype.getIndexArray=function(t){if(t<0||t>=this._$5S._$aS.length)return null;var e=this._$5S._$aS[t];return null!=e&&e.getType()==W._$wb&&e instanceof ct?e.getIndexArray():null},s.CHANNEL_COUNT=4,s.RENDER_TEXTURE_USE_MIPMAP=!1,s.NOT_USED_FRAME=-100,s.prototype._$L7=function(){if(this.tmpModelToViewMatrix&&(this.tmpModelToViewMatrix=null),this.tmpMatrix2&&(this.tmpMatrix2=null),this.tmpMatrixForMask&&(this.tmpMatrixForMask=null),this.tmpMatrixForDraw&&(this.tmpMatrixForDraw=null),this.tmpBoundsOnModel&&(this.tmpBoundsOnModel=null),this.CHANNEL_COLORS){for(var t=this.CHANNEL_COLORS.length-1;t>=0;--t)this.CHANNEL_COLORS.splice(t,1);this.CHANNEL_COLORS=[]}this.releaseShader()},s.prototype.releaseShader=function(){for(var t=ut.frameBuffers.length,e=0;e<t;e++)this.gl.deleteFramebuffer(ut.frameBuffers[e].framebuffer);ut.frameBuffers=[],ut.glContext=[]},s.prototype.init=function(t,e,i){for(var s=0;s<e.length;s++){var o=e[s].getClipIDList();if(null!=o){var n=this.findSameClip(o);null==n&&(n=new r(this,t,o),this.clipContextList.push(n));var a=e[s].getDrawDataID(),l=t.getDrawDataIndex(a);n.addClippedDrawData(a,l),i[s].clipBufPre_clipContext=n}}},s.prototype.getMaskRenderTexture=function(){var t;return t=this.dp_webgl.createFramebuffer(),ut.frameBuffers[this.dp_webgl.glno]=t,this.dp_webgl.glno},s.prototype.setupClip=function(t,e){for(var i=0,s=0;s<this.clipContextList.length;s++){var r=this.clipContextList[s];this.calcClippedDrawTotalBounds(t,r),r.isUsing&&i++}if(i>0){var o=e.gl.getParameter(e.gl.FRAMEBUFFER_BINDING),n=new Array(4);n[0]=0,n[1]=0,n[2]=e.gl.canvas.width,n[3]=e.gl.canvas.height,e.gl.viewport(0,0,ut.clippingMaskBufferSize,ut.clippingMaskBufferSize),this.setupLayoutBounds(i),e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,ut.frameBuffers[this.curFrameNo].framebuffer),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT);for(s=0;s<this.clipContextList.length;s++){var a=(r=this.clipContextList[s]).allClippedDrawRect,l=(r.layoutChannelNo,r.layoutBounds);this.tmpBoundsOnModel._$jL(a),this.tmpBoundsOnModel.expand(.05*a.width,.05*a.height);var u=l.width/this.tmpBoundsOnModel.width,h=l.height/this.tmpBoundsOnModel.height;this.tmpMatrix2.identity(),this.tmpMatrix2.translate(-1,-1,0),this.tmpMatrix2.scale(2,2,1),this.tmpMatrix2.translate(l.x,l.y,0),this.tmpMatrix2.scale(u,h,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForMask.setMatrix(this.tmpMatrix2.m),this.tmpMatrix2.identity(),this.tmpMatrix2.translate(l.x,l.y,0),this.tmpMatrix2.scale(u,h,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForDraw.setMatrix(this.tmpMatrix2.m);for(var _=this.tmpMatrixForMask.getArray(),c=0;c<16;c++)r.matrixForMask[c]=_[c];var d=this.tmpMatrixForDraw.getArray();for(c=0;c<16;c++)r.matrixForDraw[c]=d[c];for(var m=r.clippingMaskDrawIndexList.length,p=0;p<m;p++){var g=r.clippingMaskDrawIndexList[p],f=t.getDrawData(g),y=t._$C2(g);e.setClipBufPre_clipContextForMask(r),f.draw(e,t,y)}}e.gl.bindFramebuffer(e.gl.FRAMEBUFFER,o),e.setClipBufPre_clipContextForMask(null),e.gl.viewport(n[0],n[1],n[2],n[3])}},s.prototype.getColorBuffer=function(){return this.colorBuffer},s.prototype.findSameClip=function(t){for(var e=0;e<this.clipContextList.length;e++){var i=this.clipContextList[e],s=i.clipIDList.length;if(s==t.length){for(var r=0,o=0;o<s;o++)for(var n=i.clipIDList[o],a=0;a<s;a++)if(t[a]==n){r++;break}if(r==s)return i}}return null},s.prototype.calcClippedDrawTotalBounds=function(t,e){for(var i=t._$Ri.getModelImpl().getCanvasWidth(),s=t._$Ri.getModelImpl().getCanvasHeight(),r=i>s?i:s,o=r,n=r,a=0,l=0,u=e.clippedDrawContextList.length,h=0;h<u;h++){var _=e.clippedDrawContextList[h].drawDataIndex,c=t._$C2(_);if(c._$yo()){for(var d=c.getTransformedPoints(),m=d.length,p=[],g=[],f=0,y=O._$i2;y<m;y+=O._$No)p[f]=d[y],g[f]=d[y+1],f++;var $=Math.min.apply(null,p),S=Math.min.apply(null,g),v=Math.max.apply(null,p),x=Math.max.apply(null,g);$<o&&(o=$),S<n&&(n=S),v>a&&(a=v),x>l&&(l=x)}}if(o==r)e.allClippedDrawRect.x=0,e.allClippedDrawRect.y=0,e.allClippedDrawRect.width=0,e.allClippedDrawRect.height=0,e.isUsing=!1;else{var b=a-o,P=l-n;e.allClippedDrawRect.x=o,e.allClippedDrawRect.y=n,e.allClippedDrawRect.width=b,e.allClippedDrawRect.height=P,e.isUsing=!0}},s.prototype.setupLayoutBounds=function(t){var e=t/s.CHANNEL_COUNT,i=t%s.CHANNEL_COUNT;e=~~e,i=~~i;for(var r=0,o=0;o<s.CHANNEL_COUNT;o++){var n=e+(o<i?1:0);if(0==n);else if(1==n)(_=this.clipContextList[r++]).layoutChannelNo=o,_.layoutBounds.x=0,_.layoutBounds.y=0,_.layoutBounds.width=1,_.layoutBounds.height=1;else if(2==n)for(var a=0;a<n;a++){var u=0;h=~~(h=a%2),(_=this.clipContextList[r++]).layoutChannelNo=o,_.layoutBounds.x=.5*h,_.layoutBounds.y=0,_.layoutBounds.width=.5,_.layoutBounds.height=1}else if(n<=4)for(a=0;a<n;a++){h=~~(h=a%2),u=~~(u=a/2),(_=this.clipContextList[r++]).layoutChannelNo=o,_.layoutBounds.x=.5*h,_.layoutBounds.y=.5*u,_.layoutBounds.width=.5,_.layoutBounds.height=.5}else if(n<=9)for(a=0;a<n;a++){var h,_;h=~~(h=a%3),u=~~(u=a/3),(_=this.clipContextList[r++]).layoutChannelNo=o,_.layoutBounds.x=h/3,_.layoutBounds.y=u/3,_.layoutBounds.width=1/3,_.layoutBounds.height=1/3}else l._$li("_$6 _$0P mask count : %d",n)}},r.prototype.addClippedDrawData=function(t,e){var i=new o(t,e);this.clippedDrawContextList.push(i)},a._$JT=function(t,e,i){var s=t/e,r=i/e,o=1-(1-r)*(1-r),n=1-(1-r)*(1-r),a=1/3*(1-r)*o+(r*(2/3)+1/3*(1-r))*(1-o),l=(r+2/3*(1-r))*n+(r*(1/3)+2/3*(1-r))*(1-n);if(s<=0)return 0;if(s>=1)return 1;var u=s*s;return(1-3*l+3*a-0)*(s*u)+(3*l-6*a+0)*u+(3*a-0)*s+0},a.prototype._$a0=function(){},a.prototype.setFadeIn=function(t){this._$dP=t},a.prototype.setFadeOut=function(t){this._$eo=t},a.prototype._$pT=function(t){this._$V0=t},a.prototype.getFadeOut=function(){return this._$eo},a.prototype._$4T=function(){return this._$eo},a.prototype._$mT=function(){return this._$V0},a.prototype.getDurationMSec=function(){return-1},a.prototype.getLoopDurationMSec=function(){return-1},a.prototype.updateParam=function(t,e){if(e._$AT&&!e._$9L){var i=F.getUserTimeMSec();if(e._$z2<0){e._$z2=i,e._$bs=i;var s=this.getDurationMSec();e._$Do<0&&(e._$Do=s<=0?-1:e._$z2+s)}var r=this._$V0;0<=(r=r*(0==this._$dP?1:ht._$r2((i-e._$bs)/this._$dP))*(0==this._$eo||e._$Do<0?1:ht._$r2((e._$Do-i)/this._$eo)))&&r<=1||console.log("### assert!! ### "),this.updateParamExe(t,i,r,e),e._$Do>0&&e._$Do<i&&(e._$9L=!0)}},a.prototype.updateParamExe=function(t,e,i,s){},l._$8s=0,l._$fT=new Object,l.start=function(t){var e=l._$fT[t];null==e&&((e=new u)._$r=t,l._$fT[t]=e),e._$0S=F.getSystemTimeMSec()},l.dump=function(t){var e=l._$fT[t];if(null!=e){var i=F.getSystemTimeMSec()-e._$0S;return console.log(t+" : "+i+"ms"),i}return-1},l.end=function(t){var e=l._$fT[t];return null!=e?F.getSystemTimeMSec()-e._$0S:-1},l._$li=function(t,e){console.log("_$li : "+t+"\n",e)},l._$Ji=function(t,e){console.log(t,e)},l._$dL=function(t,e){console.log(t,e),console.log("\n")},l._$KL=function(t,e){for(var i=0;i<e;i++)i%16==0&&i>0?console.log("\n"):i%8==0&&i>0&&console.log("  "),console.log("%02X ",255&t[i]);console.log("\n")},l._$nr=function(t,e,i){console.log("%s\n",t);for(var s=e.length,r=0;r<s;++r)console.log("%5d",e[r]),console.log("%s\n",i),console.log(",");console.log("\n")},l._$Rb=function(t){console.log("dump exception : "+t),console.log("stack :: "+t.stack)},h.prototype._$8P=function(){return.5*(this.x+this.x+this.width)},h.prototype._$6P=function(){return.5*(this.y+this.y+this.height)},h.prototype._$EL=function(){return this.x+this.width},h.prototype._$5T=function(){return this.y+this.height},h.prototype._$jL=function(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s},h.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},_.prototype=new rt,_._$tP=new Object,_._$27=function(){_._$tP.clear()},_.getID=function(t){var e=_._$tP[t];return null==e&&(e=new _(t),_._$tP[t]=e),e},_.prototype._$3s=function(){return new _},c.prototype=new rt,c._$tP=new Object,c._$27=function(){c._$tP.clear()},c.getID=function(t){var e=c._$tP[t];return null==e&&(e=new c(t),c._$tP[t]=e),e},c.prototype._$3s=function(){return new c},d._$42=0,d.prototype._$zP=function(){null==this._$vo&&(this._$vo=new ot),null==this._$F2&&(this._$F2=new Array)},d.prototype.getCanvasWidth=function(){return this._$ao},d.prototype.getCanvasHeight=function(){return this._$1S},d.prototype._$F0=function(t){this._$vo=t._$nP(),this._$F2=t._$nP(),this._$ao=t._$6L(),this._$1S=t._$6L()},d.prototype._$6S=function(t){this._$F2.push(t)},d.prototype._$Xr=function(){return this._$F2},d.prototype._$E2=function(){return this._$vo},p.prototype.setup=function(t,e,i){this._$ks=this._$Yb(),this.p2._$xT(),3==arguments.length&&(this._$Fo=t,this._$L2=e,this.p1._$p=i,this.p2._$p=i,this.p2.y=t,this.setup())},p.prototype.getPhysicsPoint1=function(){return this.p1},p.prototype.getPhysicsPoint2=function(){return this.p2},p.prototype._$qr=function(){return this._$Db},p.prototype._$pr=function(t){this._$Db=t},p.prototype._$5r=function(){return this._$M2},p.prototype._$Cs=function(){return this._$9b},p.prototype._$Yb=function(){return-180*Math.atan2(this.p1.x-this.p2.x,-(this.p1.y-this.p2.y))/Math.PI},p.prototype.addSrcParam=function(t,e,i,s){var r=new y(t,e,i,s);this._$lL.push(r)},p.prototype.addTargetParam=function(t,e,i,s){var r=new S(t,e,i,s);this._$qP.push(r)},p.prototype.update=function(t,e){if(0==this._$iP)return this._$iP=this._$iT=e,void(this._$Fo=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y)));var i=(e-this._$iT)/1e3;if(0!=i){for(var s=this._$lL.length-1;s>=0;--s){this._$lL[s]._$oP(t,this)}this._$oo(t,i),this._$M2=this._$Yb(),this._$9b=(this._$M2-this._$ks)/i,this._$ks=this._$M2}for(s=this._$qP.length-1;s>=0;--s){this._$qP[s]._$YS(t,this)}this._$iT=e},p.prototype._$oo=function(t,e){e<.033&&(e=.033);var i=1/e;this.p1.vx=(this.p1.x-this.p1._$s0)*i,this.p1.vy=(this.p1.y-this.p1._$70)*i,this.p1.ax=(this.p1.vx-this.p1._$7L)*i,this.p1.ay=(this.p1.vy-this.p1._$HL)*i,this.p1.fx=this.p1.ax*this.p1._$p,this.p1.fy=this.p1.ay*this.p1._$p,this.p1._$xT();var s,r,o=-Math.atan2(this.p1.y-this.p2.y,this.p1.x-this.p2.x),n=Math.cos(o),a=Math.sin(o),l=9.8*this.p2._$p,u=this._$Db*wt._$bS,h=l*Math.cos(o-u);s=h*a,r=h*n;var _=-this.p1.fx*a*a,c=-this.p1.fy*a*n,d=-this.p2.vx*this._$L2,m=-this.p2.vy*this._$L2;this.p2.fx=s+_+d,this.p2.fy=r+c+m,this.p2.ax=this.p2.fx/this.p2._$p,this.p2.ay=this.p2.fy/this.p2._$p,this.p2.vx+=this.p2.ax*e,this.p2.vy+=this.p2.ay*e,this.p2.x+=this.p2.vx*e,this.p2.y+=this.p2.vy*e;var p=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y));this.p2.x=this.p1.x+this._$Fo*(this.p2.x-this.p1.x)/p,this.p2.y=this.p1.y+this._$Fo*(this.p2.y-this.p1.y)/p,this.p2.vx=(this.p2.x-this.p2._$s0)*i,this.p2.vy=(this.p2.y-this.p2._$70)*i,this.p2._$xT()},g.prototype._$xT=function(){this._$s0=this.x,this._$70=this.y,this._$7L=this.vx,this._$HL=this.vy},f.prototype._$oP=function(t,e){},y.prototype=new f,y.prototype._$oP=function(t,e){var i=this.scale*t.getParamFloat(this._$wL),s=e.getPhysicsPoint1();switch(this._$tL){default:case p.Src.SRC_TO_X:s.x=s.x+(i-s.x)*this._$V0;break;case p.Src.SRC_TO_Y:s.y=s.y+(i-s.y)*this._$V0;break;case p.Src.SRC_TO_G_ANGLE:var r=e._$qr();r+=(i-r)*this._$V0,e._$pr(r)}},$.prototype._$YS=function(t,e){},S.prototype=new $,S.prototype._$YS=function(t,e){switch(this._$YP){default:case p.Target.TARGET_FROM_ANGLE:t.setParamFloat(this._$wL,this.scale*e._$5r(),this._$V0);break;case p.Target.TARGET_FROM_ANGLE_V:t.setParamFloat(this._$wL,this.scale*e._$Cs(),this._$V0)}},p.Src=function(){},p.Src.SRC_TO_X="SRC_TO_X",p.Src.SRC_TO_Y="SRC_TO_Y",p.Src.SRC_TO_G_ANGLE="SRC_TO_G_ANGLE",p.Target=function(){},p.Target.TARGET_FROM_ANGLE="TARGET_FROM_ANGLE",p.Target.TARGET_FROM_ANGLE_V="TARGET_FROM_ANGLE_V",v.prototype.init=function(t){this._$fL=t._$fL,this._$gL=t._$gL,this._$B0=t._$B0,this._$z0=t._$z0,this._$qT=t._$qT,this.reflectX=t.reflectX,this.reflectY=t.reflectY},v.prototype._$F0=function(t){this._$fL=t._$_T(),this._$gL=t._$_T(),this._$B0=t._$_T(),this._$z0=t._$_T(),this._$qT=t._$_T(),t.getFormatVersion()>=N.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this.reflectX=t._$po(),this.reflectY=t._$po())},v.prototype._$e=function(){};var x=function(){};function b(){e||(this.x=null,this.y=null,this.width=null,this.height=null)}function P(){}function w(){e||(this.x=null,this.y=null)}function L(){e||(this._$gP=null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null,this.clipID=null,this.clipIDList=new Array)}function T(){e||(this._$Eb=T._$ps,this._$lT=1,this._$C0=1,this._$tT=1,this._$WL=1,this.culling=!1,this.matrix4x4=new Float32Array(16),this.premultipliedAlpha=!1,this.anisotropy=0,this.clippingProcess=T.CLIPPING_PROCESS_NONE,this.clipBufPre_clipContextMask=null,this.clipBufPre_clipContextDraw=null,this.CHANNEL_COLORS=new Array)}function M(){e||(this.a=1,this.r=1,this.g=1,this.b=1,this.scale=1,this._$ho=1,this.blendMode=ut.L2D_COLOR_BLEND_MODE_MULT)}function C(){e||(this._$kP=null,this._$dr=null,this._$Ai=!0,this._$mS=null)}function F(){}function I(){e||(this._$VP=0,this._$wL=null,this._$GP=null,this._$8o=I._$ds,this._$2r=-1,this._$O2=0,this._$ri=0)}function E(){}function D(){e||(this._$Ob=null)}function B(){this.m=new Float32Array(16),this.identity()}function A(t){e||rt.prototype.constructor.call(this,t)}function R(){e||(this._$7=1,this._$f=0,this._$H=0,this._$g=1,this._$k=0,this._$w=0,this._$hi=STATE_IDENTITY,this._$Z=_$pS)}function k(){e||(a.prototype.constructor.call(this),this.motions=new Array,this._$7r=null,this._$7r=k._$Co++,this._$D0=30,this._$yT=0,this._$E=!0,this.loopFadeIn=!0,this._$AS=-1,_$a0())}function j(){this._$P=new Float32Array(100),this.size=0}function V(){this._$4P=null,this._$I0=null,this._$RP=null}function O(){}function N(){}function U(t){e||(this._$QT=!0,this._$co=-1,this._$qo=0,this._$pb=new Array(U._$is),this._$_2=new Float32Array(U._$is),this._$vr=new Float32Array(U._$is),this._$Rr=new Float32Array(U._$is),this._$Or=new Float32Array(U._$is),this._$fs=new Float32Array(U._$is),this._$Js=new Array(U._$is),this._$3S=new Array,this._$aS=new Array,this._$Bo=null,this._$F2=new Array,this._$db=new Array,this._$8b=new Array,this._$Hr=new Array,this._$Ws=null,this._$Vs=null,this._$Er=null,this._$Es=new Int16Array(O._$Qb),this._$ZP=new Float32Array(2*O._$1r),this._$Ri=t,this._$b0=U._$HP++,this.clipManager=null,this.dp_webgl=null)}function z(){}function G(){e||(this._$12=null,this._$bb=null,this._$_L=null,this._$jo=null,this._$iL=null,this._$0L=null,this._$Br=null,this._$Dr=null,this._$Cb=null,this._$mr=null,this._$_L=Y.STATE_FIRST,this._$Br=4e3,this._$Dr=100,this._$Cb=50,this._$mr=150,this._$jo=!0,this._$iL="PARAM_EYE_L_OPEN",this._$0L="PARAM_EYE_R_OPEN")}x._$ni=function(t,e,i,s,r,o,n,a,l){var u=n*o-a*r;if(0==u)return null;var h,_=((t-i)*o-(e-s)*r)/u;return h=0!=r?(t-i-_*n)/r:(e-s-_*a)/o,isNaN(h)&&(h=(t-i-_*n)/r,isNaN(h)&&(h=(e-s-_*a)/o),isNaN(h)&&(console.log("a is NaN @UtVector#_$ni() "),console.log("v1x : "+r),console.log("v1x != 0 ? "+(0!=r)))),null==l?new Array(h,_):(l[0]=h,l[1]=_,l)},b.prototype._$8P=function(){return this.x+.5*this.width},b.prototype._$6P=function(){return this.y+.5*this.height},b.prototype._$EL=function(){return this.x+this.width},b.prototype._$5T=function(){return this.y+this.height},b.prototype._$jL=function(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s},b.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},b.prototype.contains=function(t,e){return this.x<=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},b.prototype.expand=function(t,e){this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},P._$Z2=function(t,e,i,s){var r=e._$Q2(t,i),o=t._$vs(),n=t._$Tr();if(e._$zr(o,n,r),r<=0)return s[o[0]];if(1==r)return(a=s[o[0]])+((l=s[o[1]])-a)*($=n[0])|0;if(2==r){var a=s[o[0]],l=s[o[1]],u=s[o[2]],h=s[o[3]];return(x=a+(l-a)*($=n[0])|0)+((u+(h-u)*$|0)-x)*(S=n[1])|0}if(3==r){var _=s[o[0]],c=s[o[1]],d=s[o[2]],m=s[o[3]],p=s[o[4]],g=s[o[5]],f=s[o[6]],y=s[o[7]];return(x=(a=_+(c-_)*($=n[0])|0)+((l=d+(m-d)*$|0)-a)*(S=n[1])|0)+(((u=p+(g-p)*$|0)+((h=f+(y-f)*$|0)-u)*S|0)-x)*(v=n[2])|0}if(4==r){var $,S,v,x,b=s[o[0]],P=s[o[1]],w=s[o[2]],L=s[o[3]],T=s[o[4]],M=s[o[5]],C=s[o[6]],F=s[o[7]],I=s[o[8]],E=s[o[9]],D=s[o[10]],B=s[o[11]],A=s[o[12]],R=s[o[13]],k=s[o[14]],j=s[o[15]];return(x=(a=(_=b+(P-b)*($=n[0])|0)+((c=w+(L-w)*$|0)-_)*(S=n[1])|0)+((l=(d=T+(M-T)*$|0)+((m=C+(F-C)*$|0)-d)*S|0)-a)*(v=n[2])|0)+(((u=(p=I+(E-I)*$|0)+((g=D+(B-D)*$|0)-p)*S|0)+((h=(f=A+(R-A)*$|0)+((y=k+(j-k)*$|0)-f)*S|0)-u)*v|0)-x)*n[3]|0}for(var V=1<<r,O=new Float32Array(V),N=0;N<V;N++){for(var U=N,z=1,G=0;G<r;G++)z*=U%2==0?1-n[G]:n[G],U/=2;O[N]=z}for(var Y=new Float32Array(V),X=0;X<V;X++)Y[X]=s[o[X]];var H=0;for(X=0;X<V;X++)H+=O[X]*Y[X];return H+.5|0},P._$br=function(t,e,i,s){var r=e._$Q2(t,i),o=t._$vs(),n=t._$Tr();if(e._$zr(o,n,r),r<=0)return s[o[0]];if(1==r)return(a=s[o[0]])+((l=s[o[1]])-a)*(_=n[0]);if(2==r){var a=s[o[0]],l=s[o[1]],u=s[o[2]],h=s[o[3]],_=n[0];return(1-(S=n[1]))*(a+(l-a)*_)+S*(u+(h-u)*_)}if(3==r){var c=s[o[0]],d=s[o[1]],m=s[o[2]],p=s[o[3]],g=s[o[4]],f=s[o[5]],y=s[o[6]],$=s[o[7]],S=(_=n[0],n[1]);return(1-(k=n[2]))*((1-S)*(c+(d-c)*_)+S*(m+(p-m)*_))+k*((1-S)*(g+(f-g)*_)+S*(y+($-y)*_))}if(4==r){var v=s[o[0]],x=s[o[1]],b=s[o[2]],P=s[o[3]],w=s[o[4]],L=s[o[5]],T=s[o[6]],M=s[o[7]],C=s[o[8]],F=s[o[9]],I=s[o[10]],E=s[o[11]],D=s[o[12]],B=s[o[13]],A=s[o[14]],R=s[o[15]],k=(_=n[0],S=n[1],n[2]),j=n[3];return(1-j)*((1-k)*((1-S)*(v+(x-v)*_)+S*(b+(P-b)*_))+k*((1-S)*(w+(L-w)*_)+S*(T+(M-T)*_)))+j*((1-k)*((1-S)*(C+(F-C)*_)+S*(I+(E-I)*_))+k*((1-S)*(D+(B-D)*_)+S*(A+(R-A)*_)))}for(var V=1<<r,O=new Float32Array(V),N=0;N<V;N++){for(var U=N,z=1,G=0;G<r;G++)z*=U%2==0?1-n[G]:n[G],U/=2;O[N]=z}for(var Y=new Float32Array(V),X=0;X<V;X++)Y[X]=s[o[X]];var H=0;for(X=0;X<V;X++)H+=O[X]*Y[X];return H},P._$Vr=function(t,e,i,s,r,o,n,a){var l=e._$Q2(t,i),u=t._$vs(),h=t._$Tr();e._$zr(u,h,l);var _=2*s,c=n;if(l<=0){var d=r[u[0]];if(2==a&&0==n)F._$jT(d,0,o,0,_);else for(var m=0;m<_;)o[c]=d[m++],o[c+1]=d[m++],c+=a}else if(1==l){d=r[u[0]];var p=r[u[1]],g=1-($=h[0]);for(m=0;m<_;)o[c]=d[m]*g+p[m]*$,++m,o[c+1]=d[m]*g+p[m]*$,++m,c+=a}else if(2==l){d=r[u[0]],p=r[u[1]];var f=r[u[2]],y=r[u[3]],$=h[0],S=(U=1-(D=h[1]))*(g=1-$),v=U*$,x=D*g,b=D*$;for(m=0;m<_;)o[c]=S*d[m]+v*p[m]+x*f[m]+b*y[m],++m,o[c+1]=S*d[m]+v*p[m]+x*f[m]+b*y[m],++m,c+=a}else if(3==l){var P=r[u[0]],w=r[u[1]],L=r[u[2]],T=r[u[3]],M=r[u[4]],C=r[u[5]],I=r[u[6]],E=r[u[7]],D=($=h[0],h[1]),B=(z=1-(nt=h[2]))*(U=1-D)*(g=1-$),A=z*U*$,R=z*D*g,k=z*D*$,j=nt*U*g,V=nt*U*$,O=nt*D*g,N=nt*D*$;for(m=0;m<_;)o[c]=B*P[m]+A*w[m]+R*L[m]+k*T[m]+j*M[m]+V*C[m]+O*I[m]+N*E[m],++m,o[c+1]=B*P[m]+A*w[m]+R*L[m]+k*T[m]+j*M[m]+V*C[m]+O*I[m]+N*E[m],++m,c+=a}else if(4==l){var U,z,G=r[u[0]],Y=r[u[1]],X=r[u[2]],H=r[u[3]],q=r[u[4]],W=r[u[5]],J=r[u[6]],Q=r[u[7]],Z=r[u[8]],K=r[u[9]],tt=r[u[10]],et=r[u[11]],it=r[u[12]],st=r[u[13]],rt=r[u[14]],ot=r[u[15]],nt=($=h[0],D=h[1],h[2]),at=h[3],lt=1-at,ut=lt*(z=1-nt)*(U=1-D)*(g=1-$),ht=lt*z*U*$,_t=lt*z*D*g,ct=lt*z*D*$,dt=lt*nt*U*g,mt=lt*nt*U*$,pt=lt*nt*D*g,gt=lt*nt*D*$,ft=at*z*U*g,yt=at*z*U*$,$t=at*z*D*g,St=at*z*D*$,vt=at*nt*U*g,xt=at*nt*U*$,bt=at*nt*D*g,Pt=at*nt*D*$;for(m=0;m<_;)o[c]=ut*G[m]+ht*Y[m]+_t*X[m]+ct*H[m]+dt*q[m]+mt*W[m]+pt*J[m]+gt*Q[m]+ft*Z[m]+yt*K[m]+$t*tt[m]+St*et[m]+vt*it[m]+xt*st[m]+bt*rt[m]+Pt*ot[m],++m,o[c+1]=ut*G[m]+ht*Y[m]+_t*X[m]+ct*H[m]+dt*q[m]+mt*W[m]+pt*J[m]+gt*Q[m]+ft*Z[m]+yt*K[m]+$t*tt[m]+St*et[m]+vt*it[m]+xt*st[m]+bt*rt[m]+Pt*ot[m],++m,c+=a}else{for(var wt=1<<l,Lt=new Float32Array(wt),Tt=0;Tt<wt;Tt++){for(var Mt=Tt,Ct=1,Ft=0;Ft<l;Ft++)Ct*=Mt%2==0?1-h[Ft]:h[Ft],Mt/=2;Lt[Tt]=Ct}for(var It=new Float32Array(wt),Et=0;Et<wt;Et++)It[Et]=r[u[Et]];for(m=0;m<_;){var Dt=0,Bt=0,At=m+1;for(Et=0;Et<wt;Et++)Dt+=Lt[Et]*It[Et][m],Bt+=Lt[Et]*It[Et][At];m+=2,o[c]=Dt,o[c+1]=Bt,c+=a}}},w.prototype._$HT=function(t,e){this.x=t,this.y=e},w.prototype._$HT=function(t){this.x=t.x,this.y=t.y},L._$ur=-2,L._$ES=500,L._$wb=2,L._$8S=3,L._$52=L._$ES,L._$R2=L._$ES,L._$or=function(){return L._$52},L._$Pr=function(){return L._$R2},L.prototype.convertClipIDForV2_11=function(t){var e=[];return null==t||0==t.length?null:/,/.test(t)?e=t.id.split(","):(e.push(t.id),e)},L.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=N._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=[],this._$MS(this._$Lb)},L.prototype.getClipIDList=function(){return this.clipIDList},L.prototype.init=function(t){},L.prototype._$Nr=function(t,e){if(e._$IS[0]=!1,e._$Us=P._$Z2(t,this._$GS,e._$IS,this._$Lb),ut._$Zs);else if(e._$IS[0])return;e._$7s=P._$br(t,this._$GS,e._$IS,this._$mS)},L.prototype._$2b=function(t,e){},L.prototype.getDrawDataID=function(){return this._$gP},L.prototype._$j2=function(t){this._$gP=t},L.prototype.getOpacity=function(t,e){return e._$7s},L.prototype._$zS=function(t,e){return e._$Us},L.prototype._$MS=function(t){for(var e=t.length-1;e>=0;--e){var i=t[e];i<L._$52?L._$52=i:i>L._$R2&&(L._$R2=i)}},L.prototype.getTargetBaseDataID=function(){return this._$dr},L.prototype._$gs=function(t){this._$dr=t},L.prototype._$32=function(){return null!=this._$dr&&this._$dr!=$t._$2o()},L.prototype.preDraw=function(t,e,i){},L.prototype.draw=function(t,e,i){},L.prototype.getType=function(){},L.prototype._$B2=function(t,e,i){},T._$ps=32,T.CLIPPING_PROCESS_NONE=0,T.CLIPPING_PROCESS_OVERWRITE_ALPHA=1,T.CLIPPING_PROCESS_MULTIPLY_ALPHA=2,T.CLIPPING_PROCESS_DRAW=3,T.CLIPPING_PROCESS_CLEAR_ALPHA=4,T.prototype.setChannelFlagAsColor=function(t,e){this.CHANNEL_COLORS[t]=e},T.prototype.getChannelFlagAsColor=function(t){return this.CHANNEL_COLORS[t]},T.prototype._$ZT=function(){},T.prototype._$Uo=function(t,e,i,s,r,o,n){},T.prototype._$Rs=function(){return-1},T.prototype._$Ds=function(t){},T.prototype.setBaseColor=function(t,e,i,s){t<0?t=0:t>1&&(t=1),e<0?e=0:e>1&&(e=1),i<0?i=0:i>1&&(i=1),s<0?s=0:s>1&&(s=1),this._$lT=t,this._$C0=e,this._$tT=i,this._$WL=s},T.prototype._$WP=function(t){this.culling=t},T.prototype.setMatrix=function(t){for(var e=0;e<16;e++)this.matrix4x4[e]=t[e]},T.prototype._$IT=function(){return this.matrix4x4},T.prototype.setPremultipliedAlpha=function(t){this.premultipliedAlpha=t},T.prototype.isPremultipliedAlpha=function(){return this.premultipliedAlpha},T.prototype.setAnisotropy=function(t){this.anisotropy=t},T.prototype.getAnisotropy=function(){return this.anisotropy},T.prototype.getClippingProcess=function(){return this.clippingProcess},T.prototype.setClippingProcess=function(t){this.clippingProcess=t},T.prototype.setClipBufPre_clipContextForMask=function(t){this.clipBufPre_clipContextMask=t},T.prototype.getClipBufPre_clipContextMask=function(){return this.clipBufPre_clipContextMask},T.prototype.setClipBufPre_clipContextForDraw=function(t){this.clipBufPre_clipContextDraw=t},T.prototype.getClipBufPre_clipContextDraw=function(){return this.clipBufPre_clipContextDraw},C._$ur=-2,C._$c2=1,C._$_b=2,C.prototype._$F0=function(t){this._$kP=t._$nP(),this._$dr=t._$nP()},C.prototype.readV2_opacity=function(t){t.getFormatVersion()>=N.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this._$mS=t._$Tb())},C.prototype.init=function(t){},C.prototype._$Nr=function(t,e){},C.prototype.interpolateOpacity=function(t,e,i,s){null==this._$mS?i.setInterpolatedOpacity(1):i.setInterpolatedOpacity(P._$br(t,e,s,this._$mS))},C.prototype._$2b=function(t,e){},C.prototype._$nb=function(t,e,i,s,r,o,n){},C.prototype.getType=function(){},C.prototype._$gs=function(t){this._$dr=t},C.prototype._$a2=function(t){this._$kP=t},C.prototype.getTargetBaseDataID=function(){return this._$dr},C.prototype.getBaseDataID=function(){return this._$kP},C.prototype._$32=function(){return null!=this._$dr&&this._$dr!=$t._$2o()},F._$W2=0,F._$CS=F._$W2,F._$Mo=function(){return!0},F._$XP=function(t){try{for(var e=getTimeMSec();getTimeMSec()-e<t;);}catch(t){t._$Rb()}},F.getUserTimeMSec=function(){return F._$CS==F._$W2?F.getSystemTimeMSec():F._$CS},F.setUserTimeMSec=function(t){F._$CS=t},F.updateUserTimeMSec=function(){return F._$CS=F.getSystemTimeMSec()},F.getTimeMSec=function(){return(new Date).getTime()},F.getSystemTimeMSec=function(){return(new Date).getTime()},F._$Q=function(t){},F._$jT=function(t,e,i,s,r){for(var o=0;o<r;o++)i[s+o]=t[e+o]},I._$ds=-2,I.prototype._$F0=function(t){this._$wL=t._$nP(),this._$VP=t._$6L(),this._$GP=t._$nP()},I.prototype.getParamIndex=function(t){return this._$2r!=t&&(this._$8o=I._$ds),this._$8o},I.prototype._$Pb=function(t,e){this._$8o=t,this._$2r=e},I.prototype.getParamID=function(){return this._$wL},I.prototype._$yP=function(t){this._$wL=t},I.prototype._$N2=function(){return this._$VP},I.prototype._$d2=function(){return this._$GP},I.prototype._$t2=function(t,e){this._$VP=t,this._$GP=e},I.prototype._$Lr=function(){return this._$O2},I.prototype._$wr=function(t){this._$O2=t},I.prototype._$SL=function(){return this._$ri},I.prototype._$AL=function(t){this._$ri=t},E.startsWith=function(t,e,i){var s=e+i.length;if(s>=t.length)return!1;for(var r=e;r<s;r++)if(E.getChar(t,r)!=i.charAt(r-e))return!1;return!0},E.getChar=function(t,e){return String.fromCharCode(t.getUint8(e))},E.createString=function(t,e,i){for(var s=new ArrayBuffer(2*i),r=new Uint16Array(s),o=0;o<i;o++)r[o]=t.getUint8(e+o);return String.fromCharCode.apply(null,r)},E._$LS=function(t,e,i,s){t instanceof ArrayBuffer&&(t=new DataView(t));var r=i,o=!1,n=!1,a=0,l=E.getChar(t,r);"-"==l&&(o=!0,r++);for(var u=!1;r<e;r++){switch(l=E.getChar(t,r)){case"0":a*=10;break;case"1":a=10*a+1;break;case"2":a=10*a+2;break;case"3":a=10*a+3;break;case"4":a=10*a+4;break;case"5":a=10*a+5;break;case"6":a=10*a+6;break;case"7":a=10*a+7;break;case"8":a=10*a+8;break;case"9":a=10*a+9;break;case".":n=!0,r++,u=!0;break;default:u=!0}if(u)break}if(n)for(var h=.1,_=!1;r<e;r++){switch(l=E.getChar(t,r)){case"0":break;case"1":a+=1*h;break;case"2":a+=2*h;break;case"3":a+=3*h;break;case"4":a+=4*h;break;case"5":a+=5*h;break;case"6":a+=6*h;break;case"7":a+=7*h;break;case"8":a+=8*h;break;case"9":a+=9*h;break;default:_=!0}if(h*=.1,_)break}return o&&(a=-a),s[0]=r,a},D.prototype._$zP=function(){this._$Ob=new Array},D.prototype._$F0=function(t){this._$Ob=t._$nP()},D.prototype._$Ur=function(t){if(t._$WS())return!0;for(var e=t._$v2(),i=this._$Ob.length-1;i>=0;--i){var s=this._$Ob[i].getParamIndex(e);if(s==I._$ds&&(s=t.getParamIndex(this._$Ob[i].getParamID())),t._$Xb(s))return!0}return!1},D.prototype._$Q2=function(t,e){for(var i,s,r=this._$Ob.length,o=t._$v2(),n=0,a=0;a<r;a++){var l=this._$Ob[a];if((i=l.getParamIndex(o))==I._$ds&&(i=t.getParamIndex(l.getParamID()),l._$Pb(i,o)),i<0)throw new Exception("err 23242 : "+l.getParamID());var u=i<0?0:t.getParamFloat(i);s=l._$N2();var h,_,c=l._$d2(),d=-1,m=0;if(s<1);else if(1==s)(h=c[0])-O._$J<u&&u<h+O._$J?(d=0,m=0):(d=0,e[0]=!0);else if(u<(h=c[0])-O._$J)d=0,e[0]=!0;else if(u<h+O._$J)d=0;else{for(var p=!1,g=1;g<s;++g){if(u<(_=c[g])+O._$J){_-O._$J<u?d=g:(d=g-1,m=(u-h)/(_-h),n++),p=!0;break}h=_}p||(d=s-1,m=0,e[0]=!0)}l._$wr(d),l._$AL(m)}return n},D.prototype._$zr=function(t,e,i){var s=1<<i;s+1>O._$Qb&&console.log("err 23245\n");for(var r=this._$Ob.length,o=1,n=1,a=0,l=0;l<s;++l)t[l]=0;for(var u=0;u<r;++u){var h=this._$Ob[u];if(0==h._$SL()){if((_=h._$Lr()*o)<0&&ut._$3T)throw new Exception("err 23246");for(l=0;l<s;++l)t[l]+=_}else{var _=o*h._$Lr(),c=o*(h._$Lr()+1);for(l=0;l<s;++l)t[l]+=(l/n|0)%2==0?_:c;e[a++]=h._$SL(),n*=2}o*=h._$N2()}t[s]=65535,e[a]=-1},D.prototype._$h2=function(t,e,i){for(var s=new Float32Array(e),r=0;r<e;++r)s[r]=i[r];var o=new I;o._$yP(t),o._$t2(e,s),this._$Ob.push(o)},D.prototype._$J2=function(t){for(var e=t,i=this._$Ob.length,s=0;s<i;++s){var r=this._$Ob[s],o=r._$N2(),n=e%r._$N2(),a=r._$d2()[n];console.log("%s[%d]=%7.2f / ",r.getParamID(),n,a),e/=o}console.log("\n")},D.prototype.getParamCount=function(){return this._$Ob.length},D.prototype._$zs=function(){return this._$Ob},B.prototype.identity=function(){for(var t=0;t<16;t++)this.m[t]=t%5==0?1:0},B.prototype.getArray=function(){return this.m},B.prototype.getCopyMatrix=function(){return new Float32Array(this.m)},B.prototype.setMatrix=function(t){if(null!=t&&16==t.length)for(var e=0;e<16;e++)this.m[e]=t[e]},B.prototype.mult=function(t,e,i){return null==e?null:(this==e?this.mult_safe(this.m,t.m,e.m,i):this.mult_fast(this.m,t.m,e.m,i),e)},B.prototype.mult_safe=function(t,e,i,s){if(t==i){var r=new Array(16);this.mult_fast(t,e,r,s);for(var o=15;o>=0;--o)i[o]=r[o]}else this.mult_fast(t,e,i,s)},B.prototype.mult_fast=function(t,e,i,s){s?(i[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2],i[4]=t[0]*e[4]+t[4]*e[5]+t[8]*e[6],i[8]=t[0]*e[8]+t[4]*e[9]+t[8]*e[10],i[12]=t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],i[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2],i[5]=t[1]*e[4]+t[5]*e[5]+t[9]*e[6],i[9]=t[1]*e[8]+t[5]*e[9]+t[9]*e[10],i[13]=t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],i[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2],i[6]=t[2]*e[4]+t[6]*e[5]+t[10]*e[6],i[10]=t[2]*e[8]+t[6]*e[9]+t[10]*e[10],i[14]=t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],i[3]=i[7]=i[11]=0,i[15]=1):(i[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],i[4]=t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],i[8]=t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],i[12]=t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],i[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],i[5]=t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],i[9]=t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],i[13]=t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],i[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],i[6]=t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],i[10]=t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],i[14]=t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],i[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],i[7]=t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],i[11]=t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],i[15]=t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15])},B.prototype.translate=function(t,e,i){this.m[12]=this.m[0]*t+this.m[4]*e+this.m[8]*i+this.m[12],this.m[13]=this.m[1]*t+this.m[5]*e+this.m[9]*i+this.m[13],this.m[14]=this.m[2]*t+this.m[6]*e+this.m[10]*i+this.m[14],this.m[15]=this.m[3]*t+this.m[7]*e+this.m[11]*i+this.m[15]},B.prototype.scale=function(t,e,i){this.m[0]*=t,this.m[4]*=e,this.m[8]*=i,this.m[1]*=t,this.m[5]*=e,this.m[9]*=i,this.m[2]*=t,this.m[6]*=e,this.m[10]*=i,this.m[3]*=t,this.m[7]*=e,this.m[11]*=i},B.prototype.rotateX=function(t){var e=wt.fcos(t),i=wt._$9(t),s=this.m[4];this.m[4]=s*e+this.m[8]*i,this.m[8]=s*-i+this.m[8]*e,s=this.m[5],this.m[5]=s*e+this.m[9]*i,this.m[9]=s*-i+this.m[9]*e,s=this.m[6],this.m[6]=s*e+this.m[10]*i,this.m[10]=s*-i+this.m[10]*e,s=this.m[7],this.m[7]=s*e+this.m[11]*i,this.m[11]=s*-i+this.m[11]*e},B.prototype.rotateY=function(t){var e=wt.fcos(t),i=wt._$9(t),s=this.m[0];this.m[0]=s*e+this.m[8]*-i,this.m[8]=s*i+this.m[8]*e,s=this.m[1],this.m[1]=s*e+this.m[9]*-i,this.m[9]=s*i+this.m[9]*e,s=m[2],this.m[2]=s*e+this.m[10]*-i,this.m[10]=s*i+this.m[10]*e,s=m[3],this.m[3]=s*e+this.m[11]*-i,this.m[11]=s*i+this.m[11]*e},B.prototype.rotateZ=function(t){var e=wt.fcos(t),i=wt._$9(t),s=this.m[0];this.m[0]=s*e+this.m[4]*i,this.m[4]=s*-i+this.m[4]*e,s=this.m[1],this.m[1]=s*e+this.m[5]*i,this.m[5]=s*-i+this.m[5]*e,s=this.m[2],this.m[2]=s*e+this.m[6]*i,this.m[6]=s*-i+this.m[6]*e,s=this.m[3],this.m[3]=s*e+this.m[7]*i,this.m[7]=s*-i+this.m[7]*e},A.prototype=new rt,A._$tP=new Object,A._$27=function(){A._$tP.clear()},A.getID=function(t){var e=A._$tP[t];return null==e&&(e=new A(t),A._$tP[t]=e),e},A.prototype._$3s=function(){return new A},R._$kS=-1,R._$pS=0,R._$hb=1,R.STATE_IDENTITY=0,R._$gb=1,R._$fo=2,R._$go=4,R.prototype.transform=function(t,e,i){var s,r,o,n,a,l,u=0,h=0;switch(this._$hi){default:return;case R._$go|R._$fo|R._$gb:for(s=this._$7,r=this._$H,o=this._$k,n=this._$f,a=this._$g,l=this._$w;--i>=0;){var _=t[u++],c=t[u++];e[h++]=s*_+r*c+o,e[h++]=n*_+a*c+l}return;case R._$go|R._$fo:for(s=this._$7,r=this._$H,n=this._$f,a=this._$g;--i>=0;){_=t[u++],c=t[u++];e[h++]=s*_+r*c,e[h++]=n*_+a*c}return;case R._$go|R._$gb:for(r=this._$H,o=this._$k,n=this._$f,l=this._$w;--i>=0;){_=t[u++];e[h++]=r*t[u++]+o,e[h++]=n*_+l}return;case R._$go:for(r=this._$H,n=this._$f;--i>=0;){_=t[u++];e[h++]=r*t[u++],e[h++]=n*_}return;case R._$fo|R._$gb:for(s=this._$7,o=this._$k,a=this._$g,l=this._$w;--i>=0;)e[h++]=s*t[u++]+o,e[h++]=a*t[u++]+l;return;case R._$fo:for(s=this._$7,a=this._$g;--i>=0;)e[h++]=s*t[u++],e[h++]=a*t[u++];return;case R._$gb:for(o=this._$k,l=this._$w;--i>=0;)e[h++]=t[u++]+o,e[h++]=t[u++]+l;return;case R.STATE_IDENTITY:return void(t==e&&u==h||F._$jT(t,u,e,h,2*i))}},R.prototype.update=function(){0==this._$H&&0==this._$f?1==this._$7&&1==this._$g?0==this._$k&&0==this._$w?(this._$hi=R.STATE_IDENTITY,this._$Z=R._$pS):(this._$hi=R._$gb,this._$Z=R._$hb):0==this._$k&&0==this._$w?(this._$hi=R._$fo,this._$Z=R._$kS):(this._$hi=R._$fo|R._$gb,this._$Z=R._$kS):0==this._$7&&0==this._$g?0==this._$k&&0==this._$w?(this._$hi=R._$go,this._$Z=R._$kS):(this._$hi=R._$go|R._$gb,this._$Z=R._$kS):0==this._$k&&0==this._$w?(this._$hi=R._$go|R._$fo,this._$Z=R._$kS):(this._$hi=R._$go|R._$fo|R._$gb,this._$Z=R._$kS)},R.prototype._$RT=function(t){this._$IT(t);var e=t[0],i=t[2],s=t[1],r=t[3],o=Math.sqrt(e*e+s*s),n=e*r-i*s;0==o?ut._$so&&console.log("affine._$RT() / rt==0"):(t[0]=o,t[1]=n/o,t[2]=(s*r+e*i)/n,t[3]=Math.atan2(s,e))},R.prototype._$ho=function(t,e,i,s){var r=new Float32Array(6),o=new Float32Array(6);t._$RT(r),e._$RT(o);var n=new Float32Array(6);n[0]=r[0]+(o[0]-r[0])*i,n[1]=r[1]+(o[1]-r[1])*i,n[2]=r[2]+(o[2]-r[2])*i,n[3]=r[3]+(o[3]-r[3])*i,n[4]=r[4]+(o[4]-r[4])*i,n[5]=r[5]+(o[5]-r[5])*i,s._$CT(n)},R.prototype._$CT=function(t){var e=Math.cos(t[3]),i=Math.sin(t[3]);this._$7=t[0]*e,this._$f=t[0]*i,this._$H=t[1]*(t[2]*e-i),this._$g=t[1]*(t[2]*i+e),this._$k=t[4],this._$w=t[5],this.update()},R.prototype._$IT=function(t){t[0]=this._$7,t[1]=this._$f,t[2]=this._$H,t[3]=this._$g,t[4]=this._$k,t[5]=this._$w},k.prototype=new a,k._$cs="VISIBLE:",k._$ar="LAYOUT:",k._$Co=0,k._$D2=[],k._$1T=1,k.loadMotion=function(t){var e=new k,i=[0],s=t.length;e._$yT=0;for(var r=0;r<s;++r){var o=255&t[r];if("\n"!=o&&"\r"!=o)if("#"!=o)if("$"!=o){if("a"<=o&&o<="z"||"A"<=o&&o<="Z"||"_"==o){for(u=r,h=-1;r<s&&("\r"!=(o=255&t[r])&&"\n"!=o);++r)if("="==o){h=r;break}if(h>=0){var n=new V;E.startsWith(t,u,k._$cs)?(n._$RP=V._$hs,n._$4P=new String(t,u,h-u)):E.startsWith(t,u,k._$ar)?(n._$4P=new String(t,u+7,h-u-7),E.startsWith(t,u+7,"ANCHOR_X")?n._$RP=V._$xs:E.startsWith(t,u+7,"ANCHOR_Y")?n._$RP=V._$us:E.startsWith(t,u+7,"SCALE_X")?n._$RP=V._$qs:E.startsWith(t,u+7,"SCALE_Y")?n._$RP=V._$Ys:E.startsWith(t,u+7,"X")?n._$RP=V._$ws:E.startsWith(t,u+7,"Y")&&(n._$RP=V._$Ns)):(n._$RP=V._$Fr,n._$4P=new String(t,u,h-u)),e.motions.push(n);var a=0;for(k._$D2.clear(),r=h+1;r<s&&("\r"!=(o=255&t[r])&&"\n"!=o);++r)if(","!=o&&" "!=o&&"\t"!=o){c=E._$LS(t,s,r,i);if(i[0]>0){k._$D2.push(c),a++;var l=i[0];if(l<r){console.log("_$n0 _$hi . @Live2DMotion loadMotion()\n");break}r=l}}n._$I0=k._$D2._$BL(),a>e._$yT&&(e._$yT=a)}}}else{for(var u=r,h=-1;r<s&&("\r"!=(o=255&t[r])&&"\n"!=o);++r)if("="==o){h=r;break}var _=!1;if(h>=0)for(h==u+4&&"f"==t[u+1]&&"p"==t[u+2]&&"s"==t[u+3]&&(_=!0),r=h+1;r<s&&("\r"!=(o=255&t[r])&&"\n"!=o);++r)if(","!=o&&" "!=o&&"\t"!=o){var c=E._$LS(t,s,r,i);i[0]>0&&_&&5<c&&c<121&&(e._$D0=c),r=i[0]}for(;r<s&&("\n"!=t[r]&&"\r"!=t[r]);++r);}else for(;r<s&&("\n"!=t[r]&&"\r"!=t[r]);++r);}return e._$AS=1e3*e._$yT/e._$D0|0,e},k.prototype.getDurationMSec=function(){return this._$AS},k.prototype.dump=function(){for(var t=0;t<this.motions.length;t++){var e=this.motions[t];console.log("_$wL[%s] [%d]. ",e._$4P,e._$I0.length);for(var i=0;i<e._$I0.length&&i<10;i++)console.log("%5.2f ,",e._$I0[i]);console.log("\n")}},k.prototype.updateParamExe=function(t,e,i,s){for(var r=(e-s._$z2)*this._$D0/1e3,o=0|r,n=r-o,a=0;a<this.motions.length;a++){var l=this.motions[a],u=l._$I0.length,h=l._$4P;if(l._$RP==V._$hs){var _=l._$I0[o>=u?u-1:o];t.setParamFloat(h,_)}else if(V._$ws<=l._$RP&&l._$RP<=V._$Ys);else{var c=t.getParamFloat(h),d=l._$I0[o>=u?u-1:o],m=c+(d+(l._$I0[o+1>=u?u-1:o+1]-d)*n-c)*i;t.setParamFloat(h,m)}}o>=this._$yT&&(this._$E?(s._$z2=e,this.loopFadeIn&&(s._$bs=e)):s._$9L=!0)},k.prototype._$r0=function(){return this._$E},k.prototype._$aL=function(t){this._$E=t},k.prototype.isLoopFadeIn=function(){return this.loopFadeIn},k.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},j.prototype.clear=function(){this.size=0},j.prototype.add=function(t){if(this._$P.length<=this.size){var e=new Float32Array(2*this.size);F._$jT(this._$P,0,e,0,this.size),this._$P=e}this._$P[this.size++]=t},j.prototype._$BL=function(){var t=new Float32Array(this.size);return F._$jT(this._$P,0,t,0,this.size),t},V._$Fr=0,V._$hs=1,V._$ws=100,V._$Ns=101,V._$xs=102,V._$us=103,V._$qs=104,V._$Ys=105,O._$Ms=1,O._$Qs=2,O._$i2=0,O._$No=2,O._$do=O._$Ms,O._$Ls=!0,O._$1r=5,O._$Qb=65,O._$J=1e-4,O._$FT=.001,O._$Ss=3,N._$o7=6,N._$S7=7,N._$s7=8,N._$77=9,N.LIVE2D_FORMAT_VERSION_V2_10_SDK2=10,N.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1=11,N._$T7=N.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1,N._$Is=-2004318072,N._$h0=0,N._$4L=23,N._$7P=33,N._$uT=function(t){console.log("_$bo :: _$6 _$mo _$E0 : %d\n",t)},N._$9o=function(t){if(t<40)return N._$uT(t),null;if(t<50)return N._$uT(t),null;if(t<60)return N._$uT(t),null;if(t<100)switch(t){case 65:return new tt;case 66:return new D;case 67:return new I;case 68:return new H;case 69:return new v;case 70:return new ct;default:return N._$uT(t),null}else if(t<150)switch(t){case 131:return new at;case 133:return new it;case 136:return new d;case 137:return new ot;case 142:return new J}return N._$uT(t),null},U._$HP=0,U._$_0=!0,U._$V2=-1,U._$W0=-1,U._$jr=!1,U._$ZS=!0,U._$tr=-1e6,U._$lr=1e6,U._$is=32,U._$e=!1,U.prototype.getDrawDataIndex=function(t){for(var e=this._$aS.length-1;e>=0;--e)if(null!=this._$aS[e]&&this._$aS[e].getDrawDataID()==t)return e;return-1},U.prototype.getDrawData=function(t){if(t instanceof A){if(null==this._$Bo){this._$Bo=new Object;for(var e=this._$aS.length,i=0;i<e;i++){var s=this._$aS[i],r=s.getDrawDataID();null!=r&&(this._$Bo[r]=s)}}return this._$Bo[id]}return t<this._$aS.length?this._$aS[t]:null},U.prototype.release=function(){this._$3S.clear(),this._$aS.clear(),this._$F2.clear(),null!=this._$Bo&&this._$Bo.clear(),this._$db.clear(),this._$8b.clear(),this._$Hr.clear()},U.prototype.init=function(){this._$co++,this._$F2.length>0&&this.release();for(var t=this._$Ri.getModelImpl(),e=t._$Xr(),i=e.length,r=new Array,o=new Array,n=0;n<i;++n){var a=e[n];this._$F2.push(a),this._$Hr.push(a.init(this));for(var l=a.getBaseData(),u=l.length,h=0;h<u;++h)r.push(l[h]);for(h=0;h<u;++h){var _=l[h].init(this);_._$l2(n),o.push(_)}var c=a.getDrawData(),d=c.length;for(h=0;h<d;++h){var m=c[h],p=m.init(this);p._$IP=n,this._$aS.push(m),this._$8b.push(p)}}for(var g=r.length,f=$t._$2o();;){var y=!1;for(n=0;n<g;++n){var $=r[n];if(null!=$){var S=$.getTargetBaseDataID();(null==S||S==f||this.getBaseDataIndex(S)>=0)&&(this._$3S.push($),this._$db.push(o[n]),r[n]=null,y=!0)}}if(!y)break}var v=t._$E2();if(null!=v){var x=v._$1s();if(null!=x){var b=x.length;for(n=0;n<b;++n){var P=x[n];null!=P&&this._$02(P.getParamID(),P.getDefaultValue(),P.getMinValue(),P.getMaxValue())}}}this.clipManager=new s(this.dp_webgl),this.clipManager.init(this,this._$aS,this._$8b),this._$QT=!0},U.prototype.update=function(){U._$e&&l.start("_$zL");for(var t=this._$_2.length,e=0;e<t;e++)this._$_2[e]!=this._$vr[e]&&(this._$Js[e]=U._$ZS,this._$vr[e]=this._$_2[e]);var i=this._$3S.length,s=this._$aS.length,r=W._$or(),o=W._$Pr()-r+1;(null==this._$Ws||this._$Ws.length<o)&&(this._$Ws=new Int16Array(o),this._$Vs=new Int16Array(o));for(e=0;e<o;e++)this._$Ws[e]=U._$V2,this._$Vs[e]=U._$V2;(null==this._$Er||this._$Er.length<s)&&(this._$Er=new Int16Array(s));for(e=0;e<s;e++)this._$Er[e]=U._$W0;U._$e&&l.dump("_$zL"),U._$e&&l.start("_$UL");for(var n=null,a=0;a<i;++a){var u=this._$3S[a],h=this._$db[a];try{u._$Nr(this,h),u._$2b(this,h)}catch(t){null==n&&(n=t)}}null!=n&&U._$_0&&l._$Rb(n),U._$e&&l.dump("_$UL"),U._$e&&l.start("_$DL");for(var _=null,c=0;c<s;++c){var d=this._$aS[c],m=this._$8b[c];try{if(d._$Nr(this,m),m._$u2())continue;d._$2b(this,m);var p,g=Math.floor(d._$zS(this,m)-r);try{p=this._$Vs[g]}catch(t){console.log("_$li :: %s / %s \t\t\t\t@@_$fS\n",t.toString(),d.getDrawDataID().toString()),g=Math.floor(d._$zS(this,m)-r);continue}p==U._$V2?this._$Ws[g]=c:this._$Er[p]=c,this._$Vs[g]=c}catch(t){null==_&&(_=t,ut._$sT(ut._$H7))}}null!=_&&U._$_0&&l._$Rb(_),U._$e&&l.dump("_$DL"),U._$e&&l.start("_$eL");for(e=this._$Js.length-1;e>=0;e--)this._$Js[e]=U._$jr;return this._$QT=!1,U._$e&&l.dump("_$eL"),!1},U.prototype.preDraw=function(t){null!=this.clipManager&&(t._$ZT(),this.clipManager.setupClip(this,t))},U.prototype.draw=function(t){if(null!=this._$Ws){var e=this._$Ws.length;t._$ZT();for(var i=0;i<e;++i){var s=this._$Ws[i];if(s!=U._$V2)for(;;){var r=this._$aS[s],o=this._$8b[s];if(o._$yo()){var n=o._$IP,a=this._$Hr[n];o._$VS=a.getPartsOpacity(),r.draw(t,this,o)}var u=this._$Er[s];if(u<=s||u==U._$W0)break;s=u}}}else l._$li("call _$Ri.update() before _$Ri.draw() ")},U.prototype.getParamIndex=function(t){for(var e=this._$pb.length-1;e>=0;--e)if(this._$pb[e]==t)return e;return this._$02(t,0,U._$tr,U._$lr)},U.prototype._$BS=function(t){return this.getBaseDataIndex(t)},U.prototype.getBaseDataIndex=function(t){for(var e=this._$3S.length-1;e>=0;--e)if(null!=this._$3S[e]&&this._$3S[e].getBaseDataID()==t)return e;return-1},U.prototype._$UT=function(t,e){var i=new Float32Array(e);return F._$jT(t,0,i,0,t.length),i},U.prototype._$02=function(t,e,i,s){if(this._$qo>=this._$pb.length){var r=this._$pb.length,o=new Array(2*r);F._$jT(this._$pb,0,o,0,r),this._$pb=o,this._$_2=this._$UT(this._$_2,2*r),this._$vr=this._$UT(this._$vr,2*r),this._$Rr=this._$UT(this._$Rr,2*r),this._$Or=this._$UT(this._$Or,2*r);var n=new Array;F._$jT(this._$Js,0,n,0,r),this._$Js=n}return this._$pb[this._$qo]=t,this._$_2[this._$qo]=e,this._$vr[this._$qo]=e,this._$Rr[this._$qo]=i,this._$Or[this._$qo]=s,this._$Js[this._$qo]=U._$ZS,this._$qo++},U.prototype._$Zo=function(t,e){this._$3S[t]=e},U.prototype.setParamFloat=function(t,e){e<this._$Rr[t]&&(e=this._$Rr[t]),e>this._$Or[t]&&(e=this._$Or[t]),this._$_2[t]=e},U.prototype.loadParam=function(){var t=this._$_2.length;t>this._$fs.length&&(t=this._$fs.length),F._$jT(this._$fs,0,this._$_2,0,t)},U.prototype.saveParam=function(){var t=this._$_2.length;t>this._$fs.length&&(this._$fs=new Float32Array(t)),F._$jT(this._$_2,0,this._$fs,0,t)},U.prototype._$v2=function(){return this._$co},U.prototype._$WS=function(){return this._$QT},U.prototype._$Xb=function(t){return this._$Js[t]==U._$ZS},U.prototype._$vs=function(){return this._$Es},U.prototype._$Tr=function(){return this._$ZP},U.prototype.getBaseData=function(t){return this._$3S[t]},U.prototype.getParamFloat=function(t){return this._$_2[t]},U.prototype.getParamMax=function(t){return this._$Or[t]},U.prototype.getParamMin=function(t){return this._$Rr[t]},U.prototype.setPartsOpacity=function(t,e){this._$Hr[t].setPartsOpacity(e)},U.prototype.getPartsOpacity=function(t){return this._$Hr[t].getPartsOpacity()},U.prototype.getPartsDataIndex=function(t){for(var e=this._$F2.length-1;e>=0;--e)if(null!=this._$F2[e]&&this._$F2[e]._$p2()==t)return e;return-1},U.prototype._$q2=function(t){return this._$db[t]},U.prototype._$C2=function(t){return this._$8b[t]},U.prototype._$Bb=function(t){return this._$Hr[t]},U.prototype._$5s=function(t,e){for(var i=this._$Ws.length,s=t,r=0;r<i;++r){var o=this._$Ws[r];if(o!=U._$V2)for(;;){var n=this._$8b[o];n._$yo()&&(n._$GT()._$B2(this,n,s),s+=e);var a=this._$Er[o];if(a<=o||a==U._$W0)break;o=a}}},U.prototype.setDrawParam=function(t){this.dp_webgl=t},U.prototype.getDrawParam=function(){return this.dp_webgl},z._$0T=function(t){return z._$0T(new _$5(t))},z._$0T=function(t){if(!t.exists())throw new _$ls(t._$3b());for(var e,i=t.length(),s=new Int8Array(i),r=new _$Xs(new _$kb(t),8192),o=0;(e=r.read(s,o,i-o))>0;)o+=e;return s},z._$C=function(t){var e=null,i=null;try{e=t instanceof Array?t:new _$Xs(t,8192),i=new _$js;for(var s,r=new Int8Array(1e3);(s=e.read(r))>0;)i.write(r,0,s);return i._$TS()}finally{null!=t&&t.close(),null!=i&&(i.flush(),i.close())}},G.prototype._$T2=function(){return F.getUserTimeMSec()+Math._$10()*(2*this._$Br-1)},G.prototype._$uo=function(t){this._$Br=t},G.prototype._$QS=function(t,e,i){this._$Dr=t,this._$Cb=e,this._$mr=i},G.prototype._$7T=function(t){var e,i=F.getUserTimeMSec(),s=0;switch(this._$_L){case STATE_CLOSING:(s=(i-this._$bb)/this._$Dr)>=1&&(s=1,this._$_L=Y.STATE_CLOSED,this._$bb=i),e=1-s;break;case STATE_CLOSED:(s=(i-this._$bb)/this._$Cb)>=1&&(this._$_L=Y.STATE_OPENING,this._$bb=i),e=0;break;case STATE_OPENING:(s=(i-this._$bb)/this._$mr)>=1&&(s=1,this._$_L=Y.STATE_INTERVAL,this._$12=this._$T2()),e=s;break;case STATE_INTERVAL:this._$12<i&&(this._$_L=Y.STATE_CLOSING,this._$bb=i),e=1;break;case STATE_FIRST:default:this._$_L=Y.STATE_INTERVAL,this._$12=this._$T2(),e=1}this._$jo||(e=-e),t.setParamFloat(this._$iL,e),t.setParamFloat(this._$0L,e)};var Y=function(){};function X(){e||(T.prototype.constructor.call(this),this._$sb=new Int32Array(X._$As),this._$U2=new Array,this.transform=null,this.gl=null,null==X._$NT&&(X._$NT=X._$9r(256),X._$vS=X._$9r(256),X._$no=X._$vb(256)))}function H(){e||(C.prototype.constructor.call(this),this._$GS=null,this._$Y0=null)}function q(t){lt.prototype.constructor.call(this,t),this._$8r=C._$ur,this._$Yr=null,this._$Wr=null}function W(){e||(L.prototype.constructor.call(this),this._$gP=null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null)}function J(){e||(this._$NL=null,this._$3S=null,this._$aS=null,J._$42++)}function Q(){e||(i.prototype.constructor.call(this),this._$zo=new X)}function Z(){e||(a.prototype.constructor.call(this),this.motions=new Array,this._$o2=null,this._$7r=Z._$Co++,this._$D0=30,this._$yT=0,this._$E=!1,this.loopFadeIn=!0,this._$rr=-1,this._$eP=0)}function K(t,e){return String.fromCharCode(t.getUint8(e))}function j(){this._$P=new Float32Array(100),this.size=0}function V(){this._$4P=null,this._$I0=null,this._$RP=null}function tt(){e||(C.prototype.constructor.call(this),this._$o=0,this._$A=0,this._$GS=null,this._$Eo=null)}function et(t){lt.prototype.constructor.call(this,t),this._$8r=C._$ur,this._$Cr=null,this._$hr=null}function it(){e||(this.visible=!0,this._$g0=!1,this._$NL=null,this._$3S=null,this._$aS=null,it._$42++)}function st(t){this._$VS=null,this._$e0=null,this._$e0=t}function rt(t){e||(this.id=t)}function ot(){e||(this._$4S=null)}function nt(t,e){this.canvas=t,this.context=e,this.viewport=new Array(0,0,t.width,t.height),this._$6r=1,this._$xP=0,this._$3r=1,this._$uP=0,this._$Qo=-1,this.cacheImages={}}function at(){e||(this._$TT=null,this._$LT=null,this._$FS=null,this._$wL=null)}function lt(t){e||(this._$e0=null,this._$IP=null,this._$JS=!1,this._$AT=!0,this._$e0=t,this.totalScale=1,this._$7s=1,this.totalOpacity=1)}function ut(){}function ht(){}function _t(t){e||(this._$ib=t)}function ct(){e||(W.prototype.constructor.call(this),this._$LP=-1,this._$d0=0,this._$Yo=0,this._$JP=null,this._$5P=null,this._$BP=null,this._$Eo=null,this._$Qi=null,this._$6s=ct._$ms,this.culling=!0,this.gl_cacheImage=null,this.instanceNo=ct._$42++)}function dt(t){Lt.prototype.constructor.call(this,t),this._$8r=W._$ur,this._$Cr=null,this._$hr=null}function mt(){e||(this.x=null,this.y=null)}function pt(t){e||(i.prototype.constructor.call(this),this.drawParamWebGL=new St(t),this.drawParamWebGL.setGL(ut.getGL(t)))}function gt(){e||(this.motions=null,this._$eb=!1,this.motions=new Array)}function ft(){this._$w0=null,this._$AT=!0,this._$9L=!1,this._$z2=-1,this._$bs=-1,this._$Do=-1,this._$sr=null,this._$sr=ft._$Gs++}function yt(){this.m=new Array(1,0,0,0,1,0,0,0,1)}function $t(t){e||rt.prototype.constructor.call(this,t)}function St(t){e||(T.prototype.constructor.call(this),this.textures=new Array,this.transform=null,this.gl=null,this.glno=t,this.firstDraw=!0,this.anisotropyExt=null,this.maxAnisotropy=0,this._$As=32,this._$Gr=!1,this._$NT=null,this._$vS=null,this._$no=null,this.vertShader=null,this.fragShader=null,this.vertShaderOff=null,this.fragShaderOff=null)}function vt(t,e,i){return null==e&&(e=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW),e}function xt(t,e,i){return null==e&&(e=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.DYNAMIC_DRAW),e}function bt(t){e||(this._$P=new Int8Array(8),this._$R0=new DataView(this._$P.buffer),this._$3i=new Int8Array(1e3),this._$hL=0,this._$v0=0,this._$S2=0,this._$Ko=new Array,this._$T=t,this._$F=0)}Y.STATE_FIRST="STATE_FIRST",Y.STATE_INTERVAL="STATE_INTERVAL",Y.STATE_CLOSING="STATE_CLOSING",Y.STATE_CLOSED="STATE_CLOSED",Y.STATE_OPENING="STATE_OPENING",X.prototype=new T,X._$As=32,X._$Gr=!1,X._$NT=null,X._$vS=null,X._$no=null,X._$9r=function(t){return new Float32Array(t)},X._$vb=function(t){return new Int16Array(t)},X._$cr=function(t,e){return null==t||t._$yL()<e.length?((t=X._$9r(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},X._$mb=function(t,e){return null==t||t._$yL()<e.length?((t=X._$vb(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},X._$Hs=function(){return X._$Gr},X._$as=function(t){X._$Gr=t},X.prototype.setGL=function(t){this.gl=t},X.prototype.setTransform=function(t){this.transform=t},X.prototype._$ZT=function(){},X.prototype._$Uo=function(t,e,i,s,r,o,n,a){if(!(o<.01)){var l=this._$U2[t],u=o>.9?ut.EXPAND_W:0;this.gl.drawElements(l,i,s,r,o,u,this.transform,a)}},X.prototype._$Rs=function(){throw new Error("_$Rs")},X.prototype._$Ds=function(t){throw new Error("_$Ds")},X.prototype._$K2=function(){for(var t=0;t<this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$Sr(1,this._$sb,t),this._$sb[t]=0)}},X.prototype.setTexture=function(t,e){this._$sb.length<t+1&&this._$nS(t),this._$sb[t]=e},X.prototype.setTexture=function(t,e){this._$sb.length<t+1&&this._$nS(t),this._$U2[t]=e},X.prototype._$nS=function(t){var e=Math.max(2*this._$sb.length,t+1+10),i=new Int32Array(e);F._$jT(this._$sb,0,i,0,this._$sb.length),this._$sb=i;var s=new Array;F._$jT(this._$U2,0,s,0,this._$U2.length),this._$U2=s},H.prototype=new C,H._$Xo=new Float32Array(2),H._$io=new Float32Array(2),H._$0o=new Float32Array(2),H._$Lo=new Float32Array(2),H._$To=new Float32Array(2),H._$Po=new Float32Array(2),H._$gT=new Array,H.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP(),this._$Y0=new Array},H.prototype.getType=function(){return C._$c2},H.prototype._$F0=function(t){C.prototype._$F0.call(this,t),this._$GS=t._$nP(),this._$Y0=t._$nP(),C.prototype.readV2_opacity.call(this,t)},H.prototype.init=function(t){var e=new q(this);return e._$Yr=new v,this._$32()&&(e._$Wr=new v),e},H.prototype._$Nr=function(t,e){this!=e._$GT()&&console.log("### assert!! ### ");var i=e;if(this._$GS._$Ur(t)){var s=H._$gT;s[0]=!1;var r=this._$GS._$Q2(t,s);e._$Ib(s[0]),this.interpolateOpacity(t,this._$GS,e,s);var o=t._$vs(),n=t._$Tr();if(this._$GS._$zr(o,n,r),r<=0){var a=this._$Y0[o[0]];i._$Yr.init(a)}else if(1==r){a=this._$Y0[o[0]];var l=this._$Y0[o[1]],u=n[0];i._$Yr._$fL=a._$fL+(l._$fL-a._$fL)*u,i._$Yr._$gL=a._$gL+(l._$gL-a._$gL)*u,i._$Yr._$B0=a._$B0+(l._$B0-a._$B0)*u,i._$Yr._$z0=a._$z0+(l._$z0-a._$z0)*u,i._$Yr._$qT=a._$qT+(l._$qT-a._$qT)*u}else if(2==r){a=this._$Y0[o[0]],l=this._$Y0[o[1]];var h=this._$Y0[o[2]],_=this._$Y0[o[3]],c=(u=n[0],n[1]),d=a._$fL+(l._$fL-a._$fL)*u,m=h._$fL+(_._$fL-h._$fL)*u;i._$Yr._$fL=d+(m-d)*c,d=a._$gL+(l._$gL-a._$gL)*u,m=h._$gL+(_._$gL-h._$gL)*u,i._$Yr._$gL=d+(m-d)*c,d=a._$B0+(l._$B0-a._$B0)*u,m=h._$B0+(_._$B0-h._$B0)*u,i._$Yr._$B0=d+(m-d)*c,d=a._$z0+(l._$z0-a._$z0)*u,m=h._$z0+(_._$z0-h._$z0)*u,i._$Yr._$z0=d+(m-d)*c,d=a._$qT+(l._$qT-a._$qT)*u,m=h._$qT+(_._$qT-h._$qT)*u,i._$Yr._$qT=d+(m-d)*c}else if(3==r){var p=this._$Y0[o[0]],g=this._$Y0[o[1]],f=this._$Y0[o[2]],y=this._$Y0[o[3]],$=this._$Y0[o[4]],S=this._$Y0[o[5]],v=this._$Y0[o[6]],x=this._$Y0[o[7]],b=(u=n[0],c=n[1],n[2]),P=(d=p._$fL+(g._$fL-p._$fL)*u,m=f._$fL+(y._$fL-f._$fL)*u,$._$fL+(S._$fL-$._$fL)*u),w=v._$fL+(x._$fL-v._$fL)*u;i._$Yr._$fL=(1-b)*(d+(m-d)*c)+b*(P+(w-P)*c),d=p._$gL+(g._$gL-p._$gL)*u,m=f._$gL+(y._$gL-f._$gL)*u,P=$._$gL+(S._$gL-$._$gL)*u,w=v._$gL+(x._$gL-v._$gL)*u,i._$Yr._$gL=(1-b)*(d+(m-d)*c)+b*(P+(w-P)*c),d=p._$B0+(g._$B0-p._$B0)*u,m=f._$B0+(y._$B0-f._$B0)*u,P=$._$B0+(S._$B0-$._$B0)*u,w=v._$B0+(x._$B0-v._$B0)*u,i._$Yr._$B0=(1-b)*(d+(m-d)*c)+b*(P+(w-P)*c),d=p._$z0+(g._$z0-p._$z0)*u,m=f._$z0+(y._$z0-f._$z0)*u,P=$._$z0+(S._$z0-$._$z0)*u,w=v._$z0+(x._$z0-v._$z0)*u,i._$Yr._$z0=(1-b)*(d+(m-d)*c)+b*(P+(w-P)*c),d=p._$qT+(g._$qT-p._$qT)*u,m=f._$qT+(y._$qT-f._$qT)*u,P=$._$qT+(S._$qT-$._$qT)*u,w=v._$qT+(x._$qT-v._$qT)*u,i._$Yr._$qT=(1-b)*(d+(m-d)*c)+b*(P+(w-P)*c)}else if(4==r){var L=this._$Y0[o[0]],T=this._$Y0[o[1]],M=this._$Y0[o[2]],C=this._$Y0[o[3]],F=this._$Y0[o[4]],I=this._$Y0[o[5]],E=this._$Y0[o[6]],D=this._$Y0[o[7]],B=this._$Y0[o[8]],A=this._$Y0[o[9]],R=this._$Y0[o[10]],k=this._$Y0[o[11]],j=this._$Y0[o[12]],V=this._$Y0[o[13]],O=this._$Y0[o[14]],N=this._$Y0[o[15]],U=(u=n[0],c=n[1],b=n[2],n[3]),z=(d=L._$fL+(T._$fL-L._$fL)*u,m=M._$fL+(C._$fL-M._$fL)*u,P=F._$fL+(I._$fL-F._$fL)*u,w=E._$fL+(D._$fL-E._$fL)*u,B._$fL+(A._$fL-B._$fL)*u),G=R._$fL+(k._$fL-R._$fL)*u,Y=j._$fL+(V._$fL-j._$fL)*u,X=O._$fL+(N._$fL-O._$fL)*u;i._$Yr._$fL=(1-U)*((1-b)*(d+(m-d)*c)+b*(P+(w-P)*c))+U*((1-b)*(z+(G-z)*c)+b*(Y+(X-Y)*c)),d=L._$gL+(T._$gL-L._$gL)*u,m=M._$gL+(C._$gL-M._$gL)*u,P=F._$gL+(I._$gL-F._$gL)*u,w=E._$gL+(D._$gL-E._$gL)*u,z=B._$gL+(A._$gL-B._$gL)*u,G=R._$gL+(k._$gL-R._$gL)*u,Y=j._$gL+(V._$gL-j._$gL)*u,X=O._$gL+(N._$gL-O._$gL)*u,i._$Yr._$gL=(1-U)*((1-b)*(d+(m-d)*c)+b*(P+(w-P)*c))+U*((1-b)*(z+(G-z)*c)+b*(Y+(X-Y)*c)),d=L._$B0+(T._$B0-L._$B0)*u,m=M._$B0+(C._$B0-M._$B0)*u,P=F._$B0+(I._$B0-F._$B0)*u,w=E._$B0+(D._$B0-E._$B0)*u,z=B._$B0+(A._$B0-B._$B0)*u,G=R._$B0+(k._$B0-R._$B0)*u,Y=j._$B0+(V._$B0-j._$B0)*u,X=O._$B0+(N._$B0-O._$B0)*u,i._$Yr._$B0=(1-U)*((1-b)*(d+(m-d)*c)+b*(P+(w-P)*c))+U*((1-b)*(z+(G-z)*c)+b*(Y+(X-Y)*c)),d=L._$z0+(T._$z0-L._$z0)*u,m=M._$z0+(C._$z0-M._$z0)*u,P=F._$z0+(I._$z0-F._$z0)*u,w=E._$z0+(D._$z0-E._$z0)*u,z=B._$z0+(A._$z0-B._$z0)*u,G=R._$z0+(k._$z0-R._$z0)*u,Y=j._$z0+(V._$z0-j._$z0)*u,X=O._$z0+(N._$z0-O._$z0)*u,i._$Yr._$z0=(1-U)*((1-b)*(d+(m-d)*c)+b*(P+(w-P)*c))+U*((1-b)*(z+(G-z)*c)+b*(Y+(X-Y)*c)),d=L._$qT+(T._$qT-L._$qT)*u,m=M._$qT+(C._$qT-M._$qT)*u,P=F._$qT+(I._$qT-F._$qT)*u,w=E._$qT+(D._$qT-E._$qT)*u,z=B._$qT+(A._$qT-B._$qT)*u,G=R._$qT+(k._$qT-R._$qT)*u,Y=j._$qT+(V._$qT-j._$qT)*u,X=O._$qT+(N._$qT-O._$qT)*u,i._$Yr._$qT=(1-U)*((1-b)*(d+(m-d)*c)+b*(P+(w-P)*c))+U*((1-b)*(z+(G-z)*c)+b*(Y+(X-Y)*c))}else{for(var q=0|Math.pow(2,r),W=new Float32Array(q),J=0;J<q;J++){for(var Q=J,Z=1,K=0;K<r;K++)Z*=Q%2==0?1-n[K]:n[K],Q/=2;W[J]=Z}for(var tt=new Array,et=0;et<q;et++)tt[et]=this._$Y0[o[et]];var it=0,st=0,rt=0,ot=0,nt=0;for(et=0;et<q;et++)it+=W[et]*tt[et]._$fL,st+=W[et]*tt[et]._$gL,rt+=W[et]*tt[et]._$B0,ot+=W[et]*tt[et]._$z0,nt+=W[et]*tt[et]._$qT;i._$Yr._$fL=it,i._$Yr._$gL=st,i._$Yr._$B0=rt,i._$Yr._$z0=ot,i._$Yr._$qT=nt}a=this._$Y0[o[0]];i._$Yr.reflectX=a.reflectX,i._$Yr.reflectY=a.reflectY}},H.prototype._$2b=function(t,e){this!=e._$GT()&&console.log("### assert!! ### ");var i=e;if(i._$hS(!0),this._$32()){var s=this.getTargetBaseDataID();if(i._$8r==C._$ur&&(i._$8r=t.getBaseDataIndex(s)),i._$8r<0)ut._$so&&l._$li("_$L _$0P _$G :: %s",s),i._$hS(!1);else{var r=t.getBaseData(i._$8r);if(null!=r){var o=t._$q2(i._$8r),n=H._$Xo;n[0]=i._$Yr._$fL,n[1]=i._$Yr._$gL;var a=H._$io;a[0]=0,a[1]=-.1,o._$GT().getType()==C._$c2?a[1]=-10:a[1]=-.1;var u=H._$0o;this._$Jr(t,r,o,n,a,u);var h=wt._$92(a,u);r._$nb(t,o,n,n,1,0,2),i._$Wr._$fL=n[0],i._$Wr._$gL=n[1],i._$Wr._$B0=i._$Yr._$B0,i._$Wr._$z0=i._$Yr._$z0,i._$Wr._$qT=i._$Yr._$qT-h*wt._$NS;var _=o.getTotalScale();i.setTotalScale_notForClient(_*i._$Wr._$B0);var c=o.getTotalOpacity();i.setTotalOpacity(c*i.getInterpolatedOpacity()),i._$Wr.reflectX=i._$Yr.reflectX,i._$Wr.reflectY=i._$Yr.reflectY,i._$hS(o._$yo())}else i._$hS(!1)}}else i.setTotalScale_notForClient(i._$Yr._$B0),i.setTotalOpacity(i.getInterpolatedOpacity())},H.prototype._$nb=function(t,e,i,s,r,o,n){this!=e._$GT()&&console.log("### assert!! ### ");for(var a,l,u=e,h=null!=u._$Wr?u._$Wr:u._$Yr,_=Math.sin(wt._$bS*h._$qT),c=Math.cos(wt._$bS*h._$qT),d=u.getTotalScale(),m=h.reflectX?-1:1,p=h.reflectY?-1:1,g=c*d*m,f=-_*d*p,y=_*d*m,$=c*d*p,S=h._$fL,v=h._$gL,x=r*n,b=o;b<x;b+=n)a=i[b],l=i[b+1],s[b]=g*a+f*l+S,s[b+1]=y*a+$*l+v},H.prototype._$Jr=function(t,e,i,s,r,o){e!=i._$GT()&&console.log("### assert!! ### ");var n=H._$Lo;H._$Lo[0]=s[0],H._$Lo[1]=s[1],e._$nb(t,i,n,n,1,0,2);for(var a=H._$To,l=H._$Po,u=1,h=0;h<10;h++){if(l[0]=s[0]+u*r[0],l[1]=s[1]+u*r[1],e._$nb(t,i,l,a,1,0,2),a[0]-=n[0],a[1]-=n[1],0!=a[0]||0!=a[1])return o[0]=a[0],void(o[1]=a[1]);if(l[0]=s[0]-u*r[0],l[1]=s[1]-u*r[1],e._$nb(t,i,l,a,1,0,2),a[0]-=n[0],a[1]-=n[1],0!=a[0]||0!=a[1])return a[0]=-a[0],a[0]=-a[0],o[0]=a[0],void(o[1]=a[1]);u*=.1}ut._$so&&console.log("_$L0 to transform _$SP\n")},q.prototype=new lt,W.prototype=new L,W._$ur=-2,W._$ES=500,W._$wb=2,W._$8S=3,W._$os=4,W._$52=W._$ES,W._$R2=W._$ES,W._$Sb=function(t){for(var e=t.length-1;e>=0;--e){var i=t[e];i<W._$52?W._$52=i:i>W._$R2&&(W._$R2=i)}},W._$or=function(){return W._$52},W._$Pr=function(){return W._$R2},W.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=N._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=null,W._$Sb(this._$Lb)},W.prototype.getClipIDList=function(){return this.clipIDList},W.prototype._$Nr=function(t,e){if(e._$IS[0]=!1,e._$Us=P._$Z2(t,this._$GS,e._$IS,this._$Lb),ut._$Zs);else if(e._$IS[0])return;e._$7s=P._$br(t,this._$GS,e._$IS,this._$mS)},W.prototype._$2b=function(t){},W.prototype.getDrawDataID=function(){return this._$gP},W.prototype._$j2=function(t){this._$gP=t},W.prototype.getOpacity=function(t,e){return e._$7s},W.prototype._$zS=function(t,e){return e._$Us},W.prototype.getTargetBaseDataID=function(){return this._$dr},W.prototype._$gs=function(t){this._$dr=t},W.prototype._$32=function(){return null!=this._$dr&&this._$dr!=$t._$2o()},W.prototype.getType=function(){},J._$42=0,J.prototype._$1b=function(){return this._$3S},J.prototype.getDrawDataList=function(){return this._$aS},J.prototype._$F0=function(t){this._$NL=t._$nP(),this._$aS=t._$nP(),this._$3S=t._$nP()},J.prototype._$kr=function(t){t._$Zo(this._$3S),t._$xo(this._$aS),this._$3S=null,this._$aS=null},Q.prototype=new i,Q.loadModel=function(t){var e=new Q;return i._$62(e,t),e},Q.loadModel=function(t){var e=new Q;return i._$62(e,t),e},Q._$to=function(){return new Q},Q._$er=function(t){var e=new _$5("../_$_r/_$t0/_$Ri/_$_P._$d");if(0==e.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+e._$PL());for(var i=["../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1"],s=Q.loadModel(e._$3b()),r=0;r<i.length;r++){var o=new _$5(i[r]);if(0==o.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+o._$PL());s.setTexture(r,_$nL._$_o(t,o._$3b()))}return s},Q.prototype.setGL=function(t){this._$zo.setGL(t)},Q.prototype.setTransform=function(t){this._$zo.setTransform(t)},Q.prototype.draw=function(){this._$5S.draw(this._$zo)},Q.prototype._$K2=function(){this._$zo._$K2()},Q.prototype.setTexture=function(t,e){null==this._$zo&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this._$zo.setTexture(t,e)},Q.prototype.setTexture=function(t,e){null==this._$zo&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this._$zo.setTexture(t,e)},Q.prototype._$Rs=function(){return this._$zo._$Rs()},Q.prototype._$Ds=function(t){this._$zo._$Ds(t)},Q.prototype.getDrawParam=function(){return this._$zo},Z.prototype=new a,Z._$cs="VISIBLE:",Z._$ar="LAYOUT:",Z.MTN_PREFIX_FADEIN="FADEIN:",Z.MTN_PREFIX_FADEOUT="FADEOUT:",Z._$Co=0,Z._$1T=1,Z.loadMotion=function(t){var e=z._$C(t);return Z.loadMotion(e)},Z.loadMotion=function(t){t instanceof ArrayBuffer&&(t=new DataView(t));var e=new Z,i=[0],s=t.byteLength;e._$yT=0;for(var r=0;r<s;++r){var o=K(t,r),n=o.charCodeAt(0);if("\n"!=o&&"\r"!=o)if("#"!=o)if("$"!=o){if(97<=n&&n<=122||65<=n&&n<=90||"_"==o){for(_=r,c=-1;r<s&&("\r"!=(o=K(t,r))&&"\n"!=o);++r)if("="==o){c=r;break}if(c>=0){var a=new V;E.startsWith(t,_,Z._$cs)?(a._$RP=V._$hs,a._$4P=E.createString(t,_,c-_)):E.startsWith(t,_,Z._$ar)?(a._$4P=E.createString(t,_+7,c-_-7),E.startsWith(t,_+7,"ANCHOR_X")?a._$RP=V._$xs:E.startsWith(t,_+7,"ANCHOR_Y")?a._$RP=V._$us:E.startsWith(t,_+7,"SCALE_X")?a._$RP=V._$qs:E.startsWith(t,_+7,"SCALE_Y")?a._$RP=V._$Ys:E.startsWith(t,_+7,"X")?a._$RP=V._$ws:E.startsWith(t,_+7,"Y")&&(a._$RP=V._$Ns)):(a._$RP=V._$Fr,a._$4P=E.createString(t,_,c-_)),e.motions.push(a);var l=0,u=[];for(r=c+1;r<s&&("\r"!=(o=K(t,r))&&"\n"!=o);++r)if(","!=o&&" "!=o&&"\t"!=o){m=E._$LS(t,s,r,i);if(i[0]>0){u.push(m),l++;var h=i[0];if(h<r){console.log("_$n0 _$hi . @Live2DMotion loadMotion()\n");break}r=h-1}}a._$I0=new Float32Array(u),l>e._$yT&&(e._$yT=l)}}}else{for(var _=r,c=-1;r<s&&("\r"!=(o=K(t,r))&&"\n"!=o);++r)if("="==o){c=r;break}var d=!1;if(c>=0)for(c==_+4&&"f"==K(t,_+1)&&"p"==K(t,_+2)&&"s"==K(t,_+3)&&(d=!0),r=c+1;r<s&&("\r"!=(o=K(t,r))&&"\n"!=o);++r)if(","!=o&&" "!=o&&"\t"!=o){var m=E._$LS(t,s,r,i);i[0]>0&&d&&5<m&&m<121&&(e._$D0=m),r=i[0]}for(;r<s&&("\n"!=K(t,r)&&"\r"!=K(t,r));++r);}else for(;r<s&&("\n"!=K(t,r)&&"\r"!=K(t,r));++r);}return e._$rr=1e3*e._$yT/e._$D0|0,e},Z.prototype.getDurationMSec=function(){return this._$E?-1:this._$rr},Z.prototype.getLoopDurationMSec=function(){return this._$rr},Z.prototype.dump=function(){for(var t=0;t<this.motions.length;t++){var e=this.motions[t];console.log("_$wL[%s] [%d]. ",e._$4P,e._$I0.length);for(var i=0;i<e._$I0.length&&i<10;i++)console.log("%5.2f ,",e._$I0[i]);console.log("\n")}},Z.prototype.updateParamExe=function(t,e,i,s){for(var r=(e-s._$z2)*this._$D0/1e3,o=0|r,n=r-o,a=0;a<this.motions.length;a++){var l=this.motions[a],u=l._$I0.length,h=l._$4P;if(l._$RP==V._$hs){var _=l._$I0[o>=u?u-1:o];t.setParamFloat(h,_)}else if(V._$ws<=l._$RP&&l._$RP<=V._$Ys);else{var c=t.getParamIndex(h),d=t.getModelContext(),m=.4*(d.getParamMax(c)-d.getParamMin(c)),p=d.getParamFloat(c),g=l._$I0[o>=u?u-1:o],f=l._$I0[o+1>=u?u-1:o+1],y=p+((g<f&&f-g>m||g>f&&g-f>m?g:g+(f-g)*n)-p)*i;t.setParamFloat(h,y)}}o>=this._$yT&&(this._$E?(s._$z2=e,this.loopFadeIn&&(s._$bs=e)):s._$9L=!0),this._$eP=i},Z.prototype._$r0=function(){return this._$E},Z.prototype._$aL=function(t){this._$E=t},Z.prototype._$S0=function(){return this._$D0},Z.prototype._$U0=function(t){this._$D0=t},Z.prototype.isLoopFadeIn=function(){return this.loopFadeIn},Z.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},j.prototype.clear=function(){this.size=0},j.prototype.add=function(t){if(this._$P.length<=this.size){var e=new Float32Array(2*this.size);F._$jT(this._$P,0,e,0,this.size),this._$P=e}this._$P[this.size++]=t},j.prototype._$BL=function(){var t=new Float32Array(this.size);return F._$jT(this._$P,0,t,0,this.size),t},V._$Fr=0,V._$hs=1,V._$ws=100,V._$Ns=101,V._$xs=102,V._$us=103,V._$qs=104,V._$Ys=105,tt.prototype=new C,tt._$gT=new Array,tt.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP()},tt.prototype._$F0=function(t){C.prototype._$F0.call(this,t),this._$A=t._$6L(),this._$o=t._$6L(),this._$GS=t._$nP(),this._$Eo=t._$nP(),C.prototype.readV2_opacity.call(this,t)},tt.prototype.init=function(t){var e=new et(this),i=(this._$o+1)*(this._$A+1);return null!=e._$Cr&&(e._$Cr=null),e._$Cr=new Float32Array(2*i),null!=e._$hr&&(e._$hr=null),this._$32()?e._$hr=new Float32Array(2*i):e._$hr=null,e},tt.prototype._$Nr=function(t,e){var i=e;if(this._$GS._$Ur(t)){var s=this._$VT(),r=tt._$gT;r[0]=!1,P._$Vr(t,this._$GS,r,s,this._$Eo,i._$Cr,0,2),e._$Ib(r[0]),this.interpolateOpacity(t,this._$GS,e,r)}},tt.prototype._$2b=function(t,e){var i=e;if(i._$hS(!0),this._$32()){var s=this.getTargetBaseDataID();if(i._$8r==C._$ur&&(i._$8r=t.getBaseDataIndex(s)),i._$8r<0)ut._$so&&l._$li("_$L _$0P _$G :: %s",s),i._$hS(!1);else{var r=t.getBaseData(i._$8r),o=t._$q2(i._$8r);if(null!=r&&o._$yo()){var n=o.getTotalScale();i.setTotalScale_notForClient(n);var a=o.getTotalOpacity();i.setTotalOpacity(a*i.getInterpolatedOpacity()),r._$nb(t,o,i._$Cr,i._$hr,this._$VT(),0,2),i._$hS(!0)}else i._$hS(!1)}}else i.setTotalOpacity(i.getInterpolatedOpacity())},tt.prototype._$nb=function(t,e,i,s,r,o,n){var a=e,l=null!=a._$hr?a._$hr:a._$Cr;tt.transformPoints_sdk2(i,s,r,o,n,l,this._$o,this._$A)},tt.transformPoints_sdk2=function(e,i,s,r,o,n,a,l){for(var u,h,_,c=s*o,d=0,m=0,p=0,g=0,f=0,y=0,$=!1,S=r;S<c;S+=o){var v,x,b,P;if(b=e[S],x=(P=e[S+1])*l,(v=b*a)<0||x<0||a<=v||l<=x){var w=a+1;if(!$){$=!0,d=.25*(n[2*(0+0*w)]+n[2*(a+0*w)]+n[2*(0+l*w)]+n[2*(a+l*w)]),m=.25*(n[2*(0+0*w)+1]+n[2*(a+0*w)+1]+n[2*(0+l*w)+1]+n[2*(a+l*w)+1]);var L=n[2*(a+l*w)]-n[2*(0+0*w)],T=n[2*(a+l*w)+1]-n[2*(0+0*w)+1],M=n[2*(a+0*w)]-n[2*(0+l*w)],C=n[2*(a+0*w)+1]-n[2*(0+l*w)+1];d-=.5*((p=.5*(L+M))+(f=.5*(L-M))),m-=.5*((g=.5*(T+C))+(y=.5*(T-C)))}if(-2<b&&b<3&&-2<P&&P<3)if(b<=0)if(P<=0){var F=n[2*(0+0*w)],I=n[2*(0+0*w)+1],E=d-2*p,D=m-2*g,B=d-2*f,A=m-2*y,R=d-2*p-2*f,k=m-2*g-2*y;(j=.5*(b- -2))+(V=.5*(P- -2))<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else if(P>=1){B=n[2*(0+l*w)],A=n[2*(0+l*w)+1],R=d-2*p+1*f,k=m-2*g+1*y,F=d+3*f,I=m+3*y,E=d-2*p+3*f,D=m-2*g+3*y;(j=.5*(b- -2))+(V=.5*(P-1))<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else{(U=0|x)==l&&(U=l-1);var j=.5*(b- -2),V=x-U,O=U/l,N=(U+1)/l;B=n[2*(0+U*w)],A=n[2*(0+U*w)+1],F=n[2*(0+(U+1)*w)],I=n[2*(0+(U+1)*w)+1],R=d-2*p+O*f,k=m-2*g+O*y,E=d-2*p+N*f,D=m-2*g+N*y;j+V<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else if(1<=b)if(P<=0){E=n[2*(a+0*w)],D=n[2*(a+0*w)+1],F=d+3*p,I=m+3*g,R=d+1*p-2*f,k=m+1*g-2*y,B=d+3*p-2*f,A=m+3*g-2*y;(j=.5*(b-1))+(V=.5*(P- -2))<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else if(P>=1){R=n[2*(a+l*w)],k=n[2*(a+l*w)+1],B=d+3*p+1*f,A=m+3*g+1*y,E=d+1*p+3*f,D=m+1*g+3*y,F=d+3*p+3*f,I=m+3*g+3*y;(j=.5*(b-1))+(V=.5*(P-1))<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else{var U;(U=0|x)==l&&(U=l-1);j=.5*(b-1),V=x-U,O=U/l,N=(U+1)/l,R=n[2*(a+U*w)],k=n[2*(a+U*w)+1],E=n[2*(a+(U+1)*w)],D=n[2*(a+(U+1)*w)+1],B=d+3*p+O*f,A=m+3*g+O*y,F=d+3*p+N*f,I=m+3*g+N*y;j+V<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else if(P<=0){(Y=0|v)==a&&(Y=a-1);j=v-Y,V=.5*(P- -2);var z=Y/a,G=(Y+1)/a;E=n[2*(Y+0*w)],D=n[2*(Y+0*w)+1],F=n[2*(Y+1+0*w)],I=n[2*(Y+1+0*w)+1],R=d+z*p-2*f,k=m+z*g-2*y,B=d+G*p-2*f,A=m+G*g-2*y;j+V<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else if(P>=1){var Y;(Y=0|v)==a&&(Y=a-1);j=v-Y,V=.5*(P-1),z=Y/a,G=(Y+1)/a,R=n[2*(Y+l*w)],k=n[2*(Y+l*w)+1],B=n[2*(Y+1+l*w)],A=n[2*(Y+1+l*w)+1],E=d+z*p+3*f,D=m+z*g+3*y,F=d+G*p+3*f,I=m+G*g+3*y;j+V<=1?(i[S]=R+(B-R)*j+(E-R)*V,i[S+1]=k+(A-k)*j+(D-k)*V):(i[S]=F+(E-F)*(1-j)+(B-F)*(1-V),i[S+1]=I+(D-I)*(1-j)+(A-I)*(1-V))}else t.err.printf("_$li calc : %.4f , %.4f\t\t\t\t\t@@BDBoxGrid\n",b,P);else i[S]=d+b*p+P*f,i[S+1]=m+b*g+P*y}else u=2*((0|v)+(0|x)*(a+1)),(h=v-(0|v))+(_=x-(0|x))<1?(i[S]=n[u]*(1-h-_)+n[u+2]*h+n[u+2*(a+1)]*_,i[S+1]=n[u+1]*(1-h-_)+n[u+3]*h+n[u+2*(a+1)+1]*_):(i[S]=n[u+2*(a+1)+2]*(h-1+_)+n[u+2*(a+1)]*(1-h)+n[u+2]*(1-_),i[S+1]=n[u+2*(a+1)+3]*(h-1+_)+n[u+2*(a+1)+1]*(1-h)+n[u+3]*(1-_))}},tt.prototype.transformPoints_sdk1=function(t,e,i,s,r,o,n){for(var a,l,u,h,_,c,d,m=e,p=this._$o,g=this._$A,f=r*n,y=null!=m._$hr?m._$hr:m._$Cr,$=o;$<f;$+=n)ut._$ts?((a=i[$])<0?a=0:a>1&&(a=1),(l=i[$+1])<0?l=0:l>1&&(l=1),(u=0|(a*=p))>p-1&&(u=p-1),(h=0|(l*=g))>g-1&&(h=g-1),c=a-u,d=l-h,_=2*(u+h*(p+1))):(c=(a=i[$]*p)-(0|a),d=(l=i[$+1]*g)-(0|l),_=2*((0|a)+(0|l)*(p+1))),c+d<1?(s[$]=y[_]*(1-c-d)+y[_+2]*c+y[_+2*(p+1)]*d,s[$+1]=y[_+1]*(1-c-d)+y[_+3]*c+y[_+2*(p+1)+1]*d):(s[$]=y[_+2*(p+1)+2]*(c-1+d)+y[_+2*(p+1)]*(1-c)+y[_+2]*(1-d),s[$+1]=y[_+2*(p+1)+3]*(c-1+d)+y[_+2*(p+1)+1]*(1-c)+y[_+3]*(1-d))},tt.prototype._$VT=function(){return(this._$o+1)*(this._$A+1)},tt.prototype.getType=function(){return C._$_b},et.prototype=new lt,it._$42=0,it.prototype._$zP=function(){this._$3S=new Array,this._$aS=new Array},it.prototype._$F0=function(t){this._$g0=t._$8L(),this.visible=t._$8L(),this._$NL=t._$nP(),this._$3S=t._$nP(),this._$aS=t._$nP()},it.prototype.init=function(t){var e=new st(this);return e.setPartsOpacity(this.isVisible()?1:0),e},it.prototype._$6o=function(t){if(null==this._$3S)throw new Error("_$3S _$6 _$Wo@_$6o");this._$3S.push(t)},it.prototype._$3o=function(t){if(null==this._$aS)throw new Error("_$aS _$6 _$Wo@_$3o");this._$aS.push(t)},it.prototype._$Zo=function(t){this._$3S=t},it.prototype._$xo=function(t){this._$aS=t},it.prototype.isVisible=function(){return this.visible},it.prototype._$uL=function(){return this._$g0},it.prototype._$KP=function(t){this.visible=t},it.prototype._$ET=function(t){this._$g0=t},it.prototype.getBaseData=function(){return this._$3S},it.prototype.getDrawData=function(){return this._$aS},it.prototype._$p2=function(){return this._$NL},it.prototype._$ob=function(t){this._$NL=t},it.prototype.getPartsID=function(){return this._$NL},it.prototype._$MP=function(t){this._$NL=t},st.prototype=new function(){},st.prototype.getPartsOpacity=function(){return this._$VS},st.prototype.setPartsOpacity=function(t){this._$VS=t},rt._$L7=function(){c._$27(),$t._$27(),A._$27(),_._$27()},rt.prototype.toString=function(){return this.id},ot.prototype._$1s=function(){return this._$4S},ot.prototype._$zP=function(){this._$4S=new Array},ot.prototype._$F0=function(t){this._$4S=t._$nP()},ot.prototype._$Ks=function(t){this._$4S.push(t)},nt.tr=new yt,nt._$50=new yt,nt._$Ti=new Array(0,0),nt._$Pi=new Array(0,0),nt._$B=new Array(0,0),nt.prototype._$lP=function(t,e,i,s){this.viewport=new Array(t,e,i,s)},nt.prototype._$bL=function(){this.context.save();var t=this.viewport;null!=t&&(this.context.beginPath(),this.context._$Li(t[0],t[1],t[2],t[3]),this.context.clip())},nt.prototype._$ei=function(){this.context.restore()},nt.prototype.drawElements=function(t,e,i,s,r,o,n,a){try{r!=this._$Qo&&(this._$Qo=r,this.context.globalAlpha=r);for(var u=e.length,h=t.width,_=t.height,c=this.context,d=this._$xP,m=this._$uP,p=this._$6r,g=this._$3r,f=nt.tr,y=nt._$Ti,$=nt._$Pi,S=nt._$B,v=0;v<u;v+=3){c.save();var b=e[v],P=e[v+1],w=e[v+2],L=d+p*i[2*b],T=m+g*i[2*b+1],M=d+p*i[2*P],C=m+g*i[2*P+1],F=d+p*i[2*w],I=m+g*i[2*w+1];n&&(n._$PS(L,T,S),L=S[0],T=S[1],n._$PS(M,C,S),M=S[0],C=S[1],n._$PS(F,I,S),F=S[0],I=S[1]);var E=h*s[2*b],D=_-_*s[2*b+1],B=h*s[2*P],A=_-_*s[2*P+1],R=h*s[2*w],k=_-_*s[2*w+1],j=Math.atan2(A-D,B-E),V=Math.atan2(C-T,M-L),O=M-L,N=C-T,U=Math.sqrt(O*O+N*N),z=B-E,G=A-D,Y=U/Math.sqrt(z*z+G*G);x._$ni(R,k,E,D,B-E,A-D,-(A-D),B-E,y),x._$ni(F,I,L,T,M-L,C-T,-(C-T),M-L,$);var X=($[0]-y[0])/y[1],H=Math.min(E,B,R),q=Math.max(E,B,R),W=Math.min(D,A,k),J=Math.max(D,A,k),Q=Math.floor(H),Z=Math.floor(W),K=Math.ceil(q),tt=Math.ceil(J);f.identity(),f.translate(L,T),f.rotate(V),f.scale(1,$[1]/y[1]),f.shear(X,0),f.scale(Y,Y),f.rotate(-j),f.translate(-E,-D),f.setContext(c);if(o||(o=1.2),ut.IGNORE_EXPAND&&(o=0),ut.USE_CACHED_POLYGON_IMAGE){var et=a._$e0;if(et.gl_cacheImage=et.gl_cacheImage||{},!et.gl_cacheImage[v]){var it=nt.createCanvas(K-Q,tt-Z);ut.DEBUG_DATA.LDGL_CANVAS_MB=ut.DEBUG_DATA.LDGL_CANVAS_MB||0,ut.DEBUG_DATA.LDGL_CANVAS_MB+=(K-Q)*(tt-Z)*4;var st=it.getContext("2d");st.translate(-Q,-Z),nt.clip(st,f,o,U,E,D,B,A,R,k,L,T,M,C,F,I),st.drawImage(t,0,0),et.gl_cacheImage[v]={cacheCanvas:it,cacheContext:st}}c.drawImage(et.gl_cacheImage[v].cacheCanvas,Q,Z)}else ut.IGNORE_CLIP||nt.clip(c,f,o,U,E,D,B,A,R,k,L,T,M,C,F,I),ut.USE_ADJUST_TRANSLATION&&(H=0,q=h,W=0,J=_),c.drawImage(t,H,W,q-H,J-W,H,W,q-H,J-W);c.restore()}}catch(t){l._$Rb(t)}},nt.clip=function(t,e,i,s,r,o,n,a,l,u,h,_,c,d,m,p){i>.02?nt.expandClip(t,e,i,s,h,_,c,d,m,p):nt.clipWithTransform(t,null,r,o,n,a,l,u)},nt.expandClip=function(t,e,i,s,r,o,n,a,l,u){var h=n-r,_=a-o,c=l-r,d=u-o,m=h*d-_*c>0?i:-i,p=-_,g=h,f=l-n,y=u-a,$=-y,S=f,v=Math.sqrt(f*f+y*y),x=-d,b=c,P=Math.sqrt(c*c+d*d),w=r-m*p/s,L=o-m*g/s,T=n-m*p/s,M=a-m*g/s,C=n-m*$/v,F=a-m*S/v,I=l-m*$/v,E=u-m*S/v,D=r+m*x/P,B=o+m*b/P,A=l+m*x/P,R=u+m*b/P,k=nt._$50;return null!=e._$P2(k)&&(nt.clipWithTransform(t,k,w,L,T,M,C,F,I,E,A,R,D,B),!0)},nt.clipWithTransform=function(t,e,i,s,r,o,n,a){if(arguments.length<7)l._$li("err : @LDGL.clip()");else if(arguments[1]instanceof yt){var u=nt._$B,h=e,_=arguments;if(t.beginPath(),h){h._$PS(_[2],_[3],u),t.moveTo(u[0],u[1]);for(var c=4;c<_.length;c+=2)h._$PS(_[c],_[c+1],u),t.lineTo(u[0],u[1])}else{t.moveTo(_[2],_[3]);for(c=4;c<_.length;c+=2)t.lineTo(_[c],_[c+1])}t.clip()}else l._$li("err : a[0] is _$6 LDTransform @LDGL.clip()")},nt.createCanvas=function(t,e){var i=document.createElement("canvas");return i.setAttribute("width",t),i.setAttribute("height",e),i||l._$li("err : "+i),i},nt.dumpValues=function(){for(var t="",e=0;e<arguments.length;e++)t+="["+e+"]= "+arguments[e].toFixed(3)+" , ";console.log(t)},at.prototype._$F0=function(t){this._$TT=t._$_T(),this._$LT=t._$_T(),this._$FS=t._$_T(),this._$wL=t._$nP()},at.prototype.getMinValue=function(){return this._$TT},at.prototype.getMaxValue=function(){return this._$LT},at.prototype.getDefaultValue=function(){return this._$FS},at.prototype.getParamID=function(){return this._$wL},lt.prototype._$yo=function(){return this._$AT&&!this._$JS},lt.prototype._$hS=function(t){this._$AT=t},lt.prototype._$GT=function(){return this._$e0},lt.prototype._$l2=function(t){this._$IP=t},lt.prototype.getPartsIndex=function(){return this._$IP},lt.prototype._$x2=function(){return this._$JS},lt.prototype._$Ib=function(t){this._$JS=t},lt.prototype.getTotalScale=function(){return this.totalScale},lt.prototype.setTotalScale_notForClient=function(t){this.totalScale=t},lt.prototype.getInterpolatedOpacity=function(){return this._$7s},lt.prototype.setInterpolatedOpacity=function(t){this._$7s=t},lt.prototype.getTotalOpacity=function(t){return this.totalOpacity},lt.prototype.setTotalOpacity=function(t){this.totalOpacity=t},ut._$2s="2.1.00_1",ut._$Kr=201001e3,ut._$sP=!0,ut._$so=!0,ut._$cb=!1,ut._$3T=!0,ut._$Ts=!0,ut._$fb=!0,ut._$ts=!0,ut.L2D_DEFORMER_EXTEND=!0,ut._$Wb=!1,ut._$yr=!1,ut._$Zs=!1,ut.L2D_NO_ERROR=0,ut._$i7=1e3,ut._$9s=1001,ut._$es=1100,ut._$r7=2e3,ut._$07=2001,ut._$b7=2002,ut._$H7=4e3,ut.L2D_COLOR_BLEND_MODE_MULT=0,ut.L2D_COLOR_BLEND_MODE_ADD=1,ut.L2D_COLOR_BLEND_MODE_INTERPOLATE=2,ut._$6b=!0,ut._$cT=0,ut.clippingMaskBufferSize=256,ut.glContext=new Array,ut.frameBuffers=new Array,ut.fTexture=new Array,ut.IGNORE_CLIP=!1,ut.IGNORE_EXPAND=!1,ut.EXPAND_W=2,ut.USE_ADJUST_TRANSLATION=!0,ut.USE_CANVAS_TRANSFORM=!0,ut.USE_CACHED_POLYGON_IMAGE=!1,ut.DEBUG_DATA={},ut.PROFILE_IOS_SPEED={PROFILE_NAME:"iOS Speed",USE_ADJUST_TRANSLATION:!0,USE_CACHED_POLYGON_IMAGE:!0,EXPAND_W:4},ut.PROFILE_IOS_QUALITY={PROFILE_NAME:"iOS HiQ",USE_ADJUST_TRANSLATION:!0,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},ut.PROFILE_IOS_DEFAULT=ut.PROFILE_IOS_QUALITY,ut.PROFILE_ANDROID={PROFILE_NAME:"Android",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},ut.PROFILE_DESKTOP={PROFILE_NAME:"Desktop",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},ut.initProfile=function(){Tt.isIOS()?ut.setupProfile(ut.PROFILE_IOS_DEFAULT):Tt.isAndroid()?ut.setupProfile(ut.PROFILE_ANDROID):ut.setupProfile(ut.PROFILE_DESKTOP)},ut.setupProfile=function(t,e){if("number"==typeof t)switch(t){case 9901:t=ut.PROFILE_IOS_SPEED;break;case 9902:t=ut.PROFILE_IOS_QUALITY;break;case 9903:t=ut.PROFILE_IOS_DEFAULT;break;case 9904:t=ut.PROFILE_ANDROID;break;case 9905:t=ut.PROFILE_DESKTOP;break;default:alert("profile _$6 _$Ui : "+t)}for(var i in arguments.length<2&&(e=!0),e&&console.log("profile : "+t.PROFILE_NAME),t)ut[i]=t[i],e&&console.log("  ["+i+"] = "+t[i])},ut.init=function(){if(ut._$6b){console.log("Live2D %s",ut._$2s),ut._$6b=!1;!0,ut.initProfile()}},ut.getVersionStr=function(){return ut._$2s},ut.getVersionNo=function(){return ut._$Kr},ut._$sT=function(t){ut._$cT=t},ut.getError=function(){var t=ut._$cT;return ut._$cT=0,t},ut.dispose=function(){ut.glContext=[],ut.frameBuffers=[],ut.fTexture=[]},ut.setGL=function(t,e){var i=e||0;ut.glContext[i]=t},ut.getGL=function(t){return ut.glContext[t]},ut.setClippingMaskBufferSize=function(t){ut.clippingMaskBufferSize=t},ut.getClippingMaskBufferSize=function(){return ut.clippingMaskBufferSize},ut.deleteBuffer=function(t){ut.getGL(t).deleteFramebuffer(ut.frameBuffers[t].framebuffer),delete ut.frameBuffers[t],delete ut.glContext[t]},ht._$r2=function(t){return t<0?0:t>1?1:.5-.5*Math.cos(t*wt.PI_F)},_t._$fr=-1,_t.prototype.toString=function(){return this._$ib},ct.prototype=new W,ct._$42=0,ct._$Os=30,ct._$ms=0,ct._$ns=1,ct._$_s=2,ct._$gT=new Array,ct.prototype._$_S=function(t){this._$LP=t},ct.prototype.getTextureNo=function(){return this._$LP},ct.prototype._$ZL=function(){return this._$Qi},ct.prototype._$H2=function(){return this._$JP},ct.prototype.getNumPoints=function(){return this._$d0},ct.prototype.getType=function(){return W._$wb},ct.prototype._$B2=function(t,e,i){var s=e,r=null!=s._$hr?s._$hr:s._$Cr;switch(O._$do){default:case O._$Ms:throw new Error("_$L _$ro ");case O._$Qs:for(var o=this._$d0-1;o>=0;--o){r[o*O._$No+4]=i}}},ct.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP()},ct.prototype._$F0=function(t){W.prototype._$F0.call(this,t),this._$LP=t._$6L(),this._$d0=t._$6L(),this._$Yo=t._$6L();var e=t._$nP();this._$BP=new Int16Array(3*this._$Yo);for(var i=3*this._$Yo-1;i>=0;--i)this._$BP[i]=e[i];if(this._$Eo=t._$nP(),this._$Qi=t._$nP(),t.getFormatVersion()>=N._$s7){if(this._$JP=t._$6L(),0!=this._$JP){if(0!=(1&this._$JP)){var s=t._$6L();null==this._$5P&&(this._$5P=new Object),this._$5P._$Hb=parseInt(s)}0!=(this._$JP&ct._$Os)?this._$6s=(this._$JP&ct._$Os)>>1:this._$6s=ct._$ms,0!=(32&this._$JP)&&(this.culling=!1)}}else this._$JP=0},ct.prototype.init=function(t){var e=new dt(this),i=this._$d0*O._$No,s=this._$32();switch(null!=e._$Cr&&(e._$Cr=null),e._$Cr=new Float32Array(i),null!=e._$hr&&(e._$hr=null),e._$hr=s?new Float32Array(i):null,O._$do){default:case O._$Ms:if(O._$Ls)for(var r=this._$d0-1;r>=0;--r){var o=r<<1;this._$Qi[o+1]=1-this._$Qi[o+1]}break;case O._$Qs:for(r=this._$d0-1;r>=0;--r){o=r<<1;var n=r*O._$No,a=this._$Qi[o],l=this._$Qi[o+1];e._$Cr[n]=a,e._$Cr[n+1]=l,e._$Cr[n+4]=0,s&&(e._$hr[n]=a,e._$hr[n+1]=l,e._$hr[n+4]=0)}}return e},ct.prototype._$Nr=function(t,e){var i=e;if(this!=i._$GT()&&console.log("### assert!! ### "),this._$GS._$Ur(t)&&(W.prototype._$Nr.call(this,t,i),!i._$IS[0])){var s=ct._$gT;s[0]=!1,P._$Vr(t,this._$GS,s,this._$d0,this._$Eo,i._$Cr,O._$i2,O._$No)}},ct.prototype._$2b=function(t,e){try{this!=e._$GT()&&console.log("### assert!! ### ");var i=!1;e._$IS[0]&&(i=!0);var s=e;if(!i&&(W.prototype._$2b.call(this,t),this._$32())){var r=this.getTargetBaseDataID();if(s._$8r==W._$ur&&(s._$8r=t.getBaseDataIndex(r)),s._$8r<0)ut._$so&&l._$li("_$L _$0P _$G :: %s",r);else{var o=t.getBaseData(s._$8r),n=t._$q2(s._$8r);null==o||n._$x2()?s._$AT=!1:(o._$nb(t,n,s._$Cr,s._$hr,this._$d0,O._$i2,O._$No),s._$AT=!0),s.baseOpacity=n.getTotalOpacity()}}}catch(t){throw t}},ct.prototype.draw=function(t,e,i){if(this!=i._$GT()&&console.log("### assert!! ### "),!i._$IS[0]){var s=i,r=this._$LP;r<0&&(r=1);var o=this.getOpacity(e,s)*i._$VS*i.baseOpacity,n=null!=s._$hr?s._$hr:s._$Cr;t.setClipBufPre_clipContextForDraw(i.clipBufPre_clipContext),t._$WP(this.culling),t._$Uo(r,3*this._$Yo,this._$BP,n,this._$Qi,o,this._$6s,s)}},ct.prototype.dump=function(){console.log("  _$yi( %d ) , _$d0( %d ) , _$Yo( %d ) \n",this._$LP,this._$d0,this._$Yo),console.log("  _$Oi _$di = { ");for(var t=0;t<this._$BP.length;t++)console.log("%5d ,",this._$BP[t]);console.log("\n  _$5i _$30");for(t=0;t<this._$Eo.length;t++){console.log("\n    _$30[%d] = ",t);for(var e=this._$Eo[t],i=0;i<e.length;i++)console.log("%6.2f, ",e[i])}console.log("\n")},ct.prototype._$72=function(t){return null==this._$5P?null:this._$5P[t]},ct.prototype.getIndexArray=function(){return this._$BP},dt.prototype=new Lt,dt.prototype.getTransformedPoints=function(){return null!=this._$hr?this._$hr:this._$Cr},mt.prototype._$HT=function(t){this.x=t.x,this.y=t.y},mt.prototype._$HT=function(t,e){this.x=t,this.y=e},pt.prototype=new i,pt.loadModel=function(t){var e=new pt;return i._$62(e,t),e},pt.loadModel=function(t,e){var s=new pt(e||0);return i._$62(s,t),s},pt._$to=function(){return new pt},pt._$er=function(t){var e=new _$5("../_$_r/_$t0/_$Ri/_$_P._$d");if(0==e.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+e._$PL());for(var i=["../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1","../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1"],s=pt.loadModel(e._$3b()),r=0;r<i.length;r++){var o=new _$5(i[r]);if(0==o.exists())throw new _$ls("_$t0 _$_ _$6 _$Ui :: "+o._$PL());s.setTexture(r,_$nL._$_o(t,o._$3b()))}return s},pt.prototype.setGL=function(t){ut.setGL(t)},pt.prototype.setTransform=function(t){this.drawParamWebGL.setTransform(t)},pt.prototype.update=function(){this._$5S.update(),this._$5S.preDraw(this.drawParamWebGL)},pt.prototype.draw=function(){this._$5S.draw(this.drawParamWebGL)},pt.prototype._$K2=function(){this.drawParamWebGL._$K2()},pt.prototype.setTexture=function(t,e){null==this.drawParamWebGL&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this.drawParamWebGL.setTexture(t,e)},pt.prototype.setTexture=function(t,e){null==this.drawParamWebGL&&l._$li("_$Yi for QT _$ki / _$XS() is _$6 _$ui!!"),this.drawParamWebGL.setTexture(t,e)},pt.prototype._$Rs=function(){return this.drawParamWebGL._$Rs()},pt.prototype._$Ds=function(t){this.drawParamWebGL._$Ds(t)},pt.prototype.getDrawParam=function(){return this.drawParamWebGL},pt.prototype.setMatrix=function(t){this.drawParamWebGL.setMatrix(t)},pt.prototype.setPremultipliedAlpha=function(t){this.drawParamWebGL.setPremultipliedAlpha(t)},pt.prototype.isPremultipliedAlpha=function(){return this.drawParamWebGL.isPremultipliedAlpha()},pt.prototype.setAnisotropy=function(t){this.drawParamWebGL.setAnisotropy(t)},pt.prototype.getAnisotropy=function(){return this.drawParamWebGL.getAnisotropy()},gt.prototype._$tb=function(){return this.motions},gt.prototype.startMotion=function(t,e){for(var i=null,s=this.motions.length,r=0;r<s;++r)null!=(i=this.motions[r])&&(i._$qS(i._$w0.getFadeOut()),this._$eb&&l._$Ji("MotionQueueManager[size:%2d]->startMotion() / start _$K _$3 (m%d)\n",s,i._$sr));if(null==t)return-1;(i=new ft)._$w0=t,this.motions.push(i);var o=i._$sr;return this._$eb&&l._$Ji("MotionQueueManager[size:%2d]->startMotion() / new _$w0 (m%d)\n",s,o),o},gt.prototype.updateParam=function(t){try{for(var e=!1,i=0;i<this.motions.length;i++){var s=this.motions[i];if(null!=s){var r=s._$w0;null!=r?(r.updateParam(t,s),e=!0,s.isFinished()&&(this._$eb&&l._$Ji("MotionQueueManager[size:%2d]->updateParam() / _$T0 _$w0 (m%d)\n",this.motions.length-1,s._$sr),this.motions.splice(i,1),i--)):(this.motions=this.motions.splice(i,1),i--)}else this.motions.splice(i,1),i--}return e}catch(t){return l._$li(t),!0}},gt.prototype.isFinished=function(t){if(arguments.length>=1){for(var e=0;e<this.motions.length;e++){if(null!=(i=this.motions[e])&&(i._$sr==t&&!i.isFinished()))return!1}return!0}for(e=0;e<this.motions.length;e++){var i;if(null!=(i=this.motions[e])){var s=i._$w0;if(null!=s){if(!i.isFinished())return!1}else this.motions.splice(e,1),e--}else this.motions.splice(e,1),e--}return!0},gt.prototype.stopAllMotions=function(){for(var t=0;t<this.motions.length;t++){var e=this.motions[t];if(null!=e){e._$w0;this.motions.splice(t,1),t--}else this.motions.splice(t,1),t--}},gt.prototype._$Zr=function(t){this._$eb=t},gt.prototype._$e=function(){console.log("-- _$R --\n");for(var t=0;t<this.motions.length;t++){var e=this.motions[t]._$w0;console.log("MotionQueueEnt[%d] :: %s\n",this.motions.length,e.toString())}},ft._$Gs=0,ft.prototype.isFinished=function(){return this._$9L},ft.prototype._$qS=function(t){var e=F.getUserTimeMSec()+t;(this._$Do<0||e<this._$Do)&&(this._$Do=e)},ft.prototype._$Bs=function(){return this._$sr},yt.prototype.setContext=function(t){var e=this.m;t.transform(e[0],e[1],e[3],e[4],e[6],e[7])},yt.prototype.toString=function(){for(var t="LDTransform { ",e=0;e<9;e++)t+=this.m[e].toFixed(2)+" ,";return t+=" }"},yt.prototype.identity=function(){var t=this.m;t[0]=t[4]=t[8]=1,t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0},yt.prototype._$PS=function(t,e,i){null==i&&(i=new Array(0,0));var s=this.m;return i[0]=s[0]*t+s[3]*e+s[6],i[1]=s[1]*t+s[4]*e+s[7],i},yt.prototype._$P2=function(t){t||(t=new yt);var e=this.m,i=e[0],s=e[1],r=e[2],o=e[3],n=e[4],a=e[5],l=e[6],u=e[7],h=e[8],_=i*n*h+s*a*l+r*o*u-i*a*u-r*n*l-s*o*h;if(0==_)return null;var c=1/_;return t.m[0]=c*(n*h-u*a),t.m[1]=c*(u*r-s*h),t.m[2]=c*(s*a-n*r),t.m[3]=c*(l*a-o*h),t.m[4]=c*(i*h-l*r),t.m[5]=c*(o*r-i*a),t.m[6]=c*(o*u-l*n),t.m[7]=c*(l*s-i*u),t.m[8]=c*(i*n-o*s),t},yt.prototype.transform=function(t,e,i){null==i&&(i=new Array(0,0));var s=this.m;return i[0]=s[0]*t+s[3]*e+s[6],i[1]=s[1]*t+s[4]*e+s[7],i},yt.prototype.translate=function(t,e){var i=this.m;i[6]=i[0]*t+i[3]*e+i[6],i[7]=i[1]*t+i[4]*e+i[7],i[8]=i[2]*t+i[5]*e+i[8]},yt.prototype.scale=function(t,e){var i=this.m;i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=e,i[4]*=e,i[5]*=e},yt.prototype.shear=function(t,e){var i=this.m,s=i[0]+i[3]*e,r=i[1]+i[4]*e,o=i[2]+i[5]*e;i[3]=i[0]*t+i[3],i[4]=i[1]*t+i[4],i[5]=i[2]*t+i[5],i[0]=s,i[1]=r,i[2]=o},yt.prototype.rotate=function(t){var e=this.m,i=Math.cos(t),s=Math.sin(t),r=e[0]*i+e[3]*s,o=e[1]*i+e[4]*s,n=e[2]*i+e[5]*s;e[3]=-e[0]*s+e[3]*i,e[4]=-e[1]*s+e[4]*i,e[5]=-e[2]*s+e[5]*i,e[0]=r,e[1]=o,e[2]=n},yt.prototype.concatenate=function(t){var e=this.m,i=t.m,s=e[0]*i[0]+e[3]*i[1]+e[6]*i[2],r=e[1]*i[0]+e[4]*i[1]+e[7]*i[2],o=e[2]*i[0]+e[5]*i[1]+e[8]*i[2],n=e[0]*i[3]+e[3]*i[4]+e[6]*i[5],a=e[1]*i[3]+e[4]*i[4]+e[7]*i[5],l=e[2]*i[3]+e[5]*i[4]+e[8]*i[5],u=e[0]*i[6]+e[3]*i[7]+e[6]*i[8],h=e[1]*i[6]+e[4]*i[7]+e[7]*i[8],_=e[2]*i[6]+e[5]*i[7]+e[8]*i[8];m[0]=s,m[1]=r,m[2]=o,m[3]=n,m[4]=a,m[5]=l,m[6]=u,m[7]=h,m[8]=_},$t.prototype=new rt,$t._$eT=null,$t._$tP=new Object,$t._$2o=function(){return null==$t._$eT&&($t._$eT=$t.getID("DST_BASE")),$t._$eT},$t._$27=function(){$t._$tP.clear(),$t._$eT=null},$t.getID=function(t){var e=$t._$tP[t];return null==e&&(e=new $t(t),$t._$tP[t]=e),e},$t.prototype._$3s=function(){return new $t},St.prototype=new T,St._$9r=function(t){return new Float32Array(t)},St._$vb=function(t){return new Int16Array(t)},St._$cr=function(t,e){return null==t||t._$yL()<e.length?((t=St._$9r(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},St._$mb=function(t,e){return null==t||t._$yL()<e.length?((t=St._$vb(2*e.length)).put(e),t._$oT(0)):(t.clear(),t.put(e),t._$oT(0)),t},St._$Hs=function(){return this._$Gr},St._$as=function(t){this._$Gr=t},St.prototype.getGL=function(){return this.gl},St.prototype.setGL=function(t){this.gl=t},St.prototype.setTransform=function(t){this.transform=t},St.prototype._$ZT=function(){var t=this.gl;this.firstDraw&&(this.initShader(),this.firstDraw=!1,this.anisotropyExt=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic"),this.anisotropyExt&&(this.maxAnisotropy=t.getParameter(this.anisotropyExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.DEPTH_TEST),t.frontFace(t.CW),t.enable(t.BLEND),t.colorMask(1,1,1,1),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)},St.prototype._$Uo=function(t,e,i,s,r,o,n,a){if(!(o<.01&&null==this.clipBufPre_clipContextMask)){o>.9&&ut.EXPAND_W;var l=this.gl;if(null==this.gl)throw new Error("gl is null");var u,h,_,c,d=1*this._$C0*o,m=1*this._$tT*o,p=1*this._$WL*o,g=this._$lT*o;if(null!=this.clipBufPre_clipContextMask){l.frontFace(l.CCW),l.useProgram(this.shaderProgram),this._$vS=vt(l,this._$vS,s),this._$no=xt(l,this._$no,i),l.enableVertexAttribArray(this.a_position_Loc),l.vertexAttribPointer(this.a_position_Loc,2,l.FLOAT,!1,0,0),this._$NT=vt(l,this._$NT,r),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this.textures[t]),l.uniform1i(this.s_texture0_Loc,1),l.enableVertexAttribArray(this.a_texCoord_Loc),l.vertexAttribPointer(this.a_texCoord_Loc,2,l.FLOAT,!1,0,0),l.uniformMatrix4fv(this.u_matrix_Loc,!1,this.getClipBufPre_clipContextMask().matrixForMask);var f=this.getClipBufPre_clipContextMask().layoutChannelNo,y=this.getChannelFlagAsColor(f);l.uniform4f(this.u_channelFlag,y.r,y.g,y.b,y.a);var $=this.getClipBufPre_clipContextMask().layoutBounds;l.uniform4f(this.u_baseColor_Loc,2*$.x-1,2*$.y-1,2*$._$EL()-1,2*$._$5T()-1),l.uniform1i(this.u_maskFlag_Loc,!0)}else if(null!=this.getClipBufPre_clipContextDraw()){l.useProgram(this.shaderProgramOff),this._$vS=vt(l,this._$vS,s),this._$no=xt(l,this._$no,i),l.enableVertexAttribArray(this.a_position_Loc_Off),l.vertexAttribPointer(this.a_position_Loc_Off,2,l.FLOAT,!1,0,0),this._$NT=vt(l,this._$NT,r),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this.textures[t]),l.uniform1i(this.s_texture0_Loc_Off,1),l.enableVertexAttribArray(this.a_texCoord_Loc_Off),l.vertexAttribPointer(this.a_texCoord_Loc_Off,2,l.FLOAT,!1,0,0),l.uniformMatrix4fv(this.u_clipMatrix_Loc_Off,!1,this.getClipBufPre_clipContextDraw().matrixForDraw),l.uniformMatrix4fv(this.u_matrix_Loc_Off,!1,this.matrix4x4),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,ut.fTexture[this.glno]),l.uniform1i(this.s_texture1_Loc_Off,2);f=this.getClipBufPre_clipContextDraw().layoutChannelNo,y=this.getChannelFlagAsColor(f);l.uniform4f(this.u_channelFlag_Loc_Off,y.r,y.g,y.b,y.a),l.uniform4f(this.u_baseColor_Loc_Off,d,m,p,g)}else l.useProgram(this.shaderProgram),this._$vS=vt(l,this._$vS,s),this._$no=xt(l,this._$no,i),l.enableVertexAttribArray(this.a_position_Loc),l.vertexAttribPointer(this.a_position_Loc,2,l.FLOAT,!1,0,0),this._$NT=vt(l,this._$NT,r),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,this.textures[t]),l.uniform1i(this.s_texture0_Loc,1),l.enableVertexAttribArray(this.a_texCoord_Loc),l.vertexAttribPointer(this.a_texCoord_Loc,2,l.FLOAT,!1,0,0),l.uniformMatrix4fv(this.u_matrix_Loc,!1,this.matrix4x4),l.uniform4f(this.u_baseColor_Loc,d,m,p,g),l.uniform1i(this.u_maskFlag_Loc,!1);if(this.culling?this.gl.enable(l.CULL_FACE):this.gl.disable(l.CULL_FACE),this.gl.enable(l.BLEND),null!=this.clipBufPre_clipContextMask)u=l.ONE,h=l.ONE_MINUS_SRC_ALPHA,_=l.ONE,c=l.ONE_MINUS_SRC_ALPHA;else switch(n){case ct._$ms:u=l.ONE,h=l.ONE_MINUS_SRC_ALPHA,_=l.ONE,c=l.ONE_MINUS_SRC_ALPHA;break;case ct._$ns:u=l.ONE,h=l.ONE,_=l.ZERO,c=l.ONE;break;case ct._$_s:u=l.DST_COLOR,h=l.ONE_MINUS_SRC_ALPHA,_=l.ZERO,c=l.ONE}l.blendEquationSeparate(l.FUNC_ADD,l.FUNC_ADD),l.blendFuncSeparate(u,h,_,c),this.anisotropyExt&&l.texParameteri(l.TEXTURE_2D,this.anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy);var S=i.length;l.drawElements(l.TRIANGLES,S,l.UNSIGNED_SHORT,0),l.bindTexture(l.TEXTURE_2D,null)}},St.prototype._$Rs=function(){throw new Error("_$Rs")},St.prototype._$Ds=function(t){throw new Error("_$Ds")},St.prototype._$K2=function(){for(var t=0;t<this.textures.length;t++){0!=this.textures[t]&&(this.gl._$K2(1,this.textures,t),this.textures[t]=null)}},St.prototype.setTexture=function(t,e){this.textures[t]=e},St.prototype.initShader=function(){var t=this.gl;this.loadShaders2(),this.a_position_Loc=t.getAttribLocation(this.shaderProgram,"a_position"),this.a_texCoord_Loc=t.getAttribLocation(this.shaderProgram,"a_texCoord"),this.u_matrix_Loc=t.getUniformLocation(this.shaderProgram,"u_mvpMatrix"),this.s_texture0_Loc=t.getUniformLocation(this.shaderProgram,"s_texture0"),this.u_channelFlag=t.getUniformLocation(this.shaderProgram,"u_channelFlag"),this.u_baseColor_Loc=t.getUniformLocation(this.shaderProgram,"u_baseColor"),this.u_maskFlag_Loc=t.getUniformLocation(this.shaderProgram,"u_maskFlag"),this.a_position_Loc_Off=t.getAttribLocation(this.shaderProgramOff,"a_position"),this.a_texCoord_Loc_Off=t.getAttribLocation(this.shaderProgramOff,"a_texCoord"),this.u_matrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_mvpMatrix"),this.u_clipMatrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_ClipMatrix"),this.s_texture0_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"s_texture0"),this.s_texture1_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"s_texture1"),this.u_channelFlag_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_channelFlag"),this.u_baseColor_Loc_Off=t.getUniformLocation(this.shaderProgramOff,"u_baseColor")},St.prototype.disposeShader=function(){var t=this.gl;this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=null),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=null)},St.prototype.compileShader=function(t,e){var i=this.gl,s=e,r=i.createShader(t);if(null==r)return l._$Ji("_$L0 to create shader"),null;if(i.shaderSource(r,s),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS)){var o=i.getShaderInfoLog(r);return l._$Ji("_$L0 to compile shader : "+o),i.deleteShader(r),null}return r},St.prototype.loadShaders2=function(){var t=this.gl;if(this.shaderProgram=t.createProgram(),!this.shaderProgram)return!1;if(this.shaderProgramOff=t.createProgram(),!this.shaderProgramOff)return!1;if(this.vertShader=this.compileShader(t.VERTEX_SHADER,"attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform mat4       u_mvpMatrix;void main(){    gl_Position = u_mvpMatrix * a_position;    v_ClipPos = u_mvpMatrix * a_position;    v_texCoord = a_texCoord;}"),!this.vertShader)return l._$Ji("Vertex shader compile _$li!"),!1;if(this.vertShaderOff=this.compileShader(t.VERTEX_SHADER,"attribute vec4     a_position;attribute vec2     a_texCoord;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform mat4       u_mvpMatrix;uniform mat4       u_ClipMatrix;void main(){    gl_Position = u_mvpMatrix * a_position;    v_ClipPos = u_ClipMatrix * a_position;    v_texCoord = a_texCoord ;}"),!this.vertShaderOff)return l._$Ji("OffVertex shader compile _$li!"),!1;if(this.fragShader=this.compileShader(t.FRAGMENT_SHADER,"precision mediump float;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform sampler2D  s_texture0;uniform vec4       u_channelFlag;uniform vec4       u_baseColor;uniform bool       u_maskFlag;void main(){    vec4 smpColor;     if(u_maskFlag){        float isInside =             step(u_baseColor.x, v_ClipPos.x/v_ClipPos.w)          * step(u_baseColor.y, v_ClipPos.y/v_ClipPos.w)          * step(v_ClipPos.x/v_ClipPos.w, u_baseColor.z)          * step(v_ClipPos.y/v_ClipPos.w, u_baseColor.w);        smpColor = u_channelFlag * texture2D(s_texture0 , v_texCoord).a * isInside;    }else{        smpColor = texture2D(s_texture0 , v_texCoord) * u_baseColor;    }    gl_FragColor = smpColor;}"),!this.fragShader)return l._$Ji("Fragment shader compile _$li!"),!1;if(this.fragShaderOff=this.compileShader(t.FRAGMENT_SHADER,"precision mediump float ;varying vec2       v_texCoord;varying vec4       v_ClipPos;uniform sampler2D  s_texture0;uniform sampler2D  s_texture1;uniform vec4       u_channelFlag;uniform vec4       u_baseColor ;void main(){    vec4 col_formask = texture2D(s_texture0, v_texCoord) * u_baseColor;    vec4 clipMask = texture2D(s_texture1, v_ClipPos.xy / v_ClipPos.w) * u_channelFlag;    float maskVal = clipMask.r + clipMask.g + clipMask.b + clipMask.a;    col_formask = col_formask * maskVal;    gl_FragColor = col_formask;}"),!this.fragShaderOff)return l._$Ji("OffFragment shader compile _$li!"),!1;if(t.attachShader(this.shaderProgram,this.vertShader),t.attachShader(this.shaderProgram,this.fragShader),t.attachShader(this.shaderProgramOff,this.vertShaderOff),t.attachShader(this.shaderProgramOff,this.fragShaderOff),t.linkProgram(this.shaderProgram),t.linkProgram(this.shaderProgramOff),!t.getProgramParameter(this.shaderProgram,t.LINK_STATUS)){var e=t.getProgramInfoLog(this.shaderProgram);return l._$Ji("_$L0 to link program: "+e),this.vertShader&&(t.deleteShader(this.vertShader),this.vertShader=0),this.fragShader&&(t.deleteShader(this.fragShader),this.fragShader=0),this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=0),this.vertShaderOff&&(t.deleteShader(this.vertShaderOff),this.vertShaderOff=0),this.fragShaderOff&&(t.deleteShader(this.fragShaderOff),this.fragShaderOff=0),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=0),!1}return!0},St.prototype.createFramebuffer=function(){var t=this.gl,e=ut.clippingMaskBufferSize,i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i);var s=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,s),t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,e,e),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,s);var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,e,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),ut.fTexture[this.glno]=r,{framebuffer:i,renderbuffer:s,texture:ut.fTexture[this.glno]}},bt.prototype._$fP=function(){var t,e,i,s=this._$ST();if(0==(128&s))return 255&s;if(0==(128&(t=this._$ST())))return(127&s)<<7|127&t;if(0==(128&(e=this._$ST())))return(127&s)<<14|(127&t)<<7|255&e;if(0==(128&(i=this._$ST())))return(127&s)<<21|(127&t)<<14|(127&e)<<7|255&i;throw new _t("_$L _$0P  _")},bt.prototype.getFormatVersion=function(){return this._$S2},bt.prototype._$gr=function(t){this._$S2=t},bt.prototype._$3L=function(){return this._$fP()},bt.prototype._$mP=function(){return this._$zT(),this._$F+=8,this._$T.getFloat64(this._$F-8)},bt.prototype._$_T=function(){return this._$zT(),this._$F+=4,this._$T.getFloat32(this._$F-4)},bt.prototype._$6L=function(){return this._$zT(),this._$F+=4,this._$T.getInt32(this._$F-4)},bt.prototype._$ST=function(){return this._$zT(),this._$T.getInt8(this._$F++)},bt.prototype._$9T=function(){return this._$zT(),this._$F+=2,this._$T.getInt16(this._$F-2)},bt.prototype._$2T=function(){throw this._$zT(),this._$F+=8,new _t("_$L _$q read long")},bt.prototype._$po=function(){return this._$zT(),0!=this._$T.getInt8(this._$F++)};var Pt=!0;function wt(){}function Lt(t){e||(this._$e0=null,this._$IP=null,this._$Us=null,this._$7s=null,this._$IS=[!1],this._$VS=null,this._$AT=!0,this.baseOpacity=1,this.clipBufPre_clipContext=null,this._$e0=t)}function Tt(){}bt.prototype._$bT=function(){this._$zT();var t=this._$3L(),e=null;if(Pt)try{var i=new ArrayBuffer(2*t);e=new Uint16Array(i);for(var s=0;s<t;++s)e[s]=this._$T.getUint8(this._$F++);return String.fromCharCode.apply(null,e)}catch(t){Pt=!1}try{var r=new Array;if(null==e)for(s=0;s<t;++s)r[s]=this._$T.getUint8(this._$F++);else for(s=0;s<t;++s)r[s]=e[s];return String.fromCharCode.apply(null,r)}catch(t){console.log("read utf8 / _$rT _$L0 !! : "+t)}},bt.prototype._$cS=function(){this._$zT();for(var t=this._$3L(),e=new Int32Array(t),i=0;i<t;i++)e[i]=this._$T.getInt32(this._$F),this._$F+=4;return e},bt.prototype._$Tb=function(){this._$zT();for(var t=this._$3L(),e=new Float32Array(t),i=0;i<t;i++)e[i]=this._$T.getFloat32(this._$F),this._$F+=4;return e},bt.prototype._$5b=function(){this._$zT();for(var t=this._$3L(),e=new Float64Array(t),i=0;i<t;i++)e[i]=this._$T.getFloat64(this._$F),this._$F+=8;return e},bt.prototype._$nP=function(){return this._$Jb(-1)},bt.prototype._$Jb=function(t){if(this._$zT(),t<0&&(t=this._$3L()),t==N._$7P){var e=this._$6L();if(0<=e&&e<this._$Ko.length)return this._$Ko[e];throw new _t("_$sL _$4i @_$m0")}var i=this._$4b(t);return this._$Ko.push(i),i},bt.prototype._$4b=function(t){if(0==t)return null;if(50==t){var e=this._$bT();return r=A.getID(e)}if(51==t){e=this._$bT();return r=$t.getID(e)}if(134==t){e=this._$bT();return r=_.getID(e)}if(60==t){e=this._$bT();return r=c.getID(e)}if(t>=48){var i=N._$9o(t);return null!=i?(i._$F0(this),i):null}switch(t){case 1:return this._$bT();case 10:return new n(this._$6L(),!0);case 11:return new b(this._$mP(),this._$mP(),this._$mP(),this._$mP());case 12:return new b(this._$_T(),this._$_T(),this._$_T(),this._$_T());case 13:return new w(this._$mP(),this._$mP());case 14:return new w(this._$_T(),this._$_T());case 15:for(var s=this._$3L(),r=new Array(s),o=0;o<s;o++)r[o]=this._$nP();return r;case 17:return r=new R(this._$mP(),this._$mP(),this._$mP(),this._$mP(),this._$mP(),this._$mP());case 21:return new h(this._$6L(),this._$6L(),this._$6L(),this._$6L());case 22:return new mt(this._$6L(),this._$6L());case 23:throw new Error("_$L _$ro ");case 16:case 25:return this._$cS();case 26:return this._$5b();case 27:return this._$Tb();case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 18:case 19:case 20:case 24:case 28:throw new _t("_$6 _$q : _$nP() of 2-9 ,18,19,20,24,28 : "+t);default:throw new _t("_$6 _$q : _$nP() NO _$i : "+t)}},bt.prototype._$8L=function(){return 0==this._$hL?this._$v0=this._$ST():8==this._$hL&&(this._$v0=this._$ST(),this._$hL=0),1==(this._$v0>>7-this._$hL++&1)},bt.prototype._$zT=function(){0!=this._$hL&&(this._$hL=0)},wt._$2S=Math.PI/180,wt._$bS=Math.PI/180,wt._$wS=180/Math.PI,wt._$NS=180/Math.PI,wt.PI_F=Math.PI,wt._$kT=[0,.012368,.024734,.037097,.049454,.061803,.074143,.086471,.098786,.111087,.12337,.135634,.147877,.160098,.172295,.184465,.196606,.208718,.220798,.232844,.244854,.256827,.268761,.280654,.292503,.304308,.316066,.327776,.339436,.351044,.362598,.374097,.385538,.396921,.408243,.419502,.430697,.441826,.452888,.463881,.474802,.485651,.496425,.507124,.517745,.528287,.538748,.549126,.559421,.56963,.579752,.589785,.599728,.609579,.619337,.629,.638567,.648036,.657406,.666676,.675843,.684908,.693867,.70272,.711466,.720103,.72863,.737045,.745348,.753536,.76161,.769566,.777405,.785125,.792725,.800204,.807561,.814793,.821901,.828884,.835739,.842467,.849066,.855535,.861873,.868079,.874153,.880093,.885898,.891567,.897101,.902497,.907754,.912873,.917853,.922692,.92739,.931946,.936359,.940629,.944755,.948737,.952574,.956265,.959809,.963207,.966457,.96956,.972514,.97532,.977976,.980482,.982839,.985045,.987101,.989006,.990759,.992361,.993811,.995109,.996254,.997248,.998088,.998776,.999312,.999694,.999924,1],wt._$92=function(t,e){var i=Math.atan2(t[1],t[0]),s=Math.atan2(e[1],e[0]);return wt._$tS(i,s)},wt._$tS=function(t,e){for(var i=t-e;i<-Math.PI;)i+=2*Math.PI;for(;i>Math.PI;)i-=2*Math.PI;return i},wt._$9=function(t){return Math.sin(t)},wt.fcos=function(t){return Math.cos(t)},Lt.prototype._$u2=function(){return this._$IS[0]},Lt.prototype._$yo=function(){return this._$AT&&!this._$IS[0]},Lt.prototype._$GT=function(){return this._$e0},Tt._$W2=0,Tt.SYSTEM_INFO=null,Tt.USER_AGENT=navigator.userAgent,Tt.isIPhone=function(){return Tt.SYSTEM_INFO||Tt.setup(),Tt.SYSTEM_INFO._isIPhone},Tt.isIOS=function(){return Tt.SYSTEM_INFO||Tt.setup(),Tt.SYSTEM_INFO._isIPhone||Tt.SYSTEM_INFO._isIPad},Tt.isAndroid=function(){return Tt.SYSTEM_INFO||Tt.setup(),Tt.SYSTEM_INFO._isAndroid},Tt.getOSVersion=function(){return Tt.SYSTEM_INFO||Tt.setup(),Tt.SYSTEM_INFO.version},Tt.getOS=function(){return Tt.SYSTEM_INFO||Tt.setup(),Tt.SYSTEM_INFO._isIPhone||Tt.SYSTEM_INFO._isIPad?"iOS":Tt.SYSTEM_INFO._isAndroid?"Android":"_$Q0 OS"},Tt.setup=function(){var t,e=Tt.USER_AGENT;function i(t,e){for(var i=t.substring(e).split(/[ _,;\.]/),s=0,r=0;r<=2&&!isNaN(i[r]);r++){var o=parseInt(i[r]);if(o<0||o>999){l._$li("err : "+o+" @UtHtml5.setup()"),s=0;break}s+=o*Math.pow(1e3,2-r)}return s}var s=Tt.SYSTEM_INFO={userAgent:e};if((t=e.indexOf("iPhone OS "))>=0)s.os="iPhone",s._isIPhone=!0,s.version=i(e,t+"iPhone OS ".length);else if((t=e.indexOf("iPad"))>=0){if((t=e.indexOf("CPU OS"))<0)return void l._$li(" err : "+e+" @UtHtml5.setup()");s.os="iPad",s._isIPad=!0,s.version=i(e,t+"CPU OS ".length)}else(t=e.indexOf("Android"))>=0?(s.os="Android",s._isAndroid=!0,s.version=i(e,t+"Android ".length)):(s.os="-",s.version=-1)},window.UtSystem=F,window.UtDebug=l,window.LDTransform=yt,window.LDGL=nt,window.Live2D=ut,window.Live2DModelWebGL=pt,window.Live2DModelJS=Q,window.Live2DMotion=Z,window.MotionQueueManager=gt,window.PhysicsHair=p,window.AMotion=a,window.PartsDataID=_,window.DrawDataID=A,window.BaseDataID=$t,window.ParamID=c,ut.init();e=!1}()}).call(this,i("./node_modules/webpack/buildin/system.js"))},"./src/main.js":function(t,e,i){"use strict";i.r(e),i.d(e,"loadlive2dv3",(function(){return D})),i.d(e,"screenshot",(function(){return B}));i("./src/lib/live2d.min.js");var s=i("./src/lib/Live2DFramework.js"),r=i("./src/LAppLive2DManager_v2.js"),o=i("./src/lappdefine.ts"),n=i("./src/lib/MatrixStack.ts"),a=i("./src/lappdelegate.ts"),l=i("./src/PlatformManager.js");window.navigator.platform.toLowerCase();const u=new r.default;let h=!1,_=null,c=null,d=null,m=null,p=null,g=null,f=!1,y=0,$=0,S=.5,v=1;function x(t){let e=c.width,i=c.height;d=new s.L2DTargetPoint;let r=i/e,a=o.ViewLogicalLeft,l=o.ViewLogicalRight,f=-r,y=r;if(window.Live2D.captureFrame=!1,m=new s.L2DViewMatrix,m.setScreenRect(a,l,f,y),m.setMaxScreenRect(o.ViewLogicalMaxLeft,o.ViewLogicalMaxRight,o.ViewLogicalMaxBottom,o.ViewLogicalMaxTop),m.setMaxScale(o.ViewMaxScale),m.setMinScale(o.ViewMinScale),p=new s.L2DMatrix44,p.multScale(v,v*e/i),g=new s.L2DMatrix44,g.multTranslate(-e/2,-i/2),g.multScale(2/e,-2/e),_=function(){for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=0;e<t.length;e++)try{var i=c.getContext(t[e],{premultipliedAlpha:!0});if(i)return i}catch(t){}return null}(),o.setContext(_),!_)return console.error("Failed to create WebGL context."),void(window.WebGLRenderingContext&&console.error("Your browser don't support WebGL, check https://get.webgl.org/ for futher information."));window.Live2D.setGL(_),_.clearColor(0,0,0,0),function(t){u.reloadFlg=!0,u.count++,u.changeModel(_,t)}(t),h||(h=!0,function t(){!function(){let t=new n.MatrixStack;t.reset(),t.loadIdentity(),d.update(),u.setDrag(d.getX(),d.getY()),_.clear(_.COLOR_BUFFER_BIT),t.multMatrix(p.getArray()),t.multMatrix(m.getArray()),t.push();for(let e=0;e<u.numModels();e++){let i=u.getModel(e);if(null==i)return;i.initialized&&!i.updating&&(i.update(),i.draw(t))}t.pop()}();let e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(window.Live2D.captureFrame){window.Live2D.captureFrame=!1;var i=document.createElement("a");document.body.appendChild(i),i.setAttribute("type","hidden"),i.href=c.toDataURL(),i.download=window.Live2D.captureName||"live2d.png",i.click()}e(t,c)}())}function b(t,e,i){if(e.x<i.left+i.width&&e.y<i.top+i.height&&e.x>i.left&&e.y>i.top)return e;let s=t.x-e.x,r=t.y-e.y;function o(t,e){return 180*Math.acos((i={x:0,y:1},s=function(t,e){let i=Math.sqrt(t*t+e*e);return{x:t/i,y:e/i}}(t,e),i.x*s.x+i.y*s.y))/Math.PI;var i,s}let n=o(s,r);e.x<t.x&&(n=360-n);let a=360-o(i.left-t.x,-1*(i.top-t.y)),l=360-o(i.left-t.x,-1*(i.top+i.height-t.y)),u=o(i.left+i.width-t.x,-1*(i.top-t.y)),h=o(i.left+i.width-t.x,-1*(i.top+i.height-t.y)),_=r/s,c={};if(n<u){let e=i.top-t.y,s=e/_;c={y:t.y+e,x:t.x+s}}else if(n<h){let e=i.left+i.width-t.x,s=e*_;c={y:t.y+s,x:t.x+e}}else if(n<l){let e=i.top+i.height-t.y,s=e/_;c={y:t.y+e,x:t.x+s}}else if(n<a){let e=t.x-i.left,s=e*_;c={y:t.y-s,x:t.x-e}}else{let e=i.top-t.y,s=e/_;c={y:t.y+e,x:t.x+s}}return c}function P(t){f=!0;let e=c.getBoundingClientRect(),i=I(t.clientX-e.left),s=E(t.clientY-e.top),r=b({x:e.left+e.width/2,y:e.top+e.height*S},{x:t.clientX,y:t.clientY},e),n=C(r.x-e.left),a=F(r.y-e.top);o.DebugTouchLogEnable&&console.log("onMouseMove device( x:"+t.clientX+" y:"+t.clientY+" ) view( x:"+n+" y:"+a+")"),y=i,$=s,d.setPoint(n,a)}function w(){f&&(f=!1),d.setPoint(0,0)}function L(){o.DebugLogEnable&&console.log("Set Session Storage."),sessionStorage.setItem("Sleepy","1")}function T(t){if("mousewheel"==t.type);else if("mousedown"==t.type)!function(t){f=!0;let e=c.getBoundingClientRect(),i=I(t.clientX-e.left),s=E(t.clientY-e.top),r=b({x:e.left+e.width/2,y:e.top+e.height*S},{x:t.clientX,y:t.clientY},e),n=C(r.x-e.left),a=F(r.y-e.top);o.DebugTouchLogEnable&&console.log("onMouseDown device( x:"+t.clientX+" y:"+t.clientY+" ) view( x:"+n+" y:"+a+")"),y=i,$=s,u.tapEvent(n,a)}(t);else if("mousemove"==t.type){"1"===sessionStorage.getItem("Sleepy")&&sessionStorage.setItem("Sleepy","0"),P(t)}else if("mouseup"==t.type){if("button"in t&&0!=t.button)return}else if("mouseout"==t.type){o.DebugLogEnable&&console.log("Mouse out Window."),w();var e=sessionStorage.getItem("SleepyTimer");window.clearTimeout(e),e=window.setTimeout(L,5e4),sessionStorage.setItem("SleepyTimer",e)}}function M(t){var e=t.touches[0];"touchstart"==t.type?1==t.touches.length&&P(e):"touchmove"==t.type?function(t){let e=c.getBoundingClientRect(),i=I(t.clientX-e.left),s=E(t.clientY-e.top),r=b({x:e.left+e.width/2,y:e.top+e.height*S},{x:t.clientX,y:t.clientY},e),n=C(r.x-e.left),a=F(r.y-e.top);o.DebugTouchLogEnable&&console.log("onMouseMove device( x:"+t.clientX+" y:"+t.clientY+" ) view( x:"+n+" y:"+a+")"),f&&(y=i,$=s,d.setPoint(n,a))}(e):"touchend"==t.type&&w()}function C(t){var e=g.transformX(t);return m.invertTransformX(e)}function F(t){var e=g.transformY(t);return m.invertTransformY(e)}function I(t){return g.transformX(t)}function E(t){return g.transformY(t)}function D(t,e,i,s=2){a.LAppDelegate.getInstance()._magnification=s,a.LAppDelegate.getInstance()._head_pos=i,a.LAppDelegate.getInstance().initL2dCanvas(t),a.LAppDelegate.getInstance().initialize(e)&&a.LAppDelegate.getInstance().run()}function B(t,e){a.LAppDelegate.getInstance()._captureName=t,a.LAppDelegate.getInstance()._captureFrame=e,window.Live2D.captureFrame=e,window.Live2D.captureName=t}window.screenshot=B,window.loadlive2d=function(t,e,i,s=1){S=void 0===i?.5:i,(new l.default).loadString(e,(function(i){let r,o=JSON.parse(i).model,n=-1;switch(null==o?n=e.indexOf("model3.json"):r=o.substring(o.lastIndexOf(".")+1),r){case"moc":!function(t,e,i,s){v=s,r=t,c=document.getElementById(r),c.addEventListener&&(window.addEventListener("click",T),window.addEventListener("mousedown",T),window.addEventListener("mousemove",T),window.addEventListener("mouseup",T),document.addEventListener("mouseout",T),window.addEventListener("touchstart",M),window.addEventListener("touchend",M),window.addEventListener("touchmove",M)),x(e);var r}(t,e,0,s);break;case"moc3":D(t,e,S,s);break;default:n>0?D(t,e,S,s):console.log("not model EXT. 没有获取到JSON中的model节点扩展名,应为moc|moc3,或传入相对路径的model3.json文件")}}))},window.loadlive2dv3=D},"./src/touchmanager.ts":function(t,e,i){"use strict";i.r(e),i.d(e,"TouchManager",(function(){return s}));class s{constructor(){this._startX=0,this._startY=0,this._lastX=0,this._lastY=0,this._lastX1=0,this._lastY1=0,this._lastX2=0,this._lastY2=0,this._lastTouchDistance=0,this._deltaX=0,this._deltaY=0,this._scale=1,this._touchSingle=!1,this._flipAvailable=!1}getCenterX(){return this._lastX}getCenterY(){return this._lastY}getDeltaX(){return this._deltaX}getDeltaY(){return this._deltaY}getStartX(){return this._startX}getStartY(){return this._startY}getScale(){return this._scale}getX(){return this._lastX}getY(){return this._lastY}getX1(){return this._lastX1}getY1(){return this._lastY1}getX2(){return this._lastX2}getY2(){return this._lastY2}isSingleTouch(){return this._touchSingle}isFlickAvailable(){return this._flipAvailable}disableFlick(){this._flipAvailable=!1}touchesBegan(t,e){this._lastX=t,this._lastY=e,this._startX=t,this._startY=e,this._lastTouchDistance=-1,this._flipAvailable=!0,this._touchSingle=!0}touchesMoved(t,e){this._lastX=t,this._lastY=e,this._lastTouchDistance=-1,this._touchSingle=!0}getFlickDistance(){return this.calculateDistance(this._startX,this._startY,this._lastX,this._lastY)}calculateDistance(t,e,i,s){return Math.sqrt((t-i)*(t-i)+(e-s)*(e-s))}calculateMovingAmount(t,e){if(t>0!=e>0)return 0;const i=t>0?1:-1,s=Math.abs(t),r=Math.abs(e);return i*(s<r?s:r)}}},0:function(t,e,i){i("./node_modules/core-js/fn/promise.js"),t.exports=i("./src/main.js")}});
//# sourceMappingURL=live2d.js.map